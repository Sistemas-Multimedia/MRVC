<!DOCTYPE html> 
<html> 
<head> <title>Motion Compensated Discrete Wavelet Transform (MCDWT)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Motion Compensated Discrete Wavelet
Transform (MCDWT)</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">January 18, 2019</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Intro</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Distrete Wavelet Transform (DWT)</a></span>
<br />    <span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-5">Scalability provided by DWT</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-50003" id="QQ2-1-6">Motion DWT (MDWT)</a></span>
<br />    <span class="subsectionToc" >3.1 <a 
href="#x1-60003.1" id="QQ2-1-9">Scalability provided by MDWT</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-70004" id="QQ2-1-10">Video transform alternatives</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-80005" id="QQ2-1-11">Motion Compensated Discrete Wavelet Transform (MCDWT)</a></span>
<br />    <span class="subsectionToc" >5.1 <a 
href="#x1-90005.1" id="QQ2-1-12">MCDWT butterﬂy</a></span>
<br />    <span class="subsectionToc" >5.2 <a 
href="#x1-100005.2" id="QQ2-1-15">MCDWT forward transform</a></span>
<br />    <span class="subsectionToc" >5.3 <a 
href="#x1-110005.3" id="QQ2-1-18">(Spatial) Multiresolution procedure</a></span>
<br />    <span class="subsectionToc" >5.4 <a 
href="#x1-120005.4" id="QQ2-1-20">Scalability provided by MCDWT</a></span>
   </div>
<!--l. 13--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Intro</h3>
<!--l. 15--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Video" >Video</a> data contain high amounts of redundancy, spatial and temporal. For this
reason, most of video encoders compress the input sequece of <a 
href="https://en.wikipedia.org/wiki/Digital_image" >images</a> (which are
matrices of <a 
href="https://en.wikipedia.org/wiki/Pixel" >pixels</a>) basically in two stages: (1) a transform stage in the <a 
href="https://en.wikipedia.org/wiki/Time_domain" >time</a> and in
the <a 
href="https://www.quora.com/What-is-spatial-domain-in-image-processing" >spatial</a> domains that produces a collection of spatially <a 
href="https://en.wikipedia.org/wiki/Decorrelation" >uncorrelated</a> <a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >coeﬃcients</a>,
                                                                  

                                                                  
and (2) an <a 
href="https://vicente-gonzalez-ruiz.github.io/symbol_compression/" >entropy encoding</a> phase which removes the statistical redundancy that can
still remains after the decorrelation (transform). These coeﬃcients have two
interesting features:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-2002x1">Usually, a <span 
class="ecbx-1000">smaller </span><a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" ><span 
class="ecbx-1000">entropy</span></a> than the original pixels. This helps to increase
     the <a 
href="https://en.wikipedia.org/wiki/Data_compression_ratio" >compression ratio</a>.
     </li>
     <li 
  class="enumerate" id="x1-2004x2">The  transform  domain  provides  a  <a 
href="https://en.wikipedia.org/wiki/Image_resolution" ><span 
class="ecbx-1000">multiresolution</span></a>  <span 
class="ecbx-1000">representation</span>
     <span 
class="ecbx-1000">(spatial and temporal) </span>of the visual information (spatial <a 
href="http://inst.eecs.berkeley.edu/~ee290t/sp04/lectures/videowavelet_UCB1-3.pdf" >scalability</a>).</li></ol>
<!--l. 43--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>Distrete Wavelet Transform (DWT)</h3>
<!--l. 44--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >(2D-)DWT</a> is a digital transform that, applied to an image, performs spatial
decorrelation (2D) and obtains a <a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/index.html#x1-3500024" >multiresolution dyadic representation</a> of such image,
conforming a collection of DWT subbands. The forward transform converts the image
into a set of frequency subbands with coeﬃcients representing diﬀerent spatial areas
and frequency orientations. There is an equivalence between (DWT) subbands (a
<span 
class="ecti-1000">(subband) decomposition</span>) and <a 
href="http://fourier.eng.hmc.edu/e161/lectures/canny/node3.html" >Laplacian pyramids</a>, and it is quite simple to
<a 
href="https://vicente-gonzalez-ruiz.github.io/pyramids-and-wavelets/" >pass from a decomposition representation to a pyramid representation and
viceversa</a>.
</p><!--l. 59--><p class="indent" >   <a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/DWT.py" >DWT.py</a> implements the forward and backward (2D-)DWT for color images.
<!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> and
<!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
stands for <span 
class="ecti-1000">low-pass ﬁltered </span>and <span 
class="ecti-1000">high-pass ﬁltered</span>, respectively. More information
about the implementation can be found at <a 
href="https://pywavelets.readthedocs.io/en/latest/index.html" >PyWavelets</a>.
</p>
   <!--l. 65--><div class="lstinputlisting">
<a 
 id="x1-3001r1"></a>
<a 
 id="x1-3002"></a>
<br /> <div class="caption" 
><span class="id">Listing 1: </span><span  
class="content">DWT.py</span></div><!--tex4ht:label?: x1-3001r2 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3003r1"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">numpy</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">as</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3004r2"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3005r3"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3006r4"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">sys</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3007r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3008r6"></a></span><span 
class="ectt-1000">sys</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">path</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">insert</span><span 
class="ectt-1000">(0,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">..</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3009r7"></a></span><span 
class="ectt-1000">from</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">src</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">IO</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3010r8"></a></span><span 
class="ectt-1000">from</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">src</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">IO</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3011r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3012r10"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3013r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3014r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3015r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3016r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3017r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3018r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3019r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3020r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">]</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3021r19"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3022r20"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3023r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3024r22"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3025r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3026r24"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">V</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3027r25"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">or</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3028r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">r</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3029r27"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">r</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3030r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">R</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3031r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000">G</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3032r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000">B</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3033r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3034r32"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3035r33"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3036r34"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3037r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3038r36"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3039r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">L</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">L</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">low</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subband</span><span 
class="ecit-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3040r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3041r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subbands</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">are</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3042r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3043r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3044r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3045r43"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3046r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3047r45"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3048r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3049r47"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3050r48"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3051r49"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3052r50"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">R</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3053r51"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000">G</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3054r52"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000">B</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3055r53"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3056r54"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3057r55"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3058r56"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3059r57"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">y</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3060r58"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3061r59"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3062r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3063r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3064r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3065r63"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3066r64"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3067r65"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(3):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3068r66"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt2</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">db5</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3069r67"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3070r68"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3071r69"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3072r70"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3073r71"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3074r72"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3075r73"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3076r74"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3077r75"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3078r76"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3079r77"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3080r78"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3081r79"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3082r80"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3083r81"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3084r82"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3085r83"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3086r84"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3087r85"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3088r86"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3089r87"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inversely</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3090r88"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3091r89"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3092r90"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3093r91"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3094r92"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3095r93"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][2]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3096r94"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3097r95"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(3):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3098r96"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">idwt2</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">db5</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3099r97"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span>
   
   </div>
<!--l. 67--><p class="indent" >   The multilevel DWT is a recursive use of the (1-level) DWT applied to the
<!--l. 68--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math> subband. For example, if
the DWT is applied <!--l. 68--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>-times
to the <!--l. 69--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math> subband, recursively,
a decomposition of <!--l. 69--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>-levels
is generated. For the sake of simplicity, we will denote the subbands
<!--l. 70--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>L</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> as only
<!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>, and
                                                                  

                                                                  
<!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math> as
only <!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>.
</p><!--l. 73--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Scalability provided by DWT</h4>
<!--l. 74--><p class="noindent" >Depending on the number of subbands levels (pyramid levels in the
pyramid representation) that we use, we can reconstruct a image
at diﬀerent spatial scales (resolutions). For example, if an image
<!--l. 76--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> has
been transformed using the DWT of 2 levels, we get: </p>
     <ul class="itemize1">
     <li class="itemize">Subband <!--l. 78--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>
     with the scale 2.
     </li>
     <li class="itemize">Subband <!--l. 79--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     (iDWT = inverse DWT = backward DWT) with the scale 1.
     </li>
     <li class="itemize"><!--l. 81--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     (the original image) with the scale 0.</li></ul>
<!--l. 84--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-50003"></a>Motion DWT (MDWT)</h3>
<!--l. 85--><p class="noindent" >DWT can be applied to a sequence of images by simply transforming each image of
the sequence independently. This is done, for example, in the <a 
href="https://en.wikipedia.org/wiki/JPEG_2000" >motion JPEG2000
video compression standard</a>. Notice that only the spatial redundancy is exploited. All
the temporal redundancy still remains in the video.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-50011"></a>
                                                                  

                                                                  
<!--l. 93--><p class="noindent" > <div style="text-align:center;"> <img width=800 src="graphics/forward_MDWT.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 1: </span><span  
class="content">Forward MDWT step.</span></div><!--tex4ht:label?: x1-50011 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 97--><div class="lstinputlisting">
<a 
 id="x1-5002r2"></a>
<a 
 id="x1-5003"></a>
<br /> <div class="caption" 
><span class="id">Listing 2: </span><span  
class="content">MDWT.py</span></div><!--tex4ht:label?: x1-5002r3 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5004r1"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">MDWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5005r2"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5006r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5007r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5008r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5009r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5010r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5011r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5012r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5013r10"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5014r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5015r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5016r13"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5017r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5018r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5019r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5020r17"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5021r18"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5022r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5023r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5024r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5025r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5026r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5027r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5029r26"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5030r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5031r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5032r29"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5033r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5034r31"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5035r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5036r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5037r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5038r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5039r36"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5040r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5041r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5042r39"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5043r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5044r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5045r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5046r43"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5047r44"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5048r45"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5049r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5050r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-60003.1"></a>Scalability provided by MDWT</h4>
<!--l. 100--><p class="noindent" >MDWT sequences (of (subband) decompositions) are scalable in space and in time.
Spatial scalability is a direct consequence of DWT. On the other hand, it is trivial to
observe that MDWT provides <span 
class="ecti-1000">fully </span>temporal scalability (we can access to the
images randomly) because each image of the input sequence is transformed
independently.
</p><!--l. 106--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-70004"></a>Video transform alternatives</h3>
<!--l. 107--><p class="noindent" >To remove both, spatial and temporal redundancies, two diﬀerent alternatives
are available: (1) t+2D transforms and (2) 2D+t transforms. In a t+2D
transform, the video is ﬁrst <a 
href="https://en.wikipedia.org/wiki/Digital_filter#Analysis_techniques" >analyzed</a> (transformed) over the time domain and
next, over the space domain. A 2D+t transform does just the opposite. Each
choice has a number of <span 
class="ecti-1000">pros </span>and <span 
class="ecti-1000">cons</span>. For example, in a t+2D transform we
can apply directly any image predictor based on <a 
href="https://en.wikipedia.org/wiki/Motion_estimation" >motion estimation</a> because
the input is a normal video. However, if we implement a 2D+t transform,
the input to the motion estimator is a sequence decompositions. <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >The
overwhelming majority of DWT’s</a> are not <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >shift invariant</a>, which basically means
<!--l. 122--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >DWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-rel">≠</mo><mstyle 
class="text"><mtext  >DWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>x</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>, where
<!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> is a
displacement of <!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
along one of the signal domains. Therefore, motion estimators which compare pixel
values will not work on the (subband) decomposition domain. On the other hand, if
we want to provide true spatial scalability (processing only those <a 
href="https://en.wikipedia.org/wiki/Image_resolution#Spatial_resolution" >spatial resolutions</a>
(scales) necessary to get a spatially scaled of our video), a t+2D transformed video is
not suitable because the ﬁrst step of the forward transform (t) should be
reversed at full resolution in the backward transform (as the forward transform
did).
</p><!--l. 134--><p class="noindent" >
</p>
                                                                  

                                                                  
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-80005"></a>Motion Compensated Discrete Wavelet Transform (MCDWT)</h3>
<!--l. 135--><p class="noindent" >MCDWT is a 2D+t transform. The 2D stage is MDWT. The t stage is a
1D-DWT, which removes the temporal redundancy between adjacent
<!--l. 136--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands by means of <a 
href="https://en.wikipedia.org/wiki/Motion_compensation" >Motion Compensation (MC)</a>. A special characteristic of
MCDWT is that the motion information is not transmitted from the encoder to the
<a 
href="https://en.wikipedia.org/wiki/Decoder" >decoder</a>. This is possible because to estimate de motion at the encoder, only the
information that it is accesible by the decoder is used.
</p><!--l. 145--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-90005.1"></a>MCDWT butterﬂy</h4>
<!--l. 147--><p class="noindent" >MCDWT butterly inputs three decompositions
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
<!--l. 147--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
<!--l. 148--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>, and outputs a
residue subband <!--l. 149--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which replaces to <!--l. 149--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
in the original <!--l. 149--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
decomposition. So, after the use of the buﬀerﬂy, we get
<!--l. 150--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> (an intra-coded “I”
image), <!--l. 151--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> (a bidirectionally
predicted “B” image) and <!--l. 152--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
(an intra-coded “I” image). Obviously, this replacement is fully
reversible. Notice that the <a 
href="http://www.vtvt.ece.vt.edu/research/references/video/DCT_Video_Compression/Zhang92a.pdf" >pyramid domain</a> (which is invariant to the
pixels displacements) has been used to estimate and compensate the
<!--l. 157--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-90012"></a>
                                                                  

                                                                  
<!--l. 161--><p class="noindent" > <div style="text-align:center;"> <img width=1200 src="graphics/forward_butterfly.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 2: </span><span  
class="content">Forward MCDWT butterﬂy.</span></div><!--tex4ht:label?: x1-90012 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 164--><div class="lstinputlisting">
<a 
 id="x1-9002r3"></a>
<a 
 id="x1-9003"></a>
<br /> <div class="caption" 
><span class="id">Listing 3: </span><span  
class="content">MCDWT.py</span></div><!--tex4ht:label?: x1-9002r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9004r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9005r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zeros</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9006r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9007r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9008r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9009r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9010r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9011r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9012r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9013r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9014r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9015r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9016r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9017r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9018r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9019r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9020r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9021r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">base</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9022r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">fot</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9023r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9024r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9025r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9026r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9027r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9029r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9030r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9031r28"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9032r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9033r30"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9034r31"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">/</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9035r32"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9036r33"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9037r34"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9038r35"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9039r36"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9040r37"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9041r38"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9042r39"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9043r40"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9044r41"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9045r42"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9046r43"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9047r44"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9048r45"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">/</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9049r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9050r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9051r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">[1]</span>
   
   </div>
<!--l. 166--><p class="indent" >   Notice that, even if <!--l. 166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
(at full resolution) are available at the decoder, only
<!--l. 167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> is.
So, it does not make sense to search the low resolution structures of
<!--l. 168--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> in the high
resolution images <!--l. 168--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>,
because even if a perfect match is achieved (think about the tree images
<!--l. 170--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>,
<!--l. 170--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> and
<!--l. 170--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
are identical), the prediction error would be diﬀerent than
<!--l. 171--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
as a consequence of that the high resolution information is missing in
<!--l. 172--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-100005.2"></a>MCDWT forward transform</h4>
<!--l. 176--><p class="noindent" >The MCDWT forward transform is the result of appliying the MCDWT
butterﬂy to all the input sequence of decompositions with diﬀerent
distances between them. As a consequence, except the ﬁrst and the last
<!--l. 179--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>-subband
of the sequence are temporally decorrelated.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-100013"></a>
                                                                  

                                                                  
<!--l. 183--><p class="noindent" > <div style="text-align:center;"> <img width=1200 src="graphics/temporal_decorrelation.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 3: </span><span  
class="content">MCDWT forward transform.</span></div><!--tex4ht:label?: x1-100013 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 186--><div class="lstinputlisting">
<a 
 id="x1-10002r4"></a>
<a 
 id="x1-10003"></a>
<br /> <div class="caption" 
><span class="id">Listing 4: </span><span  
class="content">MCDWT.py</span></div><!--tex4ht:label?: x1-10002r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10004r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">mc_stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">=2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10005r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">A</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Discrete</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Wavelet</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Transform</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10006r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10007r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">The</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">video</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10008r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">must</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">stored</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10009r6"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">will</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">stored</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10010r7"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10011r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Imput</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10012r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10013r10"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10014r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">str</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10015r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10016r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Localization</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Example</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10017r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;/</span><span 
class="ecit-1000">tmp</span><span 
class="ecit-1000">/&#x0022;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10018r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10019r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10020r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10021r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">process</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10022r19"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10023r20"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">K</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10024r21"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10025r22"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scales</span><span 
class="ecit-1000">).</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Controls</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10026r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">GOP</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">size</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10027r24"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10028r25"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">K</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">GOP_size</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10029r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">----+-----------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10030r27"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">0</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10031r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10032r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">4</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10033r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">3</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">8</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10034r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">4</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">16</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10035r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">5</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">32</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10036r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10037r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10038r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Returns</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10039r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10040r37"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10041r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">None</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10042r39"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10043r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10044r41"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10045r42"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">t</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10046r43"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10047r44"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10048r45"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10049r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">while</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10050r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10051r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10052r49"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10053r50"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10054r51"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10055r52"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10056r53"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10057r54"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">*=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10058r55"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10059r56"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">mc_stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">=2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10060r57"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2**</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10061r58"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">t</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10062r59"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10063r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10064r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10065r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">while</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10066r63"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10067r64"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10068r65"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10069r66"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10070r67"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10071r68"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10072r69"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10073r70"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">//=2</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-110005.3"></a>(Spatial) Multiresolution procedure</h4>
<!--l. 190--><p class="noindent" >Spatial dyadic multiresolution can be obtained by appliying a sequence of
MDWT+MCDWT steps (see Fig. <a 
href="#x1-110014">4<!--tex4ht:ref: fig:multiresolution --></a>).
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-110014"></a>
                                                                  

                                                                  
<!--l. 194--><p class="noindent" > <div style="text-align:center;"> <img width=1200 src="graphics/multiresolution.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 4: </span><span  
class="content">MDWT+MCDWT multiresolution procedure.</span></div><!--tex4ht:label?: x1-110014 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-120005.4"></a>Scalability provided by MCDWT</h4>
<!--l. 200--><p class="noindent" >The decomposition generated by the MCDWT is identical to MDWT. Therefore,
MCDWT provides the same spatial scalability than MDWT. In order to obtain
several spatial resolutions, MCDWT should be applied to the low-frequency
subbands, recursively. As an example, in the Figure <a 
href="#x1-110014">4<!--tex4ht:ref: fig:multiresolution --></a>, MCDWT has been applied to
the output of the example of the Figure <a 
href="#x1-100013">3<!--tex4ht:ref: fig:forward_MCDWT --></a>. Notice that between two consecutive
iterations of MCDWT, MDWT must be applied to the low-frequency subband in
order to reduce the resolution of the analysis.
</p><!--l. 210--><p class="indent" >   On the other hand, MCDWT decreases the temporal scalability oﬀered
by MDWT to allowing only dyadic access (depending on required image
and the number of MCDWT levels, more than one decomposition need to
be inversely transformed). For example, if only one step of the backward
transform is applied to the previous example, only the decompositions of
<!--l. 215--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></math>,
<!--l. 215--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math> and
<!--l. 215--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
></math> will
be reconstructed (the ﬁrst <a 
href="https://en.wikipedia.org/wiki/Temporal_resolution" >temporal resolution</a>. If a second iteration of the backward
transform is used, all the decompositions are rendered.
</p>
    
</body> 
</html>
                                                                  


