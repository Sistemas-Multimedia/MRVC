<!DOCTYPE html> 
<html> 
<head> <title>Motion Compensated Discrete Wavelet Transform (MCDWT)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Motion Compensated Discrete Wavelet
Transform (MCDWT)</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">January 5, 2020</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Intro</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">The 2D DWT (Distrete Wavelet Transform)</a></span>
<br />    <span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-4">Implementation of the 3 components (color) DWT step</a></span>
<br />    <span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-7">Multi-level 2D DWT structures</a></span>
<br />    <span class="subsectionToc" >2.3 <a 
href="#x1-60002.3" id="QQ2-1-8">Scalability provided by the 2D DWT</a></span>
<br />    <span class="subsectionToc" >2.4 <a 
href="#x1-70002.4" id="QQ2-1-9">A 1-iteration 2D DWT example</a></span>
<br />    <span class="subsectionToc" >2.5 <a 
href="#x1-80002.5" id="QQ2-1-10">A 2-iterations 2D DWT example</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-90003" id="QQ2-1-11">Motion DWT (MDWT)</a></span>
<br />    <span class="subsectionToc" >3.1 <a 
href="#x1-100003.1" id="QQ2-1-14">Scalability provided by MDWT</a></span>
<br />    <span class="subsectionToc" >3.2 <a 
href="#x1-110003.2" id="QQ2-1-15">1-iteration MDWT example</a></span>
<br />    <span class="subsectionToc" >3.3 <a 
href="#x1-120003.3" id="QQ2-1-16">2-iterations MDWT example</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-130004" id="QQ2-1-17">Video transform alternatives</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-140005" id="QQ2-1-18">Motion Compensated Discrete Wavelet Transform (MCDWT)</a></span>
<br />    <span class="subsectionToc" >5.1 <a 
href="#x1-150005.1" id="QQ2-1-19">The MCDWT butterﬂy</a></span>
<br />    <span class="subsectionToc" >5.2 <a 
href="#x1-160005.2" id="QQ2-1-23">The MCDWT step</a></span>
<br />    <span class="subsectionToc" >5.3 <a 
href="#x1-170005.3" id="QQ2-1-25">The forward MCDWT</a></span>
<br />    <span class="subsectionToc" >5.4 <a 
href="#x1-180005.4" id="QQ2-1-28">(Spatial) Multiresolution</a></span>
<br />    <span class="subsectionToc" >5.5 <a 
href="#x1-190005.5" id="QQ2-1-30">Scalability provided by MCDWT</a></span>
<br />    <span class="subsectionToc" >5.6 <a 
href="#x1-200005.6" id="QQ2-1-31">MCDWT 1-levels example</a></span>
<br />    <span class="subsectionToc" >5.7 <a 
href="#x1-210005.7" id="QQ2-1-32">Showing some statistics</a></span>
<br />    <span class="subsectionToc" >5.8 <a 
href="#x1-220005.8" id="QQ2-1-33">Filtering the MC subbands</a></span>
<br />    <span class="subsectionToc" >5.9 <a 
href="#x1-230005.9" id="QQ2-1-34">2D-MDWT-MCDWT 2-levels example</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-240006" id="QQ2-1-35">Adaptive motion compensation based on the distortion of the prediction error</a></span>
                                                                  

                                                                  
<br />   <span class="sectionToc" >7 <a 
href="#x1-250007" id="QQ2-1-37">Orthogonal, orthonormal, and biorthogonal transforms</a></span>
<br />   <span class="sectionToc" ><a 
href="#Q1-1-38">References</a></span>
   </div>
<!--l. 7--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Intro</h3>
<!--l. 9--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Video" >Video</a> data contain high amounts of <a 
href="https://vicente-gonzalez-ruiz.github.io/redundancy/" >redundancy</a>, spatial and temporal.
For this reason, most of <a 
href="https://vicente-gonzalez-ruiz.github.io/video_compression/" >video encoders</a> compress an input sequence of
<a 
href="https://en.wikipedia.org/wiki/Digital_image" >images</a><span class="footnote-mark"><a 
href="index2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-2001f1"></a> ,
basically, in two stages: (1) a transform stage in the <a 
href="https://en.wikipedia.org/wiki/Time_domain" >time</a> and in the <a 
href="https://www.quora.com/What-is-spatial-domain-in-image-processing" >spatial</a> domains
that produces a collection of <a 
href="https://en.wikipedia.org/wiki/Decorrelation" >uncorrelated</a> <a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >coeﬃcients</a>, and (2) an <a 
href="https://en.wikipedia.org/wiki/Entropy_encoding" >entropy
encoding</a> phase which removes the statistical redundancy that can still remains
after the decorrelation (transform). These coeﬃcients have two interesting
features:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-2003x1">Usually,  a   <a 
href="https://vicente-gonzalez-ruiz.github.io/symbol_compression/" ><span 
class="ecbx-1000">smaller  entropy</span></a> than  the  original  pixels.  This  helps  to
     increase the <a 
href="https://en.wikipedia.org/wiki/Data_compression_ratio" >compression ratio</a>.
     </li>
     <li 
  class="enumerate" id="x1-2005x2">A <a 
href="https://en.wikipedia.org/wiki/Image_resolution" ><span 
class="ecbx-1000">multiresolution representation</span></a> <span 
class="ecbx-1000">(in space and time) </span>of the visual
     information.  This  provides  the  posibility  of  decoding  the  sequence  of
     images using a smaller resolution (in space and time). This feature is
     known as <a 
href="https://vicente-gonzalez-ruiz.github.io/video_compression/" >spatial/temporal scalability in video</a>.
     </li>
     <li 
  class="enumerate" id="x1-2007x3">Usually,  <span 
class="ecbx-1000">most  of  the  </span><a 
href="https://en.wikipedia.org/wiki/Energy_(signal_processing)" ><span 
class="ecbx-1000">energy</span></a> (and  therefore,  generally,  most  of  the
     information  interesting  for  the  humans)  <span 
class="ecbx-1000">is  represented  by  </span><a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding" ><span 
class="ecbx-1000">a  small</span>
     <span 
class="ecbx-1000">number of coeﬃcients</span></a>. This helps to improve the compression ratio
     and to prioritize the data in <a 
href="https://vicente-gonzalez-ruiz.github.io/media_encoding_models/" >progressive transmission scenarios</a>.</li></ol>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>The 2D DWT (Distrete Wavelet Transform)</h3>
<!--l. 52--><p class="noindent" ><a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/#x1-3100020" >The 2D<span class="footnote-mark"><a 
href="index3.html#fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-3001f2"></a> 
DWT (Distrete Wavelet Transform)</a> is a digital transform that, applied to
an image, performs a spatial decorrelation and obtains a <a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/index.html#x1-3500024" >multiresolution
(generally dyadic) representation</a> of such image, conforming a collection
of DWT subbands. The forward transform converts the image into a
                                                                  

                                                                  
set of frequency subbands with coeﬃcients representing diﬀerent spatial
areas and frequency orientations. There is an equivalence between DWT
subbands and <a 
href="http://fourier.eng.hmc.edu/e161/lectures/canny/node3.html" >Laplacian Pyramids</a>, and it is quite simple to <a 
href="https://nbviewer.jupyter.org/github/vicente-gonzalez-ruiz/pyramids-and-wavelets/index.ipynb" >pass from a
decomposition<span class="footnote-mark"><a 
href="index4.html#fn3x0"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-3002f3"></a> 
representation to a pyramid representation and viceversa</a>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Implementation of the 3 components (color) DWT step</h4>
<!--l. 69--><p class="noindent" ><a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/DWT.py" >DWT.py</a> (see Fig. <a 
href="#x1-41001">1<!--tex4ht:ref: fig:DWT --></a>) implements the forward and backward 1-iteration (step) 2D
DWT for color images.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-41001"></a>
                                                                  

                                                                  
<!--l. 74--><div class="lstinputlisting">
<a 
 id="x1-4001r1"></a>
<a 
 id="x1-4002"></a>
<br /> <div class="caption" 
><span class="id">Listing 1: </span><span  
class="content">DWT.py</span></div><!--tex4ht:label?: x1-4001r2 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4003r1"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">numpy</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">as</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4004r2"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4005r3"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4006r4"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">sys</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4007r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4008r6"></a></span><span 
class="ectt-1000">sys</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">path</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">insert</span><span 
class="ectt-1000">(0,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">..</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4009r7"></a></span><span 
class="ectt-1000">from</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">src</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">IO</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4010r8"></a></span><span 
class="ectt-1000">from</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">src</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">IO</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4011r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4012r10"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4013r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4014r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4015r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4016r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4017r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4018r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4019r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4020r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">]</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">usually</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">YUV</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4021r19"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4022r20"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4023r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4024r22"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4025r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4026r24"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">V</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4027r25"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4028r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4029r27"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4030r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4031r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4032r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4033r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4034r32"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4035r33"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4036r34"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4037r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4038r36"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4039r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">L</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">L</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">low</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencie</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4040r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subband</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4041r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subbands</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">are</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4042r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4043r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4044r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4045r43"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4046r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4047r45"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4048r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4049r47"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4050r48"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4051r49"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4052r50"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4053r51"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4054r52"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4055r53"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4056r54"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4057r55"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">This</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">structure</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">provides</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">spatial</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">resolution</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4058r56"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4059r57"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4060r58"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4061r59"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4062r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">y</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4063r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4064r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4065r63"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4066r64"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4067r65"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4068r66"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4069r67"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4070r68"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(3):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4071r69"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt2</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">bior3</span><span 
class="ectt-1000">.5</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4072r70"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4073r71"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4074r72"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4075r73"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4076r74"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4077r75"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4078r76"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4079r77"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4080r78"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4081r79"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4082r80"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4083r81"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4084r82"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4085r83"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4086r84"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4087r85"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4088r86"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4089r87"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4090r88"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4091r89"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4092r90"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inversely</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4093r91"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4094r92"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4095r93"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4096r94"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4097r95"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4098r96"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][2]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4099r97"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span>
</div>
<br />    <div class="caption" 
><span class="id">Figure 1:      </span><span  
class="content">Implementation      of      the      color      DWT      step.
<!--l. 79--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
and
<!--l. 79--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
stands for <span 
class="ecti-1000">low-pass ﬁltered </span>and <span 
class="ecti-1000">high-pass ﬁltered</span>, respectively. More information
about the implementation can be found at <a 
href="https://pywavelets.readthedocs.io/en/latest/index.html" >PyWavelets</a>.</span></div><!--tex4ht:label?: x1-41001 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 83--><p class="indent" >   Notice that the <!--l. 83--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math>-iterations
DWT can be computed y applying the DWT step
<!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math> times, recursively,
to the subband <!--l. 84--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Multi-level 2D DWT structures</h4>
<!--l. 87--><p class="noindent" >A dyadic 2D DWT is a recursive use of the
(1-iteration<span class="footnote-mark"><a 
href="index5.html#fn4x0"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-5001f4"></a> ) 2D-DWT
applied to the <!--l. 93--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math>
subband. For example, if the 2D DWT is applied
<!--l. 94--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>-times
to the <!--l. 94--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math>
subband, recursively, a decomposition of spatial resolution
<!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>-levels
is generated. For the sake of simplicity, we will denote the subbands
<!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>L</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> as only
<!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>, and
<!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math> as
only <!--l. 97--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>.
See <a 
href="https://nbviewer.jupyter.org/github/Sistemas-Multimedia/MCDWT/blob/master/docs/DWT_vs_LPT.ipynb" >DWT versus LPT</a>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-60002.3"></a>Scalability provided by the 2D DWT</h4>
<!--l. 102--><p class="noindent" >Depending on the number of subband levels (pyramid levels in the <a 
href="https://vicente-gonzalez-ruiz.github.io/https://pywavelets.readthedocs.io/en/latest/index.html/" >pyramid representation</a>),
we can reconstruct an image at diﬀerent spatial scales (resolutions). For example, if an
image <!--l. 105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
has been transformed using the DWT of 2 iterations, we get: </p>
     <ul class="itemize1">
     <li class="itemize">Subband <!--l. 108--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>
     with the scale 2.
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-1">
         +------+
      <br />    |      |
      <br />Y/4 |  L2  |
      <br />    |      |
      <br />    +------+
      <br />       X/4
</div>
     <!--l. 116--><p class="nopar" >
     </p></li>
     <li class="itemize">Subband <!--l. 117--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     (<!--l. 118--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >iDWT</mtext></mstyle> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >inverse DWT</mtext></mstyle> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >backward DWT</mtext></mstyle></math>) with
     the scale <!--l. 119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math>.
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-2">
         +-------------+
      <br />    |             |
      <br />    |             |
      <br />Y/2 |     L1      |
      <br />    |             |
      <br />    |             |
      <br />    +-------------+
      <br />          X/2
</div>
     <!--l. 129--><p class="nopar" >
     </p></li>
     <li class="itemize"><!--l. 131--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math> (the original image)
     with the scale <!--l. 132--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>.
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-3">
         +---------------------------+
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />  Y |            L0             |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    +---------------------------+
      <br />                  X
</div>
     <!--l. 150--><p class="nopar" ></p></li></ul>
<!--l. 153--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-70002.4"></a>A 1-iteration 2D DWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-4">
# You must be in the ’src’ directory.
 <br />
 <br /># Copy an image (the output directory must be the same as the input one):
 <br />rm /tmp/*.png
 <br />cp ../sequences/stockholm/000.png /tmp
 <br />
 <br /># 1-iteration 2D forward DWT:
 <br />python3 -O DWT.py -p /tmp/ -i 000
 <br />
 <br /># Visualize the subbands:
 <br />display -normalize /tmp/LL000.png # &#x003C;- LL1
 <br />display -normalize /tmp/LH000.png # &#x003C;- LH1
 <br />display -normalize /tmp/HL000.png # &#x003C;- HL1
 <br />display -normalize /tmp/HH000.png # &#x003C;- HH1
 <br />
 <br /># 1-iteration 2D backward DWT:
 <br />python3 -O DWT.py -b -p /tmp/ -i 000
 <br />
 <br /># Visualize the reconstruction:
 <br />display -normalize /tmp/000.png
 <br />
 <br /># Show diferences (PyWavelets uses floating point arithmetic):
 <br />../tools/show_differences.sh -1 /tmp/000.png -2 ../sequences/stockholm/000.png -o /tmp/diffs.png
 <br />display -normalize /tmp/diffs.png
</div>
<!--l. 179--><p class="nopar" >
</p><!--l. 181--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5   </span> <a 
 id="x1-80002.5"></a>A 2-iterations 2D DWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-5">
# You must be in the ’src’ directory.
 <br />
 <br /># Copy a image (the output directory must be the same than the input one):
 <br />rm /tmp/*.png
 <br />cp ../sequences/stockholm/000.png /tmp
 <br />
 <br /># First iteration:
 <br />python3 -O DWT.py -p /tmp/ -i 000
 <br />
 <br /># Second iteration:
 <br />python3 -O DWT.py -p /tmp/LL -i 000
 <br />
 <br /># Visualize the subbands:
 <br />ls -l /tmp/*.png
 <br />display -normalize /tmp/LL000.png # &#x003C;- LL1
 <br />display -normalize /tmp/LH000.png # &#x003C;- LH1
 <br />display -normalize /tmp/HL000.png # &#x003C;- HL1
 <br />display -normalize /tmp/HH000.png # &#x003C;- HH1
 <br />display -normalize /tmp/LLLL000.png # &#x003C;- LL2
 <br />display -normalize /tmp/LLLH000.png # &#x003C;- LH2
 <br />display -normalize /tmp/LLHL000.png # &#x003C;- HL2
 <br />display -normalize /tmp/LLHH000.png # &#x003C;- HH2
 <br />
 <br /># Reverse second iteration:
 <br />python3 -O DWT.py -b -p /tmp/LL -i 000
 <br />display -normalize /tmp/LL000.png
 <br />
 <br /># Reverse first iteration:
 <br />python3 -O DWT.py -b -p /tmp/ -i 000
 <br />display -normalize /tmp/000.png
 <br />
 <br /># Show diferences:
 <br />../tools/show_differences.sh -1 /tmp/000.png -2 ../sequences/stockholm/000.png -o /tmp/diffs.png
 <br />display -normalize /tmp/diffs.png
</div>
<!--l. 217--><p class="nopar" >
</p><!--l. 219--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-90003"></a>Motion DWT (MDWT)</h3>
                                                                  

                                                                  
<!--l. 220--><p class="noindent" >The DWT can be applied to a sequence of images by simply transforming
each image of the sequence independently. This is done, for example, in
the <a 
href="https://vicente-gonzalez-ruiz.github.io/JPEG2000/" >Motion JPEG2000 video compression standard</a>. Notice that only the
spatial redundancy is exploited in MDWT. All the temporal redundancy still
remains in the video. The decomposition structure generated by MDWT
is shown in the Fig <a 
href="#x1-90012">2<!--tex4ht:ref: fig:forward_MDWT --></a>. 1-iteration MDWT inputs a sequence of images
<!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and outputs a sequence
of decompositions <!--l. 227--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
each one providing 2 spatial resolution levels
(<!--l. 228--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
<!--l. 229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">}</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math>) of
the image sequence.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-90012"></a>
                                                                  

                                                                  
<!--l. 233--><p class="noindent" ><div style="text-align:center;"> <img width=600 src="graphics/forward_MDWT.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 2: </span><span  
class="content">Forward 1-iteration MDWT step.</span></div><!--tex4ht:label?: x1-90012 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 238--><div class="lstinputlisting">
<a 
 id="x1-9002r2"></a>
<a 
 id="x1-9003"></a>
<br /> <div class="caption" 
><span class="id">Listing 2: </span><span  
class="content">MDWT.py</span></div><!--tex4ht:label?: x1-9002r3 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9004r1"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">MDWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9005r2"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9006r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9007r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9008r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9009r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9010r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9011r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9012r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9013r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">placed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">at</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9014r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9015r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9016r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9017r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9018r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9019r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9020r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9021r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9022r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9023r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9024r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9025r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9026r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9027r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9029r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9030r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9031r28"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9032r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9033r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9034r31"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9035r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9036r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">placed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">at</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9037r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9038r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9039r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9040r37"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9041r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9042r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9043r40"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9044r41"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9045r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9046r43"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9047r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9048r45"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9049r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-100003.1"></a>Scalability provided by MDWT</h4>
<!--l. 241--><p class="noindent" >MDWT sequences (of (subband) decompositions) are scalable in space and in time.
Spatial scalability is a direct consequence of the 2D DWT (the number of spatial
resolution levels can be generated bycontrolled by the number of iterations of DWT).
On the other hand, it is trivial to observe that MDWT provides <span 
class="ecti-1000">fully </span>temporal
scalability (we can access to the images randomly) because each image of the input
sequence is transformed independently.
</p><!--l. 249--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-110003.2"></a>1-iteration MDWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-6">
# You must be in the ’src’ directory.
 <br />
 <br /># Create the output directory for the 1st-level decompositions:
 <br />yes | cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 2D 1-iteration forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/ -N 5
 <br />
 <br /># Visualize the subbands:
 <br />for i in /tmp/LL00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/LL*.norm
 <br />for i in /tmp/LH00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/LH*.norm
 <br />for i in /tmp/HL00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/HL*.norm
 <br />for i in /tmp/HH00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/HH*.norm
 <br />
 <br /># 2D 1-iteration backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/ -N 5
 <br />
 <br /># Visualization of the reconstruction:
 <br />rm /tmp/*.norm
 <br />for i in /tmp/00?.png; do convert -normalize $i $i.norm; done; animate /tmp/00?.png.norm
</div>
<!--l. 275--><p class="nopar" >
</p><!--l. 277--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-120003.3"></a>2-iterations MDWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-7">
# You must be in the ’src’ directory.
 <br />
 <br /># Create the output directory for the 1st-level decompositions:
 <br />yes | cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 2D 2-iterations forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/ -N 5
 <br />python3 -O MDWT.py -p /tmp/LL -N 5
 <br />
 <br />
 <br /># 2D 2-iterations backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/LL -N 5
 <br />python3 -O MDWT.py -b -p /tmp/ -N 5
 <br />
 <br /># Visualization of the reconstruction:
 <br />rm /tmp/*.norm
 <br />for i in /tmp/00?.png; do convert -normalize $i $i.norm; done; animate /tmp/00?.png.norm
</div>
<!--l. 296--><p class="nopar" >
</p><!--l. 298--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-130004"></a>Video transform alternatives</h3>
<!--l. 299--><p class="noindent" >To remove both, spatial and temporal redundancies, two diﬀerent alternatives are
available: (1) t+2D transforms and (2) 2D+t transforms. In a t+2D transform, the
video is ﬁrst <a 
href="https://en.wikipedia.org/wiki/Digital_filter#Analysis_techniques" >analyzed</a> (transformed) over the time domain and next, over the
space domain. A 2D+t transform does just the opposite. Each choice has a
number of <span 
class="ecti-1000">pros </span>and <span 
class="ecti-1000">cons</span>. For example, in a t+2D transform we can apply
directly any image predictor based on <a 
href="https://en.wikipedia.org/wiki/Motion_estimation" >motion estimation</a> because the input is
a normal video. However, if we implement a 2D+t transform, the input
to the motion estimator is a sequence decompositions. <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >The overwhelming
majority of DWT’s</a> are not <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >shift invariant</a>, which basically means that a
even an (integer) pixel accuracy movement of an object that is shown by
two diﬀerent images will generate diﬀerent wavelet coeﬃcients. Therefore,
motion estimators which compare coeﬃcient values will not work on the
decomposition domain. On the other hand, if we want to provide true spatial
scalability (processing only those <a 
href="https://www.tutorialspoint.com/dip/spatial_resolution.htm" >spatial resolutions</a> (scales) necessary to get
a spatially scaled of our video), a t+2D transformed video presents some
drawbacks:
</p>
                                                                  

                                                                  
     <ul class="itemize1">
     <li class="itemize">In order to implement a lossless system, the t stage must be carried out
     at full (scale 0) resolution.
     </li>
     <li class="itemize">We can restrict the perfect reconstruction only to the scale 0 case, but
     in this case, a spatial resolution representation of the motion information
     should be available at the decoder. This can be done, but in general,
     scalabilitity decreases the compression ratio (on the motion data in this
     case).
     </li>
     <li class="itemize">We can use the full (scale 0) resolution version of the motion information
     for reconstructing all the scales of the texture (interpolating it for all
     those scales greater that 0), but in this case the memory and computing
     requirements  at  the  decoders  will  increase  unnecessarily  when  a  low
     spatial resolution of the sequence is decoded. Therefore, depending on the
     resolution of the scale 0 and the computational resources (specially at the
     receiver side), this could be aﬀordable or not.
     </li>
     <li class="itemize">As an alternative to this last problem, we can decrease the accuracy of the
     motion information in order to make it suitable for the spatial resolution.
     However, this will increase the distortion of the reconstruction compared
     to the previous solution.</li></ul>
<!--l. 346--><p class="indent" >   Finally, it is important to realize that the presence of the motion data in the
code-stream introduces also complexity into the decoding process because, in a
quality scalable scenario, it is not trivial (specially when non-linear systems such as
those based on ME are involved) to decide how to interleave the motion and
the texture information in a code-stream that can be decoded following
diﬀerent orders, depending on the type of used scalability and the avaliable
bandwidth.
</p><!--l. 356--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-140005"></a>Motion Compensated Discrete Wavelet Transform (MCDWT)</h3>
<!--l. 357--><p class="noindent" >MCDWT is a 2D+t transform. The 2D stage is MDWT. The t stage is a
1D DWT, which removes the temporal redundancy between adjacent
<!--l. 358--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands by means of <a 
href="https://en.wikipedia.org/wiki/Motion_compensation" >Motion Compensation (MC)</a>. A special characteristic of
MCDWT is that the motion information is not transmitted from the <a 
href="https://en.wikipedia.org/wiki/Encoder" >encoder</a> to the
<a 
href="https://en.wikipedia.org/wiki/Decoder" >decoder</a>. This is possible because to estimate de motion at the encoder, only the
information that it is accesible by the decoder is used.
                                                                  

                                                                  
</p><!--l. 368--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-150005.1"></a>The MCDWT butterﬂy</h4>
<!--l. 369--><p class="noindent" >MCDWT butterly inputs three decompositions
<!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
<!--l. 369--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
<!--l. 370--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>, and outputs a
residue subband <!--l. 371--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which replaces to <!--l. 371--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
in the original <!--l. 371--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
decomposition. So, after the use of the buﬀerﬂy, we get
<!--l. 372--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> (an <a 
href="https://en.wikipedia.org/wiki/Video_compression_picture_types" >intra-coded “I”
image</a>), <!--l. 375--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> (a <a 
href="https://en.wikipedia.org/wiki/Video_compression_picture_types" >bidirectionally
predicted “B” image</a>) and <!--l. 377--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
(another intra-coded “I” image). This replacement is fully reversible because the
forward transform will use only the information that the backward transform
has access to. Notice that the <a 
href="http://www.vtvt.ece.vt.edu/research/references/video/DCT_Video_Compression/Zhang92a.pdf" >pyramid domain</a> (which is invariant to the
pixels displacements) has been used to estimate and compensate the
<!--l. 383--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-150013"></a>
                                                                  

                                                                  
<!--l. 387--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/forward_butterfly.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 3: </span><span  
class="content">Forward MCDWT butterﬂy.</span></div><!--tex4ht:label?: x1-150013 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 391--><div class="lstinputlisting">
<a 
 id="x1-15002r3"></a>
<a 
 id="x1-15003"></a>
<br /> <div class="caption" 
><span class="id">Listing 3: </span><span  
class="content">MCDWT.py (extract)</span></div><!--tex4ht:label?: x1-15002r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15004r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15005r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15006r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15007r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15008r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15009r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15010r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15011r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15012r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15013r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15014r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15015r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15016r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">base</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15017r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">fot</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15018r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15019r16"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15020r17"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15021r18"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15022r19"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15023r20"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15024r21"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15025r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15026r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15027r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15029r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15030r27"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15031r28"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15032r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15033r30"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15034r31"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15035r32"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15036r33"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15037r34"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15038r35"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15039r36"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15040r37"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15041r38"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">[1]</span>
   
   </div>
<!--l. 392--><div class="lstinputlisting">
<a 
 id="x1-15042r4"></a>
<a 
 id="x1-15043"></a>
<br /><div class="caption" 
><span class="id">Listing 4: </span><span  
class="content">simple_average.py (extract)</span></div><!--tex4ht:label?: x1-15042r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15044r1"></a></span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15045r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15046r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15047r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15048r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15049r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">/</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span>
   
   </div>
<!--l. 394--><p class="indent" >   Notice that, even if <!--l. 394--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 394--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
(at full resolution) are available at the decoder, only
<!--l. 395--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> is.
So, it does not make sense to search the low resolution structures of
<!--l. 396--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> in the high
resolution images <!--l. 396--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 397--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>,
because even if a perfect match is achieved (think about the three decompositions
<!--l. 398--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>,
<!--l. 398--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> and
<!--l. 398--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
are identical), the prediction error would be diﬀerent than
<!--l. 399--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
as a consequence of that the high resolution information is missing in
<!--l. 400--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-160005.2"></a>The MCDWT step</h4>
<!--l. 403--><p class="noindent" >A step of the MCDWT is carried out when the MCDWT butterﬂy is applied to all
the images of the input sequece using the pattern shown in the Fig. <a 
href="#x1-160014">4<!--tex4ht:ref: fig:forward_MCDWT_step --></a>. Notice that
only the images with an odd number are transformed. </p><hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-160014"></a>
                                                                  

                                                                  
<!--l. 409--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/forward_MCDWT_step.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 4: </span><span  
class="content">MCDWT forward step.</span></div><!--tex4ht:label?: x1-160014 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-170005.3"></a>The forward MCDWT</h4>
<!--l. 415--><p class="noindent" >The forward MCDWT is the result of appliying the forward MCDWT step recursively, to the image
with number <!--l. 416--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>i</mi></mrow></msup 
></math>,
where <!--l. 416--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
is the iteration of the MCDWT step. As a result, chooding
<!--l. 417--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
larte enough, except for the ﬁrst and the last image of the sequence, all the
<!--l. 419--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>-subbands
are temporally decorrelated.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-170015"></a>
                                                                  

                                                                  
<!--l. 423--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/temporal_decorrelation.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 5: </span><span  
class="content">MCDWT forward transform.</span></div><!--tex4ht:label?: x1-170015 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 427--><div class="lstinputlisting">
<a 
 id="x1-17002r5"></a>
<a 
 id="x1-17003"></a>
<br /> <div class="caption" 
><span class="id">Listing 5: </span><span  
class="content">MCDWT.py (extract)</span></div><!--tex4ht:label?: x1-17002r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17004r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Localization</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">of</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">the</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">input</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">output</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">images</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Example</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17005r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17006r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17007r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17008r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17009r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">of</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decompositions</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">to</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">process</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17010r7"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17011r8"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17012r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17013r10"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Number</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">of</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">levels</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">of</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">the</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">MCDWT</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">temporal</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">scales</span><span 
class="ectt-1000">).</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Controls</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17014r11"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">the</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">GOP</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">size</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17015r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17016r13"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">GOP_size</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17017r14"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">----+-----------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17018r15"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17019r16"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17020r17"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">4</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17021r18"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">8</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17022r19"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">4</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">16</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17023r20"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">5</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">32</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17024r21"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">|</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17025r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17026r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">P</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17027r24"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Predictor</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">to</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">use</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17029r26"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17030r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Average</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17031r28"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">--&#x003E;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Weighted</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Average</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17032r29"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17033r30"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Returns</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17034r31"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17035r32"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17036r33"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">None</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17037r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17038r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17039r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17040r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">for</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">t</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">range</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">T</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17041r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">i</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17042r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">read</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17043r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">while</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">i</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">//</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17044r41"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">read</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17045r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">read</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17046r43"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">self</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">__forward_butterfly</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17047r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">writeH</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17048r45"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17049r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">i</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17050r47"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">*=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17051r48"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17052r49"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">def</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">backward</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">self</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;/</span><span 
class="ecit-1000">tmp</span><span 
class="ecit-1000">/&#x0022;,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">=5,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">T</span><span 
class="ecit-1000">=2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17053r50"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2**</span><span 
class="ecit-1000">T</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17054r51"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">for</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">t</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">range</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">T</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17055r52"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">i</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17056r53"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">read</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17057r54"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">while</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">i</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">//</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17058r55"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">read</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17059r56"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">read</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17060r57"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">self</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">__backward_butterfly</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17061r58"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">writeH</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;{:03</span><span 
class="ecit-1000">d</span><span 
class="ecit-1000">}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17062r59"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17063r60"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">i</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+=</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17064r61"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">//=2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17065r62"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17066r63"></a></span><span 
class="ecit-1000">if</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">__name__</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">==</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;</span><span 
class="ecit-1000">__main__</span><span 
class="ecit-1000">&#x0022;:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17067r64"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17068r65"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">import</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">argparse</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17069r66"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17070r67"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">class</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">CustomFormatter</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">argparse</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">ArgumentDefaultsHelpFormatter</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">argparse</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000">RawDescriptionHelpFormatter</span><span 
class="ecit-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17071r68"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">pass</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17072r69"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17073r70"></a></span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">yes</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cp</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">rf</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">../</span><span 
class="ecit-1000">sequences</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">stockholm</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">tmp</span><span 
class="ecit-1000">/\</span><span 
class="ecit-1000">n</span><span 
class="ecit-1000">&#x0022;</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-180005.4"></a>(Spatial) Multiresolution</h4>
<!--l. 430--><p class="noindent" >Spatial dyadic multiresolution can be obtained by appliying a sequence of
(MDWT+MCDWT) steps (see Fig. <a 
href="#x1-180016">6<!--tex4ht:ref: fig:multiresolution --></a>).
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-180016"></a>
                                                                  

                                                                  
<!--l. 435--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/multiresolution.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 6:  </span><span  
class="content">MDWT+MCDWT  multiresolution  procedure.  The  input  to  the
second iteration of the MDWT+MCDWT transform is the output of a previous
(ﬁrst)  iteration  MDWT+MCDWT  transform.  The  second  iteration  is  only
applied to the scale 1.</span></div><!--tex4ht:label?: x1-180016 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.5   </span> <a 
 id="x1-190005.5"></a>Scalability provided by MCDWT</h4>
<!--l. 444--><p class="noindent" >The spatial decomposition generated by MCDWT is identical to the produced by
MDWT, and therefore, MCDWT provides the same spatial scalability than MDWT.
In order to obtain several spatial resolutions, MCDWT should be applied to the
low-frequency subbands, recursively. As it is shown in the example of the Figure <a 
href="#x1-180016">6<!--tex4ht:ref: fig:multiresolution --></a>,
MCDWT has been applied to the output of the example of the Figure <a 
href="#x1-170015">5<!--tex4ht:ref: fig:forward_MCDWT --></a>.
Notice that between two consecutive iterations of MCDWT, MDWT must be
applied to the low-frequency subband in order to reduce the resolution of the
analysis.
</p><!--l. 454--><p class="indent" >   On the other hand, MCDWT decreases the temporal scalability oﬀered
by MDWT to allowing only dyadic access (depending on required image
and the number of MCDWT levels, more than one decomposition needs to
be inversely transformed). For example, if only one step of the backward
transform is applied to the example of the Figure <a 
href="#x1-170015">5<!--tex4ht:ref: fig:forward_MCDWT --></a>, only the decompositions of
<!--l. 459--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></math>,
<!--l. 460--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math> and
<!--l. 460--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
></math> will
be reconstructed (the second <a 
href="https://en.wikipedia.org/wiki/Temporal_resolution" >temporal resolution</a>). If a second iteration of the
backward transform is used, all the decompositions are rendered.
</p><!--l. 465--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.6   </span> <a 
 id="x1-200005.6"></a>MCDWT 1-levels example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-8">
# You must be in the ’src’ directory.
 <br />
 <br />yes | cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 1D 1-levels forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/
 <br />
 <br /># 1D 1-levels forward MCDWT:
 <br />python3 -O MCDWT.py -p /tmp/
 <br />
 <br />rm /tmp/00?.png
 <br />
 <br /># 1D 1-levels backward MCDWT:
 <br />python3 -O MCDWT.py -b -p /tmp/
 <br />
 <br /># 1D 1-levels backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/
 <br />
 <br /># Visualization of the reconstruction:
 <br />for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/???.png.png
</div>
<!--l. 487--><p class="nopar" >
</p><!--l. 489--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.7   </span> <a 
 id="x1-210005.7"></a>Showing some statistics</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-9">
# You must be in the ’src’ directory.
 <br />
 <br />cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 1D 1-levels forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/
 <br />
 <br /># First and last decompositions are not transformed by MCDWT (step 1/2):
 <br />ls -l /tmp/HH000.png
 <br />ls -l /tmp/HL004.png
 <br />
 <br /># The rest, are transformed (step 1/2):
 <br />ls -l /tmp/HL001.png
 <br />ls -l /tmp/LH002.png
 <br />ls -l /tmp/HH003.png
 <br />
 <br /># Showing statistics (step 1/2):
 <br />python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/LH002.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL002.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HH002.png
 <br />
 <br /># 1D 1-levels forward MCDWT:
 <br />python3 -O MCDWT.py -p /tmp/
 <br />
 <br /># First and last decompositions are not transformed by MCDWT step 2/2):
 <br />ls -l /tmp/HH000.png
 <br />ls -l /tmp/HL004.png
 <br />
 <br /># The rest, are transformed (step 2/2):
 <br />ls -l /tmp/HL001.png
 <br />ls -l /tmp/LH002.png
 <br />ls -l /tmp/HG003.png
 <br />
 <br /># Showing statistics:
 <br />python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/LH002.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL002.png
                                                                  

                                                                  
 <br />python3 ../tools/show_statistics.py -i /tmp/HH002.png
 <br />
 <br /># Visualization of the H-subbands
 <br />for i in /tmp/LH00?.png; do convert -normalize $i $i.png; done; animate /tmp/LH00?.png.png
 <br />for i in /tmp/HL00?.png; do convert -normalize $i $i.png; done; animate /tmp/HL00?.png.png
 <br />for i in /tmp/HH00?.png; do convert -normalize $i $i.png; done; animate /tmp/HH00?.png.png
</div>
<!--l. 539--><p class="nopar" >
</p><!--l. 541--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.8   </span> <a 
 id="x1-220005.8"></a>Filtering the MC subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-10">
# You must be in the ’src’ directory.
 <br />
 <br />cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 1D 1-levels forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/
 <br />
 <br /># 1D 1-levels forward MCDWT:
 <br />python3 -O MCDWT.py -p /tmp/
 <br />
 <br /># Let’s clear the motion compensated subbands and reconstruct the sequence ...
 <br />
 <br /># Create a zero subband:
 <br />bash ../tools/create_black_image.sh; python ../tools/add_offset.py -i /tmp/zero.png -o /tmp/zero16.png -f 32768
 <br />python3 ../tools/show_statistics.py -i /tmp/zero16.png
 <br />
 <br /># &#x0022;Delete&#x0022; the motion compensated subbands:
 <br />yes | cp /tmp/zero16.png /tmp/LH001.png
 <br />yes | cp /tmp/zero16.png /tmp/HL001.png
 <br />yes | cp /tmp/zero16.png /tmp/HH001.png
 <br />yes | cp /tmp/zero16.png /tmp/LH002.png
 <br />yes | cp /tmp/zero16.png /tmp/HL002.png
 <br />yes | cp /tmp/zero16.png /tmp/HH002.png
 <br />yes | cp /tmp/zero16.png /tmp/LH003.png
 <br />yes | cp /tmp/zero16.png /tmp/HL003.png
 <br />yes | cp /tmp/zero16.png /tmp/HH003.png
 <br />
 <br /># 1D 1-levels backward MCDWT:
 <br />python3 -O MCDWT.py -b -p /tmp/
 <br />
 <br /># 1D 1-levels backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/
 <br />
 <br /># Visualization of the reconstruction:
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
 <br />
 <br /># Visualization of the differences with the original sequence:
 <br />rm -f /tmp/diff*.png; for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done; animate /tmp/diff*.png
</div>
<!--l. 581--><p class="nopar" >
</p><!--l. 583--><p class="noindent" >
                                                                  

                                                                  
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.9   </span> <a 
 id="x1-230005.9"></a>2D-MDWT-MCDWT 2-levels example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-11">
# You must be in the ’src’ directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/
 <br />python3 -O MCDWT.py -p /tmp/
 <br />python3 -O MDWT.py -p /tmp/LL
 <br />python3 -O MCDWT.py -p /tmp/LL
 <br />
 <br />rm /tmp/00?.png
 <br />
 <br />python3 -O MCDWT.py -p /tmp/LL -b
 <br />python3 -O MDWT.py -p /tmp/LL -b
 <br />python3 -O MCDWT.py -p /tmp/ -b
 <br />python3 -O MDWT.py -p /tmp/ -b
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 601--><p class="nopar" >
</p><!--l. 603--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-240006"></a>Adaptive motion compensation based on the distortion of the prediction
error</h3>
<!--l. 604--><p class="noindent" >As can be seen in the MCDWT buﬀerﬂy (see Fig. <a 
href="#x1-150013">3<!--tex4ht:ref: fig:forward_butterfly --></a>), both predictions
<!--l. 605--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> and
<!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> have
the same weight to build the prediction </p><table class="equation"><tr><td> <a 
 id="x1-24001r1"></a>
<!--l. 607--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
         <mrow 
><mn>2</mn></mrow></mfrac>         <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(1)</td></tr></table>
                                                                  

                                                                  
<!--l. 610--><p class="indent" >   This simple computation, that can have very eﬀective for example in <a 
href="https://biteable.com/blog/tips/video-transitions-effects-examples/" >dissolves</a>
video transitions, can also be counterproductive when objects appear only
in one of the reference images. For this reason, in this section a diﬀerent
predictor is proposed, based on the prediction error generated during the ME
process.
</p><!--l. 617--><p class="indent" >   Let <!--l. 617--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> the prediction
generated for the subband <!--l. 617--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
using <!--l. 618--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as reference
and <!--l. 618--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">→</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as motion, and
let <!--l. 619--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> the prediction
generated for <!--l. 619--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
using <!--l. 619--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as
reference and <!--l. 620--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">→</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
as motion. We now compute the prediction errors </p><table class="equation"><tr><td> <a 
 id="x1-24002r2"></a>
<!--l. 622--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(2)</td></tr></table>
<!--l. 629--><p class="indent" >   Now, we deﬁne the similarity matrices as </p><table class="equation"><tr><td> <a 
 id="x1-24003r3"></a>
<!--l. 630--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo>      <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">|</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-rel">|</mo></mrow></mfrac> </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo>      <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">|</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-rel">|</mo></mrow></mfrac><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(3)</td></tr></table>
<!--l. 637--><p class="indent" >   Notice that, if (for example) the error
<!--l. 637--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>, the
similarity is <!--l. 638--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
(the maximum similarity), and if the error is high, the similarity tends to be
<!--l. 639--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>.
</p><!--l. 641--><p class="indent" >   With this information, that can be recovered by the decoder, the improved
prediction is deﬁned as </p><table class="equation"><tr><td> <a 
 id="x1-24004r4"></a>
                                                                  

                                                                  
<!--l. 643--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                  <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
        <mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></mfrac>        <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(4)</td></tr></table>
<!--l. 647--><p class="indent" >   Notice that, if (for example) <!--l. 647--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
and <!--l. 648--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">≈</mo> <mn>0</mn></math>, then
<!--l. 649--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">≈</mo> <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></math>, and
viceversa. If <!--l. 650--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></math>,
then <!--l. 651--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-bin">+</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
        <mrow 
><mn>2</mn></mrow></mfrac>         </math>
(even if both similarities are small).
</p>
   <!--l. 653--><div class="lstinputlisting">
<a 
 id="x1-24005r6"></a>
<a 
 id="x1-24006"></a>
<br /> <div class="caption" 
><span class="id">Listing 6: </span><span  
class="content">weighted_average.py (extract)</span></div><!--tex4ht:label?: x1-24005r6 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24007r1"></a></span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24008r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24009r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24010r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24011r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24012r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24013r7"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24014r8"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">EAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAL</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24015r9"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">ECL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCL</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24016r10"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1/(1+</span><span 
class="ectt-1000">abs</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">EAL</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24017r11"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1/(1+</span><span 
class="ectt-1000">abs</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">ECL</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24018r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000">)/(</span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000">)</span>
   
   </div>
<!--l. 655--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-250007"></a>Orthogonal, orthonormal, and biorthogonal transforms</h3>
<!--l. 656--><p class="noindent" >In signal processing<span class="footnote-mark"><a 
href="index6.html#fn5x0"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-25001f5"></a> ,
a transform (such as the Discrete Cosine Transform, the Walsh-Hadamard Transform
or the Karhunen-Loeve Transform) is orthogonal when the coeﬃcients generated by
the transform are uncorrelated (there is no way to infer one coeﬃcient from
another).
</p><!--l. 666--><p class="indent" >   If the norm of all the basis of the an orthogonal transform is one, then
the transform is said orthonormal. Orthonormal transforms are interesting
because:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-25003x1">They are energy preserving: the energy of the output is the same than
     the energy of the input. This means that, for example, a quantization
                                                                  

                                                                  
     error produced in a coeﬃcient of the transform will generate the same
     quantization  error  at  the  output  (the  complete  signal)  of  the  inverse
     transform. The same holds by the forward transform.
     </li>
     <li 
  class="enumerate" id="x1-25005x2">The transform matrix of the inverse transform is the transpose of the
     forward transform. In orthogonal transforms, the transform matrix of the
     inverse transform is the inverse of the transform matrix of the forward
     transform.</li></ol>
<!--l. 682--><p class="indent" >   Biorthogonal transforms do no satisfy any of these features: they are not energy
preserving (this can be also observed because the frequency-domain responses of the
analysis and synthesis ﬁlters are not symmetric), and there is not an algebraic way
(matrix transposition/inversion) to compute the backward transform from the
forward one, and viceversa. This, that can be considered as a drawback, gives
an extra degree of freedom to design the analysis and the synthesis ﬁlters
(whose only requirement is that transform pair to be reversible), providing in
general the possibility of using more soﬁsticated ﬁlters such as those based
on non-linear ﬁltering, as for example, those based on motion estimation
algorithms.
</p><!--l. 694--><p class="indent" >   In general, each subband <!--l. 694--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
of a decomposition generated by a biorthogonal 2D-DWT transform have a diﬀerent subband
gain <!--l. 696--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>α</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
></math>.
Usually, the lower the frequency of the subband, the higher the gain. Notice also,
that these gains also are diﬀerent for each diﬀerent transform.
</p><!--l. 700--><p class="indent" >   Subband gains are important in lossy signal compression because they quantify
the relative importance of the wavelet coeﬃcients of the diﬀerent subbands when we
introduce distortion in the wavelet domain. Thus, for example, if we decide to
quantize a wavelet coeﬃcient, the amount of distortion that we are generating in the
signal domain will depend on the subband where that coeﬃcient is localized. In
general, low-frequency coeﬃcients are more “important” that high-frequency
ones.
</p><!--l. 709--><p class="indent" >   To compute the subband gains we have two options:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-25007x1">The algebraic way. We will need the expressions of the four ﬁlters (two
     anaylsis ﬁlters and two synthesis ﬁlters) and deduce the gains.
     </li>
     <li 
  class="enumerate" id="x1-25009x2">The algorithmic way. We will need to compute the energy of the impulse response
     of the inverse transform, when we apply such impulse to each one of the
     subbands of the decomposition. Supposing that, after appliying the DWT to an
     image, the coeﬃcients of the subband HH are the least energetic with an energy
     <!--l. 718--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>, the subband
     gain for subband <!--l. 719--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
     is computed as <table class="equation"><tr><td> <a 
 id="x1-25010r5"></a>
                                                                  

                                                                  
     <!--l. 720--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                             <msub><mrow 
><mi 
>α</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>𝜖</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
><mo 
class="MathClass-bin">∕</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(5)</td></tr></table>
     <!--l. 723--><p class="noindent" >where <!--l. 723--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>𝜖</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
></math>
     is the energy of the reconstruction when the impulse signal is localized at
     <!--l. 724--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>.
     Notice that all the gains should be larger than one.</p></li></ol>
<!--l. 728--><p class="indent" >   This computation can be also applied to MCDWT, by computing the subband gains as a function
of the number <!--l. 729--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>
of temporal decompositions.
<a 
 id="Q1-1-38"></a>
</p>
    
</body> 
</html>
                                                                  


