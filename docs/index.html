<!DOCTYPE html> 
<html> 
<head> <title>Progressive Resolution Motion Compensation (PRMC)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead"><a 
href="https://github.com/Sistemas-Multimedia/PRMC" >Progressive Resolution Motion Compensation
(PRMC)</a></h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">August 6, 2020</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-30001" id="QQ2-1-3">Transform coding and compression</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-40002" id="QQ2-1-4">The 2D-DWT (Distrete Wavelet Transform)</a></span>
<br />    <span class="subsectionToc" >2.1 <a 
href="#x1-50002.1" id="QQ2-1-5">Implementation of the 3 components (usually color) DWT step</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-60003" id="QQ2-1-7">Multi-level DWT structures</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-70004" id="QQ2-1-8">Scalability provided by the DWT</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-100005" id="QQ2-1-11">Motion DWT (MDWT)</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-110006" id="QQ2-1-13">Scalability provided by MDWT</a></span>
<br />   <span class="sectionToc" >7 <a 
href="#x1-150007" id="QQ2-1-17">Video transform alternatives</a></span>
<br />   <span class="sectionToc" >8 <a 
href="#x1-160008" id="QQ2-1-18">DWT structures and Laplacian Pyramids</a></span>
<br />   <span class="sectionToc" >9 <a 
href="#x1-170009" id="QQ2-1-19">Motion Compensated Orthogonal Laplacian Pyramid (MCOLP)</a></span>
<br />    <span class="subsectionToc" >9.1 <a 
href="#x1-180009.1" id="QQ2-1-20">The MCOLP butterﬂy</a></span>
<br />    <span class="subsectionToc" >9.2 <a 
href="#x1-190009.2" id="QQ2-1-23">The MCOLP transform</a></span>
<br />    <span class="subsectionToc" >9.3                                                                           <a 
href="#x1-200009.3" id="QQ2-1-25">Example:
<!--l. 32--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></a></span>
<br />    <span class="subsectionToc" >9.4                                                                           <a 
href="#x1-210009.4" id="QQ2-1-26">Example:
<!--l. 34--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></a></span>
<br />    <span class="subsectionToc" >9.5 <a 
href="#x1-220009.5" id="QQ2-1-27">Simpliﬁcation of the notation</a></span>
<br />    <span class="subsectionToc" >9.6                                                                           <a 
href="#x1-230009.6" id="QQ2-1-28">Example:
<!--l. 37--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>4</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>7</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></a></span>
<br />    <span class="subsectionToc" >9.7 <a 
href="#x1-240009.7" id="QQ2-1-29">Scalability provided by MCOLP</a></span>
<br />    <span class="subsectionToc" >9.8                      <a 
href="#x1-250009.8" id="QQ2-1-30">Example:                      3-iters                      of
<!--l. 40--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></a></span>
<br />   <span class="sectionToc" >10 <a 
href="#x1-2600010" id="QQ2-1-31">Adaptive motion compensation based on the energy of the estimated prediction error</a></span>
                                                                  

                                                                  
<br />   <span class="sectionToc" >11 <a 
href="#x1-2700011" id="QQ2-1-33">Lossy compression: quantization</a></span>
<br />    <span class="subsectionToc" >11.1 <a 
href="#x1-2800011.1" id="QQ2-1-34">Example: Eﬀects caused by the total attenuation of the motion compensated
(MCed) <!--l. 47--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands</a></span>
<br />    <span class="subsectionToc" >11.2   <a 
href="#x1-2900011.2" id="QQ2-1-35">Example:   Eﬀects   caused   by   the   quantization   of   MCed
<!--l. 48--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands</a></span>
<br />    <span class="subsectionToc" >11.3             <a 
href="#x1-3000011.3" id="QQ2-1-36">Example:             Quantization             of             all
<!--l. 49--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands (MCed and intra)</a></span>
<br />    <span class="subsectionToc" >11.4 <a 
href="#x1-3100011.4" id="QQ2-1-37">Example: Quantization of all subbands</a></span>
   </div>
<!--l. 13--><p class="noindent" >
</p>
   <h3 class="likesectionHead"><a 
 id="x1-2000"></a>Abstract</h3>
<!--l. 16--><p class="noindent" >PRMC is transform that inputs a video (sequence of frames) and outputs a sequence
of spatio-temporal subbands. It consists of two stages:
</p><!--l. 18--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-2002x1">MDWT (Motion Discrete Wavelet Transform), that computes the 2D-DWT
     (2 Dimensional - Discrete Wavelet Transform) to every frame, resulting a
     video representation with <!--l. 21--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>
     SRLs (Spatial Resolution Levels).
     </li>
     <li 
  class="enumerate" id="x1-2004x2">MCOLP (Motion Compensated in the Orthogonal Laplacian Pyramid),
     which estimates the motion in the lower SRL and compensates the motion
     in the high-frequencies of the higher SRL, using a Orthogonal Lapacial
     Pyramid  structure  that  has  a  critical  representation  in  the  2D-DWT
     domain.</li></ol>
<!--l. 29--><p class="noindent" >PRMC can be applied recursively to the lower SLR, producing a number of SRLs and
compensating the motion of the sequence.
</p><!--l. 33--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-30001"></a>Transform coding and compression</h3>
<!--l. 36--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Video" >Video</a> data contain high amounts of <a 
href="https://vicente-gonzalez-ruiz.github.io/redundancy/" >redundancy</a>, spatial and temporal.
For this reason, most of <a 
href="https://vicente-gonzalez-ruiz.github.io/video_compression/" >video encoders</a> compress an input sequence of
                                                                  

                                                                  
<a 
href="https://en.wikipedia.org/wiki/Digital_image" >images</a><span class="footnote-mark"><a 
href="index2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-3001f1"></a> ,
basically, in two stages: (1) a transform in the <a 
href="https://en.wikipedia.org/wiki/Time_domain" >time</a> and in the <a 
href="https://www.quora.com/What-is-spatial-domain-in-image-processing" >spatial</a> domains that
produces a collection of <a 
href="https://en.wikipedia.org/wiki/Decorrelation" >uncorrelated</a> <a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >coeﬃcients</a>, and (2) an <a 
href="https://en.wikipedia.org/wiki/Entropy_encoding" >entropy encoding</a> stage
which removes the statistical redundancy that can still remains after the
decorrelation (transform). Usually, these coeﬃcients have two interesting
features:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-3003x1">Usually,  a   <a 
href="https://vicente-gonzalez-ruiz.github.io/symbol_compression/" ><span 
class="ecbx-1000">smaller  entropy</span></a> than  the  original  pixels.  This  helps  to
     increase the <a 
href="https://en.wikipedia.org/wiki/Data_compression_ratio" >compression ratio</a>.
     </li>
     <li 
  class="enumerate" id="x1-3005x2">A <a 
href="https://en.wikipedia.org/wiki/Image_resolution" ><span 
class="ecbx-1000">multiresolution representation</span></a> <span 
class="ecbx-1000">(in space and time) </span>of the visual
     information.  This  provides  the  posibility  of  decoding  the  sequence  of
     images using a smaller resolution (in space and time). This feature is
     known as <a 
href="https://vicente-gonzalez-ruiz.github.io/video_compression/" >spatio-temporal scalability in video</a>.
     </li>
     <li 
  class="enumerate" id="x1-3007x3">Usually, <span 
class="ecbx-1000">most of the </span><a 
href="https://en.wikipedia.org/wiki/Energy_(signal_processing)" ><span 
class="ecbx-1000">signal energy</span></a> (and therefore, generally, most of
     the information interesting for the humans) <span 
class="ecbx-1000">is represented by </span><a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding" ><span 
class="ecbx-1000">a small</span>
     <span 
class="ecbx-1000">number of coeﬃcients</span></a>. This helps to improve the compression ratio
     and to prioritize the data in <a 
href="https://vicente-gonzalez-ruiz.github.io/media_encoding_models/" >progressive transmission scenarios</a>.</li></ol>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-40002"></a>The 2D-DWT (Distrete Wavelet Transform)</h3>
<!--l. 84--><p class="noindent" ><a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/#x1-3100020" >The 2D-DWT (2-Dimensions Distrete Wavelet
Transform)<span class="footnote-mark"><a 
href="index3.html#fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-4001f2"></a> </a>
is a digital transform that, applied to an image, performs a spatial
decorrelation of the pixels and obtains a <a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/index.html#x1-3500024" >multiresolution (generally dyadic)
representation</a> of such image, conforming a collection of spatial subbands or
<a 
href="https://en.wikipedia.org/wiki/Sub-band_coding" >decomposition</a><span class="footnote-mark"><a 
href="index4.html#fn3x0"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-4002f3"></a> 
<!--l. 92--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>L</mi><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>L</mi><mi 
>H</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>, were
<!--l. 92--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> stands for 1D low-pass
<a 
href="https://en.wikipedia.org/wiki/Filter_bank" >analysis</a> <a 
href="https://en.wikipedia.org/wiki/Filter_(signal_processing)" >ﬁltering</a> and <!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
for 1D high-pass analysis ﬁltering. Thus, for example,
<!--l. 95--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>H</mi></math> is the result of applying
the <!--l. 96--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> ﬁlter to the rows
                                                                  

                                                                  
and downsample<span class="footnote-mark"><a 
href="index5.html#fn4x0"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-4003f4"></a> 
the output by a factor of 2, and then applying the
<!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> ﬁlter
to the columns of the previous decomposition and again, donwsampling by a factor of
2. The subbands are populated by coeﬃcients representing diﬀerent spatial areas,
depending on localization of the coeﬃcient and the resolution level. Notice
that it is possible to compute the (2D-)DWT using 1D ﬁlters the DWT is
<a 
href="http://home.ustc.edu.cn/~xuedixiu/image.ustc/course/dip/DIP14-ch3.pdf" >separable</a>.
</p><!--l. 106--><p class="indent" >   The downsampling operation generates a critically sampled structure, where the number
of output DWT coeﬃcients is equal to the number of input pixels. This is possible because
ideally, the <!--l. 108--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
ﬁlter is designed to reject the frecuencies that the
<!--l. 109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> ﬁlter
pass, and viceversa (it is said that the ﬁlters are complementary, or that they form a
<a 
href="https://en.wikipedia.org/wiki/Filter_bank#Perfect_reconstruction_filter_banks" >perfect-reconstruction ﬁlter bank</a>). In the practice, there is always some aliasing
(overlaping between the response of the ﬁlters in the frequency domain), but this does not
aﬀect<span class="footnote-mark"><a 
href="index6.html#fn5x0"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-4004f5"></a> 
to the number of output coeﬃcients. In terms of <a 
href="https://en.wikipedia.org/wiki/Linear_algebra" >Linear Algebra</a>, analysis
<!--l. 120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> and
<!--l. 120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> ﬁlters, and
the synthesis <!--l. 120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></math>
and <!--l. 120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mo 
class="MathClass-bin">−</mo><mn>1</mn></mrow></msup 
></math>
ﬁlters (the ﬁlters that reconstruct the pixels from the coeﬃcients generated by
<!--l. 122--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> and
<!--l. 122--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>)
would be <a 
href="https://en.wikipedia.org/wiki/Orthogonality" >orthogonal</a>, that is, the basis functions that they convolve with the signals
are completely indenpendent.
</p><!--l. 127--><p class="indent" >   For the sake of simplicity, we will denote the 1-iteration DWT spatial decomposition
as <!--l. 128--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
where <!--l. 128--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>L</mi><mi 
>L</mi></math>
and <!--l. 128--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>L</mi><mi 
>H</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>.
See also <a 
href="https://nbviewer.jupyter.org/github/Sistemas-Multimedia/PRMC/blob/master/docs/DWT_vs_LPT.ipynb" >DWT vs OLP</a>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-50002.1"></a>Implementation of the 3 components (usually color) DWT step</h4>
<!--l. 138--><p class="noindent" ><a 
href="https://github.com/Sistemas-Multimedia/PRMC/blob/master/src/DWT.py" >DWT.py</a> (see Fig. <a 
href="#x1-5103r1">1<!--tex4ht:ref: fig:DWT --></a>) implements the forward (DWT) and backward (iDWT)
1-iteration (step) DWT for color images.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 144--><div class="lstinputlisting">
<a 
 id="x1-5001r1"></a>
<a 
 id="x1-5002"></a>
<br /> <div class="caption" 
><span class="id">Listing 1: </span><span  
class="content">1-iteration DWT (<a 
href="https://github.com/Sistemas-Multimedia/PRMC/blob/master/src/DWT.py" >DWT.py</a>).</span></div><!--tex4ht:label?: x1-5001r2 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5003r1"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5004r2"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5005r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">wavelet</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">bior3</span><span 
class="ectt-1000">.5</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5006r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">wavelet</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">wavelet</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5007r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5008r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5009r7"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">show</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5010r8"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">Available</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">wavelets</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5011r9"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">family</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">families</span><span 
class="ectt-1000">():</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5012r10"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">%</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">family</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">%</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">family</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">join</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">wavelist</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">family</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5013r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5014r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5015r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">multicomponent</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5016r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5017r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5018r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5019r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5020r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">]</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">usually</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">for</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">example</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">YUV</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5021r19"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5022r20"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5023r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5024r22"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5025r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5026r24"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">V</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5027r25"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5028r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5029r27"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5030r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5031r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5032r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5033r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5034r32"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5035r33"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5036r34"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5037r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5038r36"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5039r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">L</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">L</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">low</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequency</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5040r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subband</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequency</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5041r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subband</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">are</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5042r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">multicomponent</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5043r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5044r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5045r43"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5046r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5047r45"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5048r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5049r47"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5050r48"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5051r49"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5052r50"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5053r51"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5054r52"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5055r53"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5056r54"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5057r55"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">This</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">structure</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">provides</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">spatial</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">resolution</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5058r56"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5059r57"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5060r58"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5061r59"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">y</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5062r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5063r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5064r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5065r63"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5066r64"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5067r65"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5068r66"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5069r67"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5070r68"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt2</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">wavelet</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5071r69"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5072r70"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5073r71"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5074r72"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5075r73"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5076r74"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5077r75"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5078r76"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5079r77"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5080r78"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5081r79"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5082r80"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5083r81"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5084r82"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5085r83"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5086r84"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5087r85"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5088r86"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5089r87"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5090r88"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5091r89"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inversely</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5092r90"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5093r91"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5094r92"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5095r93"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5096r94"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5097r95"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][2]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5098r96"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5099r97"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5100r98"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ncomp</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5101r99"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">idwt2</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">wavelet</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">’</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-5102r100"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span>
</div>
<a 
 id="x1-5103r1"></a>
<a 
 id="x1-5104"></a>
<br />                                                                  <div class="caption" 
><span class="id">
Figure 1: : </span><span  
class="content">Implementation of the multicomponent 1-iteration DWT (forward
and backward). More information about the implementation can be found at
<a 
href="https://pywavelets.readthedocs.io/en/latest/index.html" >PyWavelets</a>.
</span></div><!--tex4ht:label?: x1-5103r2 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-60003"></a>Multi-level DWT structures</h3>
<!--l. 157--><p class="noindent" >A <!--l. 157--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math>-iterations<span class="footnote-mark"><a 
href="index7.html#fn6x0"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-6001f6"></a> 
dyadic DWT is the result of a recursive use of the 1-iteration DWT applied to the
<!--l. 161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> subband,
<!--l. 161--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math> times, producing a
<!--l. 162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>N</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>-levels dyadic structure
which is able to provide <!--l. 162--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>
Spatial Resolution Levels (SRL’s). For example, in the Fig. <a 
href="#x1-6002r2">2<!--tex4ht:ref: fig:2-levels_DWT --></a>
the DWT has been applied 2-times, generating 3 SRLs: (1)
<!--l. 165--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>, (2)
<!--l. 165--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>, and
(3) <!--l. 166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>,
where <!--l. 166--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle></math>
stands for inverse DWT.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<pre class="verbatim" id="verbatim-1">
    +------+------+-------------+ 0         +------+------+-------------+
    |      |      |             |           |      |      |             |
    | LL^2 | LH^2 |             |           | L^2  |      |             |
    |      |      |             |           |      |      |             |
    +------+------+     LH^1    |           +------+      |             |
    |      |      |             |           |             |             |
    | HL^2 | HH^2 |             |           |        H^2  |             |
    |      |      |             | Y/2-1     |             |             |
    +------+------+-------------+       =   +-------------+             |
    |             |             |           |                           |
    |             |             |           |                           |
    |             |             |           |                           |
    |     HL^1    |     HH^1    |           |                    H^1    |
    |             |             |           |                           |
    |             |             |           |                           |
    |             |             | Y-1       |                           |
    +-------------+-------------+           +---------------------------+
    0           X/2-1         X-1
</pre>
<!--l. 189--><p class="nopar" > <a 
 id="x1-6002r2"></a>
<a 
 id="x1-6003"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 2:              :              </span><span  
class="content">Decomposition              generated              by
<!--l. 190--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>t</mi><mi 
>e</mi><mi 
>r</mi><mi 
>s</mi></mstyle> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
using the standard notation (left) and the compact notation (right).
</span></div><!--tex4ht:label?: x1-6002r3 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-70004"></a>Scalability provided by the DWT</h3>
<!--l. 199--><p class="noindent" >Depending on the number of subband levels (pyramid levels in the <a 
href="https://vicente-gonzalez-ruiz.github.io/pyramids-and-wavelets/" >OLP</a>),
we can reconstruct an image at diﬀerent spatial scales (resolutions).
For example, if a image has been transformed using the DWT of
<!--l. 202--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>
iterations (see Fig. <a 
href="#x1-6002r2">2<!--tex4ht:ref: fig:2-levels_DWT --></a>), we get: </p>
     <ul class="itemize1">
     <li class="itemize">Subband <!--l. 205--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math> with the
     scale <!--l. 205--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math> of the image.
     If such image is <!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi></math>, we
     will denote the scale <!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>
     as <!--l. 206--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>.
                                                                  

                                                                  
     <pre class="verbatim" id="verbatim-2">
         +------+
         |      |
     Y/4 |  L^2 |
         |      |
         +------+
            X/4
</pre>
     <!--l. 214--><p class="nopar" >
     </p></li>
     <li class="itemize">Subband <!--l. 215--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
><mo 
class="MathClass-rel"> :</mo><mo 
class="MathClass-rel">=</mo> <mi 
>L</mi> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">,</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     with <!--l. 216--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
></math>.
                                                                  

                                                                  
     <pre class="verbatim" id="verbatim-3">
         +-------------+
         |             |
         |             |
     Y/2 |     L^1     |
         |             |
         |             |
         +-------------+
               X/2
</pre>
     <!--l. 226--><p class="nopar" >
     </p></li>
     <li class="itemize"><!--l. 228--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math> (the original image)
     with the scale <!--l. 229--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>I</mi><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mi 
>I</mi></math>.
                                                                  

                                                                  
     <pre class="verbatim" id="verbatim-4">
         +---------------------------+
         |                           |
         |                           |
         |                           |
         |                           |
         |                           |
         |                           |
       Y |            L^0            |
         |                           |
         |                           |
         |                           |
         |                           |
         |                           |
         |                           |
         +---------------------------+
                       X
</pre>
     <!--l. 247--><p class="nopar" ></p></li></ul>
<!--l. 254--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-80004"></a>Example: A 1-iteration DWT</h4>
<!--l. 257--><p class="noindent" >An image is transformed, generating four subbands
<!--l. 257--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math>,
<!--l. 257--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>H</mi></math>,
<!--l. 257--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><mi 
>L</mi></math> and
<!--l. 258--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><mi 
>H</mi></math>.
                                                                  

                                                                  
</p>
   <pre class="verbatim" id="verbatim-5">
# You must be in the ’src’ directory.
# Copy an image (the output directory must be the same as the input one).
rm /tmp/*.png
cp ../sequences/stockholm/000.png /tmp
# 1-iteration 2D DWT.
python3 -O DWT.py -p /tmp/ -i 000
# Visualize the subbands.
display -normalize /tmp/LL000.png # &#x003C;- LL^1
display -normalize /tmp/LH000.png # &#x003C;- LH^1
display -normalize /tmp/HL000.png # &#x003C;- HL^1
display -normalize /tmp/HH000.png # &#x003C;- HH^1
# 1-iteration 2D iDWT.
python3 -O DWT.py -b -p /tmp/ -i 000
# Visualize the reconstruction.
python3 ../tools/substract_offset.py -i /tmp/000.png -o /tmp/1.png
display /tmp/1.png
# Show diferences (PyWavelets uses floating point arithmetic).
../tools/show_differences.sh -1 /tmp/000.png -2 ../sequences/stockholm/000.png -o /tmp/diffs.png
display /tmp/diffs.png
</pre>
<!--l. 285--><p class="nopar" >
</p><!--l. 289--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-90004"></a>Example: A 2-iterations DWT (<!--l. 289--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn> <mo 
class="MathClass-bin">×</mo><mstyle mathvariant="monospace"><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle></math>)</h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-6">
# You must be in the ’src’ directory.
# Copy a image (the output directory must be the same than the input one).
rm /tmp/*.png
cp ../sequences/stockholm/000.png /tmp
# First iteration.
python3 -O DWT.py -p /tmp/ -i 000
# Second iteration.
python3 -O DWT.py -p /tmp/LL -i 000
# Visualize the subbands.
ls -l /tmp/*.png
display -normalize /tmp/LL000.png # &#x003C;- LL^1
display -normalize /tmp/LH000.png # &#x003C;- LH^1
display -normalize /tmp/HL000.png # &#x003C;- HL^1
display -normalize /tmp/HH000.png # &#x003C;- HH^1
display -normalize /tmp/LLLL000.png # &#x003C;- LL^2
display -normalize /tmp/LLLH000.png # &#x003C;- LH^2
display -normalize /tmp/LLHL000.png # &#x003C;- HL^2
display -normalize /tmp/LLHH000.png # &#x003C;- HH^2
# Reverse second iteration.
python3 -O DWT.py -b -p /tmp/LL -i 000
display -normalize /tmp/LL000.png
# Reverse first iteration.
python3 -O DWT.py -b -p /tmp/ -i 000
python3 ../tools/substract_offset.py -i /tmp/000.png -o /tmp/1.png
display /tmp/1.png
# Show diferences.
../tools/show_differences.sh -1 /tmp/000.png -2 ../sequences/stockholm/000.png -o /tmp/diffs.png
display /tmp/diffs.png
</pre>
<!--l. 328--><p class="nopar" >
</p><!--l. 334--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-100005"></a>Motion DWT (MDWT)</h3>
                                                                  

                                                                  
<!--l. 337--><p class="noindent" >The 2D-DWT can be applied to a sequence of frames (images) by simply
transforming each one independently. This is done, for example, in the
<a 
href="https://vicente-gonzalez-ruiz.github.io/JPEG2000/" >Motion JPEG2000 video compression standard</a>. Notice that only the spatial
redundancy is exploited in MDWT (all the temporal redundancy still
remains in the video). The decomposition structure generated by MDWT is
shown in the Fig <a 
href="#x1-10001r3">3<!--tex4ht:ref: fig:MDWT-subbands --></a>. The 1-iteration MDWT inputs a sequence of frames
<!--l. 344--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and outputs a sequence
of decompositions <!--l. 345--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
also called sequence spatial subbands. In all this discussion,
<!--l. 346--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math> is an integer
number starting a <!--l. 346--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
(<!--l. 346--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></math>
is always the ﬁrst frame of the video). Notice that
<!--l. 347--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> represents the scale
<!--l. 348--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math> of the sequence (a version
of the original video <!--l. 349--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
but with a resolution <!--l. 349--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Y</mi><mo 
class="MathClass-bin">∕</mo><mn>2</mn> <mo 
class="MathClass-bin">×</mo> <mi 
>X</mi><mo 
class="MathClass-bin">∕</mo><mn>2</mn></math>),
and that <!--l. 350--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>M</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
See the Fig. <a 
href="#x1-10056r4">4<!--tex4ht:ref: fig:MDWT-implementation --></a> for more details.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 354--><p class="noindent" ><div style="text-align:center;"> <img width=600 src="graphics/forward_MDWT.svg" /> </div>  <a 
 id="x1-10001r3"></a>
<a 
 id="x1-10002"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 3: : </span><span  
class="content">Subbands produced by the MDWT.                          </span></div><!--tex4ht:label?: x1-10001r5 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 362--><div class="lstinputlisting">
<a 
 id="x1-10003r2"></a>
<a 
 id="x1-10004"></a>
<br /> <div class="caption" 
><span class="id">Listing 2: </span><span  
class="content">MDWT (<a 
href="https://github.com/Sistemas-Multimedia/PRMC/blob/master/src/MDWT.py" >MDWT.py</a>).</span></div><!--tex4ht:label?: x1-10003r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10005r1"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">MDWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10006r2"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10007r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10008r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10009r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10010r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10011r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10012r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10013r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10014r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">placed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">at</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10015r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10016r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10017r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10018r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10019r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10020r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10021r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10022r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10023r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10024r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10025r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10026r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10027r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10028r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10029r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10030r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10031r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10032r28"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10033r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10034r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10035r31"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10036r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10037r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">placed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">at</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10038r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10039r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10040r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10041r37"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10042r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10043r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10044r40"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10045r41"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10046r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10047r43"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10048r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10049r45"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10050r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10051r47"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10052r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10053r49"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10054r50"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-10055r51"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span>
</div>
<!--l. 362--><p class="noindent" >. <a 
 id="x1-10056r4"></a>
<a 
 id="x1-10057"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 4: : </span><span  
class="content">Implementation of the MDWT.
</span></div><!--tex4ht:label?: x1-10056r5 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-110006"></a>Scalability provided by MDWT</h3>
<!--l. 372--><p class="noindent" >MDWT sequences (of (subband) decompositions) are scalable in space and in time.
Spatial scalability is a direct consequence of the DWT (the number of SRLs can be
controlled by the number of iterations of DWT). On the other hand, it is trivial to
observe that MDWT provides <span 
class="ecti-1000">fully </span>temporal scalability (we can access to the
images randomly) because each image of the input sequence is transformed
independently.
</p><!--l. 384--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-120006"></a>Example: 1-iteration MDWT (<!--l. 384--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>M</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>)</h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-7">
# You must be in the ’src’ directory.
rm /tmp/*.png
# Create the output directory for the 1st-level decompositions.
yes | cp ../sequences/stockholm/*.png /tmp
# 2D 1-iteration MDWT.
python3 -O MDWT.py -p /tmp/ -N 5
# Visualize the subbands.
for i in /tmp/LL00?.png; do convert -normalize $i $i.norm; done
animate /tmp/LL*.norm
for i in /tmp/LH00?.png; do convert -normalize $i $i.norm; done
animate /tmp/LH*.norm
for i in /tmp/HL00?.png; do convert -normalize $i $i.norm; done
animate /tmp/HL*.norm
for i in /tmp/HH00?.png; do convert -normalize $i $i.norm; done
animate /tmp/HH*.norm
# 1-iteration iMDWT.
python3 -O MDWT.py -b -p /tmp/ -N 5
# Visualization of the reconstruction.
for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done
animate /tmp/???.png.png
# Visualization of the residue.
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done
animate /tmp/diff*.png
</pre>
<!--l. 417--><p class="nopar" >
</p><!--l. 421--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-130006"></a>Example: 2-iterations MDWT (<!--l. 421--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn> <mo 
class="MathClass-bin">×</mo><mstyle mathvariant="monospace"><mi 
>M</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>)</h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-8">
# You must be in the ’src’ directory.
rm /tmp/*.png
# Create the output directory for the 1st-level decompositions.
yes | cp ../sequences/stockholm/*.png /tmp
# 2-iterations MDWT.
python3 -O MDWT.py -p /tmp/ -N 5
python3 -O MDWT.py -p /tmp/LL -N 5
# 2-iterations iMDWT.
python3 -O MDWT.py -b -p /tmp/LL -N 5
python3 -O MDWT.py -b -p /tmp/ -N 5
# Visualization of the reconstruction.
for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done
animate /tmp/???.png.png
# Visualization of the residue.
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done
animate /tmp/diff*.png
</pre>
<!--l. 446--><p class="nopar" >
</p><!--l. 450--><p class="noindent" >
</p>
   <h4 class="likesubsectionHead"><a 
 id="x1-140006"></a>Example: Interpolating (a sequence) with the DWT</h4>
<!--l. 453--><p class="noindent" >If we apply an inverse transform to the original
frames<span class="footnote-mark"><a 
href="index8.html#fn7x0"><sup class="textsuperscript">7</sup></a></span><a 
 id="x1-14001f7"></a> ,
supposing that they are the low-frequency subbands of the input
decomposition, and that the high-frequency subbands are zero, we
can interpolate each frame of the original sequence by a factor of
<!--l. 457--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math> in
each direction.
                                                                  

                                                                  
</p>
   <pre class="verbatim" id="verbatim-9">
# You must be in the ’src’ directory.
rm /tmp/*.png
# Copy the current images as LL subbands.
rm /tmp/*.png
for i in {0..4}; do
  image_number=$(printf &#x0022;%03d&#x0022; $i)
  cp ../sequences/stockholm/$image_number.png /tmp/LL$image_number.png
done
# Apply the inverse DWT.
python3 -O MDWT.py -b -p /tmp/ -N 5
# Visualization of the reconstruction.
for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done
animate /tmp/???.png.png
# Notice that the dynamic range of the sequence could be changed (the
# images could appear brighter of darker). This is consequence of the
# relative gain of the LL subband in respect of the rest of subbands.
rm /tmp/*.norm
for i in /tmp/???.png; do convert -normalize $i $i.norm; done
animate /tmp/*.png.norm
</pre>
<!--l. 483--><p class="nopar" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-150007"></a>Video transform alternatives</h3>
<!--l. 492--><p class="noindent" >To remove both, spatial and temporal redundancies, two diﬀerent alternatives are
available:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-15002x1">In a <span 
class="ecbx-1000">“t+2D” transform</span>, the video is ﬁrst <a 
href="https://en.wikipedia.org/wiki/Digital_filter#Analysis_techniques" >analyzed</a> (transformed) along
     the time domain and next, over the space domain.
     </li>
     <li 
  class="enumerate" id="x1-15004x2">A <span 
class="ecbx-1000">“2D+t” transform </span>does just the opposite.</li></ol>
<!--l. 500--><p class="noindent" >Each choice has a number of <span 
class="ecti-1000">pros </span>and <span 
class="ecti-1000">cons</span>. For example, in a “t+2D” transform we can
apply directly any <a 
href="https://vicente-gonzalez-ruiz.github.io/video_compression/" >frame predictor</a> based on <a 
href="https://en.wikipedia.org/wiki/Motion_estimation" >Motion Estimation (ME)</a> because the
input is a normal video. On the contrary, if we implement a “2D+t” transform, the
                                                                  

                                                                  
input to the motion estimator is a sequence decompositions. <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >The overwhelming
majority of DWT’s</a> are not <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >shift invariant</a>, which basically means that, exactly the
same object placed in two diﬀerent frames in diﬀerent positions will generate diﬀerent
wavelet coeﬃcients, even if the displacement is an integer number of pixels and
therefore, the pixels of the object in both frames are identical. Therefore, motion
estimators that compare coeﬃcient values will not work with accuracy on the
decomposition domain. On the other hand, if we want to provide true spatial
scalability (processing only those <a 
href="https://www.tutorialspoint.com/dip/spatial_resolution.htm" >spatial resolutions</a> (scales) necessary to get a
spatially scaled of our video), a “t+2D” transformed video presents several
drawbacks:
</p><!--l. 522--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-15006x1">The perfect reconstruction of the original frames only is possible if the “t”
     stage is identical at both, the <a 
href="https://en.wikipedia.org/wiki/Encoder" >encoder</a> and the <a 
href="https://en.wikipedia.org/wiki/Decoder" >decoder</a>. Therefore, if the
     encoder applies “t” at the full resolution (scale 0), the decoder must apply
     “t” also at full resolution, even if the resolution of the reconstructed frames
     were smaller. This could be unfeasible for receivers with low computational
     resourcers.
     </li>
     <li 
  class="enumerate" id="x1-15008x2">Perfect reconstruction can be sacriﬁed by using a quantized version of the
     motion information, but the rate/distortion (R/D) tradeoﬀ will be worst.
     In this case, also, the decoder would be wasting motion information.
     </li>
     <li 
  class="enumerate" id="x1-15010x3">This last problem (the waste of motion information) could be avoided if
     the motion data were encoded in a progressive representation (suitable
     for working in a diﬀerent spatial resolution of the frames). Unfortunately,
     progressive representations usually need more data than non-progressive
     ones. Moreover, it is not trivial to pack the motion data and the texture
     data in a single code-stream to provide all the posible types of scalability
     (temporal, spatial, and quality).</li></ol>
<!--l. 547--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-160008"></a>DWT structures and Laplacian Pyramids</h3>
<!--l. 550--><p class="noindent" >This, as it will be seen after, shift variance of the wavelet coeﬃcients is a problem
when we want to perform comparisons in the DWT domain. As it can be supposded,
this problem can be mitigated if the downsampling operation is removed, as happens
in the <a 
href="https://ieeexplore.ieee.org/document/1408191" >Overcomplete DWT</a> and in the <a 
href="http://fourier.eng.hmc.edu/e161/lectures/canny/node3.html" >Laplacian Pyramids</a> (LP). Fortunately, there is
an equivalence between DWT subbands and a family of Laplacian Pyramids that we
will call Orthogonal LP’s (OLP’s), and it is quite straightforward to <a 
href="https://vicente-gonzalez-ruiz.github.io/pyramids-and-wavelets/" >convert a
decomposition representation into a pyramid representation and viceversa</a>, when the
                                                                  

                                                                  
<!--l. 562--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> and
<!--l. 562--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> ﬁlters
are used for both, the DWT and the LP, are orghogonal. If the ﬁlters used
for generating the LP were not orthogonal, then it would not be possible
to travel from the LP domain through the DWT domain without lossing
information.
</p><!--l. 569--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-170009"></a>Motion Compensated Orthogonal Laplacian Pyramid (MCOLP)</h3>
<!--l. 572--><p class="noindent" >MCOLP is a “2D+t” transform. The “2D” stage is an 1-iteration MDWT, and the “t” stage is
basicallt a <!--l. 573--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>-iterations
1D <a 
href="https://en.wikipedia.org/wiki/Motion_compensation" >Motion Compensated (MC)</a> DWT. The MDWT removes the spatial redundancy
of the video, and the temporal DWT removes the temporal redundancy between
<!--l. 577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands. The
number of iterations <!--l. 577--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>
determines the <a 
href="https://en.wikipedia.org/wiki/Group_of_pictures" >GOP</a> size </p><table class="equation"><tr><td> <a 
 id="x1-17001r1"></a>
<!--l. 579--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                             <mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>T</mi></mrow></msup 
><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(1)</td></tr></table>
<!--l. 584--><p class="indent" >   We can think of MCLOPT such as a <a 
href="https://ieeexplore.ieee.org/abstract/document/1369697" >MCTF</a> applied to a given spatial resolution
level, and because the motion is estimated using the previous lower resolution level
(which is available at the decoder), it is not necessary to send the motion information
in the code-stream. Notice also that this process can be used for any number of
spatial resolution levels, simply by using MCLOPT iteratively on the low spatial
resolution level (resulting of the previous iteration of PRMC that applies ﬁrst a
MDWT).
</p><!--l. 594--><p class="indent" >   A peculiar feature of MCLOP is that the predict step used in the “t”-DWT is
performed in the OLP domain, which is shift invariant because the coeﬃcients have
not been downsampled (as happens in the DWT domain).
</p><!--l. 601--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.1   </span> <a 
 id="x1-180009.1"></a>The MCOLP butterﬂy</h4>
                                                                  

                                                                  
<!--l. 604--><p class="noindent" >The butterly inputs three decompositions
<!--l. 604--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
<!--l. 604--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
<!--l. 605--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>, and outputs a
residue subband <!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo accent="true">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which replaces to <!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
in the original <!--l. 606--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
decomposition. Therefore, after the use of the buﬀerﬂy, we get
<!--l. 607--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math> ,
<!--l. 608--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo accent="true">̃</mo></mover> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo accent="true">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
(notice that only the high-frequency information of
<!--l. 609--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> has been
compensated) and <!--l. 609--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>.
This replacement is fully reversible because the forward transform uses only the
information that the inverse transform will have access to.
</p><!--l. 613--><p class="indent" >   Notice that the <a 
href="http://www.vtvt.ece.vt.edu/research/references/video/DCT_Video_Compression/Zhang92a.pdf" >pyramid domain</a> (which is near-invariant to the
pixels displacements) has been used to estimate and compensate the
<!--l. 616--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands. This means that the motion has been estimated using
integer (not sub-) pixel accuracy, and that the motion has been
compensated also integer pixel accuracy in the OLP domain, that implies
<!--l. 619--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mo 
class="MathClass-bin">∕</mo><mn>2</mn></math>-pixel
accuracy in the DWT domain.
</p><!--l. 622--><p class="indent" >   After the MC, a DWT is computed to
<!--l. 622--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo accent="true">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math> in
order to get again a critically sampled version these subbands. After this, the
<!--l. 623--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>
subband is discarded (in fact, replaced by the original subband). The MC
operation can generate information in this subband, because the MC can
produce low-frequency information that could not be represented by the
<!--l. 627--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subband. However,
hopefully the energy of the <!--l. 627--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
subband is going to be small in most of the cases, and in any case, this is not an
unsolvable problem because the decoder is going to replicate exactly this
behaviour.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 633--><p class="noindent" ><div style="text-align:center;"> <img width=1000 src="graphics/forward_butterfly.svg" /> </div>  </p><!--l. 636--><div class="lstinputlisting">
<a 
 id="x1-18001r3"></a>
<a 
 id="x1-18002"></a>
<br /> <div class="caption" 
><span class="id">Listing 3: </span><span  
class="content">MCOLP butterﬂy (<a 
href="https://github.com/Sistemas-Multimedia/PRMC/blob/master/src/MCOLP.py" >MCOLP.py</a>).</span></div><!--tex4ht:label?: x1-18001r9 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18003r1"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">MCOLP</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18004r2"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18005r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">wavelet</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">bior3</span><span 
class="ectt-1000">.5</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18006r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zeros</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18007r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zeros</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zeros</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zeros</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18008r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">wavelet</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18009r7"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18010r8"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18011r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCOLP</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18012r10"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18013r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18014r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18015r13"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18016r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18017r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18018r16"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18019r17"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18020r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18021r19"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18022r20"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18023r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">requency</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">information</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18024r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18025r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18026r24"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18027r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18028r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18029r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18030r28"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18031r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18032r30"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18033r31"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18034r32"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18035r33"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18036r34"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18037r35"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18038r36"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18039r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Backward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCOLP</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18040r38"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18041r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18042r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18043r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18044r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18045r43"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">tilde</span><span 
class="ecit-1000">{</span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">}</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18046r44"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18047r45"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18048r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18049r47"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18050r48"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18051r49"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18052r50"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18053r51"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18054r52"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18055r53"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18056r54"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18057r55"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18058r56"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18059r57"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18060r58"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18061r59"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18062r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18063r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18064r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">[1]</span>
</div>
<!--l. 639--><div class="lstinputlisting">
<a 
 id="x1-18065r4"></a>
<a 
 id="x1-18066"></a>
<br />     <div class="caption" 
><span class="id">Listing 4:        </span><span  
class="content">Computation        of        the        prediction        frame
(<a 
href="https://github.com/Sistemas-Multimedia/PRMC/blob/master/src/simple_average.py" >simple_average.py</a>).</span></div><!--tex4ht:label?: x1-18065r9 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18067r1"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18068r2"></a></span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18069r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18070r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18071r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-18072r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span>
</div>
<a 
 id="x1-18073r5"></a>
<a 
 id="x1-18074"></a>
<br />                                                                  <div class="caption" 
><span class="id">
Figure 5: : </span><span  
class="content">Forward and inverse MCOLP butterﬂies, and computation of the
prediction frame.                                                   </span></div><!--tex4ht:label?: x1-18073r9 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">9.2   </span> <a 
 id="x1-190009.2"></a>The MCOLP transform</h4>
<!--l. 666--><p class="noindent" >The <!--l. 666--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>-iterations
MCOLP (see Fig. <a 
href="#x1-19105r6">6<!--tex4ht:ref: fig:MCOLP --></a>) is the result of applying the MCOLP butterﬂy to all the frames
at <!--l. 667--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>
diﬀerent temporal subsamplings (or scales). At the iteration
<!--l. 668--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn> <mo 
class="MathClass-rel">≤</mo> <mi 
>t</mi> <mo 
class="MathClass-rel">≤</mo> <mi 
>T</mi></math> of MCOLP, the involved
frames are multiple of <!--l. 669--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>t</mi></mrow></msup 
></math>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 674--><div class="lstinputlisting">
<a 
 id="x1-19001r5"></a>
<a 
 id="x1-19002"></a>
<br /> <div class="caption" 
><span class="id">Listing 5: </span><span  
class="content">MCOLP (<a 
href="https://github.com/Sistemas-Multimedia/PRMC/blob/master/src/MCOLP.py" >MCOLP.py</a>).</span></div><!--tex4ht:label?: x1-19001r9 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19003r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">5,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19004r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCOLP</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19005r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19006r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">estimating</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">L</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subbands</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19007r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensaing</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subbands</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Orthogonal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Laplacian</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19008r6"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Pyramid</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">The</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">video</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19009r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">must</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">stored</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">directory</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19010r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19011r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">will</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">generated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">same</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">directory</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19012r10"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19013r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19014r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19015r13"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19016r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">str</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19017r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19018r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Localization</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Example</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19019r17"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;/</span><span 
class="ecit-1000">tmp</span><span 
class="ecit-1000">/&#x0022;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19020r18"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19021r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19022r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19023r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">process</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19024r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19025r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">T</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19026r24"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19027r25"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">iterations</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCOLP</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scales</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19028r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Controls</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">GOP</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">size</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19029r27"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19030r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">T</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">GOP_size</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19031r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">----+----------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19032r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">0</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19033r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19034r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">4</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19035r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">3</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">8</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19036r34"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">4</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">16</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19037r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">5</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">32</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19038r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19039r37"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19040r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Returns</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19041r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19042r40"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19043r41"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">The</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19044r42"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19045r43"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19046r44"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19047r45"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">t</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19048r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">print</span><span 
class="ecit-1000">(&#x0022;</span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">={}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(0),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">end</span><span 
class="ecit-1000">=’</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19049r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19050r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19051r49"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">while</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19052r50"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">print</span><span 
class="ecit-1000">(&#x0022;</span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">={}</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">={}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">//2,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19053r51"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19054r52"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19055r53"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19056r54"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">writeH</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19057r55"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19058r56"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">print</span><span 
class="ecit-1000">(&#x0022;</span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">={}&#x0022;.</span><span 
class="ecit-1000">format</span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">*</span><span 
class="ecit-1000">i</span><span 
class="ecit-1000">+</span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">end</span><span 
class="ecit-1000">=’</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19059r57"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19060r58"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">*=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19061r59"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000">print</span><span 
class="ecit-1000">(’\</span><span 
class="ecit-1000">n</span><span 
class="ecit-1000">’)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19062r60"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19063r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">5,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19064r62"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ecit-1000">Backward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCOLP</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19065r63"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19066r64"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">The</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19067r65"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">must</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">stored</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19068r66"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">directory</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19069r67"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">will</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">generated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">same</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">directory</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19070r68"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19071r69"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19072r70"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19073r71"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19074r72"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">str</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19075r73"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19076r74"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Localization</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Example</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19077r75"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;/</span><span 
class="ecit-1000">tmp</span><span 
class="ecit-1000">/&#x0022;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19078r76"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19079r77"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19080r78"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19081r79"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">process</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19082r80"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19083r81"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">T</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19084r82"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19085r83"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">iterations</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCOLP</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scales</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19086r84"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19087r85"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Returns</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19088r86"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19089r87"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19090r88"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">The</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19091r89"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19092r90"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">’’’</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19093r91"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2**</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19094r92"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">t</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19095r93"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19096r94"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19097r95"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">while</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19098r96"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19099r97"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19100r98"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19101r99"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">writeH</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19102r100"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19103r101"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-19104r102"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">//=2</span>
</div>
<a 
 id="x1-19105r6"></a>
<a 
 id="x1-19106"></a>
<br />                                                                  <div class="caption" 
><span class="id">
Figure 6: : </span><span  
class="content">Implementation of the MCOLP.                             </span></div><!--tex4ht:label?: x1-19105r9 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 679--><p class="indent" >   Notice that, if the parameter <!--l. 679--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>G</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>
(where <!--l. 679--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi></math> is
the GOP size, see Eq. <a 
href="#x1-17001r1">1<!--tex4ht:ref: eq:GOP_size --></a>), except for the ﬁrst and the last frame of the sequence, all the
<!--l. 681--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>-subbands
are compensated.
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.3   </span> <a 
 id="x1-200009.3"></a>Example: <!--l. 685--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></h4>
<!--l. 688--><p class="noindent" >In this example (see Fig. <a 
href="#x1-20001r7">7<!--tex4ht:ref: fig:1xPRMC1 --></a>), a sequence of ﬁve frames is transformed ﬁrst with
<!--l. 689--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>M</mi><mi 
>D</mi><mi 
>W</mi><mi 
>T</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>, producing 2 SRLs
by frame. Next, the <!--l. 690--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands of the odd frames (frames 1 and 3) are motion compensated using
<!--l. 691--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>M</mi><mi 
>C</mi><mi 
>O</mi><mi 
>L</mi><mi 
>P</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>.
                                                                  

                                                                  
</p>
   <pre class="verbatim" id="verbatim-10">
predictor=1
iterations=1
# You must be in the ’src’ directory to run this.
rm -f /tmp/*.png
cp ../sequences/stockholm/*.png /tmp
# 1-iteration MDWT.
python3 -O MDWT.py -p /tmp/
# Show the length of the subbands.
for i in /tmp/LL???.png; do ls -l $i; done
for i in /tmp/LH???.png; do ls -l $i; done
for i in /tmp/HL???.png; do ls -l $i; done
for i in /tmp/HH???.png; do ls -l $i; done
# 1-iteration MCOLP.
python3 -O MCOLP.py -P $predictor -p /tmp/ -T $iterations
# Show the length of the subbands.
for i in /tmp/LL???.png; do ls -l $i; done
for i in /tmp/LH???.png; do ls -l $i; done
for i in /tmp/HL???.png; do ls -l $i; done
for i in /tmp/HH???.png; do ls -l $i; done
# Has changed in length any of them? Remember that a change in lenght
# implies a change in content.
# Lets recover the original sequence ...
rm /tmp/???.png
# 1-iteration iMCOLP.
python3 -O MCOLP.py -P $predictor -b -p /tmp/ -T $iterations
# 1-iteration iMDWT.
python3 -O MDWT.py -b -p /tmp/
# Visualization of the reconstruction.
for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done
animate /tmp/???.png.png
                                                                  

                                                                  
# Visualization of the residue.
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done
animate /tmp/diff*.png
</pre>
<!--l. 738--><p class="nopar" >
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 742--><p class="noindent" ><div style="text-align:center;"> <img width=1000 src="graphics/temporal_decorrelation_1x1.svg" /> </div>  <a 
 id="x1-20001r7"></a>
<a 
 id="x1-20002"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 7:          :          </span><span  
class="content">Subbands          generated          after          running
<!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>:
(1) subband <!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>,
that provides spatial resolution level <!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math>
of the sequence, (2) subband <!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which provides spatial resolution level <!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
for        the        even        frames        (temporal        resolution        level
<!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math>
at         full         spatial         resolution),         and         (3)         subband
<!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>F</mi></mrow><mo accent="true">̃</mo></mover></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
that provides spatial resolution level <!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
for        the        odd        frames        (temporal        resolution        level
<!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
at           full           spatial           resolution,           considering           that
<!--l. 751--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
has been already decoded).                                           </span></div><!--tex4ht:label?: x1-20001r9 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">9.4   </span> <a 
 id="x1-210009.4"></a>Example: <!--l. 757--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></h4>
<!--l. 760--><p class="noindent" >This example is similar to the previous, but now the number of iterations of MCOLP
is <!--l. 761--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn></math>,
and therefore, the second iteration of MCOLP compensates also the
<!--l. 762--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subband of
the frame 2. This example matches exactly with the described in the Fig. <a 
href="#x1-21001r8">8<!--tex4ht:ref: fig:1xPRMC2 --></a>. Notice that the
GOP size is <!--l. 764--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>4</mn></math>
(<!--l. 764--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math> TRLs) and the
number of SRLs is <!--l. 765--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>.
                                                                  

                                                                  
</p>
   <pre class="verbatim" id="verbatim-11">
predictor=1
# You must be in the ’src’ directory.
rm /tmp/*.png
cp ../sequences/stockholm/*.png /tmp
# 1D 1-iteration MDWT.
python3 -O MDWT.py -p /tmp/
# Save a copy of the MDWT subbands (for comparing later).
rm -rf /tmp/tmp
mkdir /tmp/tmp
cp /tmp/*.png /tmp/tmp
# 1-iteration MCOLP.
python3 -O MCOLP.py -p /tmp/ -T 1
# Is the content of the MCOLP subbands different to the MDWT’s output?
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/LL$ii.png /tmp/tmp/LL$ii.png;echo; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/LH$ii.png /tmp/tmp/LH$ii.png;echo; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/HL$ii.png /tmp/tmp/HL$ii.png;echo; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/HH$ii.png /tmp/tmp/HH$ii.png;echo; done
rm /tmp/*.png
cp ../sequences/stockholm/*.png /tmp
# 1D 1-iteration MDWT.
python3 -O MDWT.py -p /tmp/
# Save a copy of the MDWT subbands (for comparing later).
rm -rf /tmp/tmp
mkdir /tmp/tmp
cp /tmp/*.png /tmp/tmp
# 2-iterations MCOLP.
python3 -O MCOLP.py -p /tmp/ -T 2
# Is the content of the MCOLP subbands different to the MDWT’s output?
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/LL$ii.png /tmp/tmp/LL$ii.png;echo; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/LH$ii.png /tmp/tmp/LH$ii.png;echo; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/HL$ii.png /tmp/tmp/HL$ii.png;echo; done
                                                                  

                                                                  
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); ls -l /tmp/HH$ii.png /tmp/tmp/HH$ii.png;echo; done
# Comparing LH visually.
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); convert -normalize /tmp/tmp/LH$ii.png /tmp/tmp/MDWT_LH$ii.png; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); convert -normalize /tmp/LH$ii.png /tmp/MCOLP_LH$ii.png; done
animate /tmp/tmp/MDWT_LH00?.png &#x0026;
animate /tmp/MCOLP_LH00?.png &#x0026;
# Comparing LH002 numerically.
echo MDWT &#x003E; /tmp/1
printf &#x0022;%61s\n&#x0022; MCOLP &#x003E; /tmp/2
python3 ../tools/show_statistics.py -i /tmp/tmp/LH002.png &#x003E;&#x003E; /tmp/1
python3 ../tools/show_statistics.py -i /tmp/LH002.png &#x003E;&#x003E; /tmp/2
paste /tmp/1 /tmp/2
# Comparing HL visually.
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); convert -normalize /tmp/tmp/HL$ii.png /tmp/tmp/MDWT_HL$ii.png; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); convert -normalize /tmp/HL$ii.png /tmp/MCOLP_HL$ii.png; done
animate /tmp/tmp/MDWT_HL00?.png &#x0026;
animate /tmp/MCOLP_HL00?.png &#x0026;
# Comparing HL002 numerically.
echo MDWT &#x003E; /tmp/1
printf &#x0022;%61s\n&#x0022; MCOLP &#x003E; /tmp/2
python3 ../tools/show_statistics.py -i /tmp/tmp/HL002.png &#x003E;&#x003E; /tmp/1
python3 ../tools/show_statistics.py -i /tmp/HL002.png &#x003E;&#x003E; /tmp/2
paste /tmp/1 /tmp/2
# Comparing HH visually.
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); convert -normalize /tmp/tmp/HH$ii.png /tmp/tmp/MDWT_HH$ii.png; done
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); convert -normalize /tmp/HH$ii.png /tmp/MCOLP_HH$ii.png; done
animate /tmp/tmp/MDWT_HH00?.png &#x0026;
animate /tmp/MCOLP_HH00?.png &#x0026;
# Comparing HH002 numerically.
echo MDWT &#x003E; /tmp/1
printf &#x0022;%61s\n&#x0022; MCOLP &#x003E; /tmp/2
python3 ../tools/show_statistics.py -i /tmp/tmp/HH002.png &#x003E;&#x003E; /tmp/1
python3 ../tools/show_statistics.py -i /tmp/HH002.png &#x003E;&#x003E; /tmp/2
paste /tmp/1 /tmp/2
# Now we recover the original video.
# 2-iterations iMCOLP.
python3 -O MCOLP.py -P $predictor -b -p /tmp/ -T $iterations
                                                                  

                                                                  
# 1-iteration iMDWT
python3 -O MDWT.py -b -p /tmp/
# Visualization of the reconstruction.
for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done
animate /tmp/???.png.png
# Visualization of the residue.
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done
animate /tmp/diff*.png
python3 ../tools/show_statistics.py -i /tmp/diff_002.png
</pre>
<!--l. 867--><p class="nopar" >
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 871--><p class="noindent" ><div style="text-align:center;"> <img width=1000 src="graphics/temporal_decorrelation_1x2.svg" /> </div>  <a 
 id="x1-21001r8"></a>
<a 
 id="x1-21002"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 8:          :          </span><span  
class="content">Subbands          generated          after          running
<!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math>:
(1) subband <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>,
that provides spatial resolution level <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math>
of the sequence, (2) <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which provides spatial resolution level <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
for frames with number <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi></math>
(temporal resolution level <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>
at full spatial resolution), (3) subband <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>F</mi></mrow><mo accent="true">̃</mo></mover></mrow><mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
that provides spatial resolution level <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
for the frames with number <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>2</mn></math>
(that considering also <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
provides temporal resolution level <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math>
at      full      spatial      resolution),      and      ﬁnally      (4)      subband
<!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>F</mi></mrow><mo accent="true">̃</mo></mover></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which provides spatial resolution level <!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
for           odd           images           (temporal           resolution           level
<!--l. 884--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
at full spatial resolution, considering the previouly decoded temporal resolution
levels).                                                            </span></div><!--tex4ht:label?: x1-21001r9 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">9.5   </span> <a 
 id="x1-220009.5"></a>Simpliﬁcation of the notation</h4>
<!--l. 893--><p class="noindent" >For the sake of simplifying the notation, we will represent
<!--l. 894--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>s</mi></mrow></msup 
></math> by
<!--l. 894--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>s</mi></mrow></msubsup 
></math>, and
<!--l. 894--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>F</mi></mrow><mrow 
><mi 
>t</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>s</mi></mrow></msup 
></math> by
<!--l. 894--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msubsup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>t</mi></mrow><mrow 
><mi 
>s</mi></mrow></msubsup 
></math>.
Thus, for example, the subbands shown in the Fig. <a 
href="#x1-21001r8">8<!--tex4ht:ref: fig:1xPRMC2 --></a> can be represented as: (1)
<!--l. 896--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
(that is a version of the sequence with spatial resolution
<!--l. 897--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>X</mi><mo 
class="MathClass-bin">∕</mo><mn>2</mn> <mo 
class="MathClass-bin">×</mo> <mi 
>Y</mi><mo 
class="MathClass-bin">∕</mo><mn>2</mn></math>), (2)
<!--l. 897--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi></mrow></msub 
></math> (made
up of intra-coded high-frequency spatial information of the frames with numbers
<!--l. 899--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi></math>), (3)
<!--l. 899--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo accent="true">̃</mo></mover></mrow><mrow 
><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></math> (with the
high-frequency spatio-temporal prediction error resulting from decorrelating even frames with
distance <!--l. 901--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>),
and (4) <!--l. 901--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo accent="true">̃</mo></mover></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></math>
(high-frequency spatio-temporal prediction error resulting from decorrelating frames with
distance <!--l. 903--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>).
</p><!--l. 907--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.6   </span> <a 
 id="x1-230009.6"></a>Example: <!--l. 907--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>4</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>7</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></h4>
<!--l. 910--><p class="noindent" >An example with <!--l. 910--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mn>4</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn><mn>6</mn></math>,
i.e. <!--l. 910--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>5</mn></math> TRLs
and <!--l. 910--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>2</mn></math>
SRLs. The subbands generated are:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-23002x1"><!--l. 913--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>,
     that by itself, allows to reconstruct all the frames at half resolution.
     </li>
     <li 
  class="enumerate" id="x1-23004x2"><!--l. 915--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>1</mn><mn>6</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>8</mn></mrow></msub 
></math>,
     which with <!--l. 915--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>,
     provides full resolution for frames with number <!--l. 916--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn><mn>6</mn><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>8</mn></math>
     (the rest of frames have half resolution).
     </li>
     <li 
  class="enumerate" id="x1-23006x3"><!--l. 917--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>8</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>4</mn></mrow></msub 
></math>,
     that with the previous subbands provides full resolution also for frames
     with number <!--l. 918--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>8</mn><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>4</mn></math>.
                                                                  

                                                                  
     </li>
     <li 
  class="enumerate" id="x1-23008x4"><!--l. 919--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>4</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>2</mn></mrow></msub 
></math>,
     which also provides full resolution for frames <!--l. 919--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>4</mn><mi 
>i</mi> <mo 
class="MathClass-bin">+</mo> <mn>2</mn></math>.
     </li>
     <li 
  class="enumerate" id="x1-23010x5"><!--l. 920--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn><mi 
>i</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msub 
></math>,
     that reconstruct the original sequence.</li></ol>
<!--l. 923--><p class="indent" >   The temporal decorrelation pattern followed by
<!--l. 923--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>i</mi><mi 
>M</mi><mi 
>C</mi><mi 
>O</mi><mi 
>L</mi><mi 
>P</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>4</mi><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>1</mi><mi 
>7</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mstyle></math> is
(notice that the hexadecimal notation has been followed for indexing the frames)
shown in the Fig. <a 
href="#x1-23011r9">9<!--tex4ht:ref: fig:PRMC_4_17 --></a>.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<pre class="verbatim" id="verbatim-12">
GOP0                     GOP1
---- ------------------------------------------------
  F0                      F8                      F10 -&#x003E; H_{8i }  (= TRL3)
              F4                      Fc              -&#x003E; H_{8i+4} (+ TRL3 = TRL2)
        F2          F6          Fa          Fe        -&#x003E; H_{4i+2} (+ TRL2 = TRL1)
     F1    F3    F5    F7    F9    Fb    Fd    Ff     -&#x003E; H_{2i+1} (+ TRL1 = TRL0)
</pre>
<!--l. 935--><p class="nopar" > <a 
 id="x1-23011r9"></a>
<a 
 id="x1-23012"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 9:       :       </span><span  
class="content">Motion       compensation       pattern       followed       by
<!--l. 939--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>M</mi><mi 
>C</mi><mi 
>O</mi><mi 
>L</mi><mi 
>P</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>4</mi><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>1</mi><mi 
>7</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mstyle></math>.
The temporal resolution levels (TRLs) are considering only the frames that has
been reconstructed at the original spatial resolution.
</span></div><!--tex4ht:label?: x1-23011r9 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-13">
# You must be in the ’src’ directory.
rm /tmp/*.png
video_file=/tmp/akiyo_cif.y4m
if test -f $video_file; then
  print akiyo exists
else
  wget https://media.xiph.org/video/derf/y4m/akiyo_cif.y4m -O /tmp/akiyo_cif.y4m
fi
mplayer /tmp/akiyo_cif.y4m
ffmpeg -i /tmp/akiyo_cif.y4m -vframes 17 -start_number 0 /tmp/%03d.png
# 1D 1-iteration MDWT.
python3 -O MDWT.py -p /tmp/ -N 17
# Save a copy of the MDWT subbands (for comparing later).
rm -rf /tmp/tmp
mkdir /tmp/tmp
cp /tmp/LL*.png /tmp/tmp
cp /tmp/LH*.png /tmp/tmp
cp /tmp/HL*.png /tmp/tmp
cp /tmp/HH*.png /tmp/tmp
# 4-iterations MCOLP.
python3 -O MCOLP.py -p /tmp/ -T 4 -N 17
ls -l /tmp/LH*.png &#x003E; /tmp/1
ls -l /tmp/tmp/LH*.png &#x003E; /tmp/2
paste /tmp/1 /tmp/2
ls -l /tmp/HL*.png &#x003E; /tmp/1
ls -l /tmp/tmp/HL*.png &#x003E; /tmp/2
paste /tmp/1 /tmp/2
ls -l /tmp/HH*.png &#x003E; /tmp/1
ls -l /tmp/tmp/HH*.png &#x003E; /tmp/2
paste /tmp/1 /tmp/2
# Now we recover the original video.
# 4-iterations iMCOLP.
python3 -O MCOLP.py -b -p /tmp/ -T 4 -N 17
                                                                  

                                                                  
# 1-iteration iMDWT
python3 -O MDWT.py -b -p /tmp/ -N 17
# Visualization of the reconstruction.
for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done
animate /tmp/???.png.png
# Visualization of the residue.
for i in {0..16}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done
animate /tmp/diff*.png
python3 ../tools/show_statistics.py -i /tmp/diff_002.png
</pre>
<!--l. 998--><p class="nopar" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.7   </span> <a 
 id="x1-240009.7"></a>Scalability provided by MCOLP</h4>
<!--l. 1005--><p class="noindent" >MCOLP preserves the dyadic spatial decomposition generated by MDWT, and
therefore, MCOLP provides the same spatial scalability than MDWT.
</p><!--l. 1008--><p class="indent" >   Unfortunately, as the rest of video encoders based on MC, MCOLP reduces the
temporal scalability provided by MDWT, allowing (in the case of MCOLP) only a
dyadic access to the frames.
</p><!--l. 1014--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.8   </span> <a 
 id="x1-250009.8"></a>Example: 3-iters of <!--l. 1014--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>2</mn><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mn>5</mn></mrow><mo 
class="MathClass-close">)</mo></mrow></math></h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-14">
predictor=1
iterations=2
# You must be in the ’src’ directory.
rm /tmp/*.png
cp ../sequences/stockholm/* /tmp
python3 -O MDWT.py  -p /tmp/
python3 -O MCOLP.py -p /tmp/     -P $predictor -T $iterations
python3 -O MDWT.py  -p /tmp/LL
python3 -O MCOLP.py -p /tmp/LL   -P $predictor -T $iterations
python3 -O MDWT.py  -p /tmp/LLLL
python3 -O MCOLP.py -p /tmp/LLLL -P $predictor -T $iterations
rm /tmp/00?.png
python3 -O MCOLP.py -p /tmp/LLLL -P $predictor -b -T $iterations
python3 -O MDWT.py  -p /tmp/LLLL               -b
python3 -O MCOLP.py -p /tmp/LL   -P $predictor -b -T $iterations
python3 -O MDWT.py  -p /tmp/LL                 -b
python3 -O MCOLP.py -p /tmp/     -P $predictor -b -T $iterations
python3 -O MDWT.py  -p /tmp/                   -b
for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done
animate /tmp/diff*.png
</pre>
<!--l. 1045--><p class="nopar" >
</p><!--l. 1047--><p class="indent" >   In this case, <!--l. 1047--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>G</mi> <mo 
class="MathClass-rel">=</mo> <mn>4</mn></math>,
generating <!--l. 1047--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math> TRLs
(see Fig. <a 
href="#x1-25001r10">10<!--tex4ht:ref: fig:PRMC_2_5_T --></a>), and <!--l. 1048--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>4</mn></math>
is the number of SRLs (see Fig. <a 
href="#x1-25003r11">11<!--tex4ht:ref: fig:PRMC_2_5_S --></a>).
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<pre class="verbatim" id="verbatim-15">
TRLs:
GOP0     GOP1
---- ------------
  F0           F4  -&#x003E; H_{4i} (= TRL2)
         F2        -&#x003E; H_{4i+2} (+ TRL2 = TRL1)
      F1    F3     -&#x003E; H_{2i+1} (+ TRL1 = TRL0)
</pre>
<!--l. 1061--><p class="nopar" > <a 
 id="x1-25001r10"></a>
<a 
 id="x1-25002"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 10:      :      </span><span  
class="content">Motion      compensation      pattern      followed      by
<!--l. 1064--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>M</mi><mi 
>C</mi><mi 
>O</mi><mi 
>L</mi><mi 
>P</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>2</mi><mo 
class="MathClass-punc">,</mo><mi 
>N</mi> <mo 
class="MathClass-rel">=</mo> <mi 
>5</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mstyle></math>.
The TRLs consider only the frames that has been reconstructed at the original
spatial resolution.
</span></div><!--tex4ht:label?: x1-25001r9 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<pre class="verbatim" id="verbatim-16">
+---+---+-------+---------------+
| 3 | 2 |   1   |       0       |
+---+   |       |               |
|       |       |               |
+-------+       |               |
|               |               |
|               |               |
|               |               |
+---------------+               |
|                               |
|                               |
|                               |
|                               |
|                               |
|                               |
|                               |
|                               |
|                               |
|                               |
+-------------------------------+
</pre>
<!--l. 1091--><p class="nopar" > <a 
 id="x1-25003r11"></a>
<a 
 id="x1-25004"></a>
<br />                                                                  </p><div class="caption" 
><span class="id">
Figure 11: : </span><span  
class="content">SRLs generated by <!--l. 1093--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>3</mn></math>
iterations of <!--l. 1093--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle mathvariant="monospace"><mi 
>P</mi><mi 
>R</mi><mi 
>M</mi><mi 
>C</mi></mstyle></math>.
<!--l. 1093--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
corresponds with the original resolution of the frames.
</span></div><!--tex4ht:label?: x1-25003r9 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-2600010"></a>Adaptive motion compensation based on the energy of the estimated
prediction error</h3>
<!--l. 1102--><p class="noindent" >As can be seen in the MCOLP buﬀerﬂy (see Fig. <a 
href="#x1-18073r5">5<!--tex4ht:ref: fig:forward_butterfly --></a>), both predictions
<!--l. 1103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> and
<!--l. 1104--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
weight the same in the prediction </p><table class="equation"><tr><td> <a 
 id="x1-26001r2"></a>
<!--l. 1105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo accent="true">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
         <mrow 
><mn>2</mn></mrow></mfrac>         <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(2)</td></tr></table>
<!--l. 1108--><p class="indent" >   This simple computation, that can have very eﬀective for example in
<a 
href="https://biteable.com/blog/tips/video-transitions-effects-examples/" >dissolves</a> video transitions, can also be counterproductive when objects appear
only in one of the reference frames. For this reason, in this section an
improved predictor is proposed, based on the estimated prediction error (see
<!--l. 1113--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo accent="true">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> in the
Fig. <a 
href="#x1-18073r5">5<!--tex4ht:ref: fig:forward_butterfly --></a>) generated throughout the ME/MC. To estimate this error, we will suppose
that the prediction error generated for the high frequencies of an frame is
correlated with the prediction error generated for the low frequencies of such
frame.
</p><!--l. 1119--><p class="indent" >   Let <!--l. 1119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> the prediction
generated for the subband <!--l. 1119--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
using <!--l. 1120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as reference
and <!--l. 1120--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">→</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as motion, and
let <!--l. 1121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> the prediction
generated for <!--l. 1121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
using <!--l. 1121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as
reference and <!--l. 1122--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">→</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
as motion. We now compute the prediction errors </p><table class="equation"><tr><td> <a 
 id="x1-26002r3"></a>
                                                                  

                                                                  
<!--l. 1124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow>  </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(3)</td></tr></table>
<!--l. 1131--><p class="indent" >   We deﬁne <span 
class="ecti-1000">similarity matrices </span>as </p><table class="equation"><tr><td> <a 
 id="x1-26003r4"></a>
<!--l. 1132--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" equalcolumns="false" class="array"> <mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo>      <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">|</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-rel">|</mo></mrow></mfrac> </mtd>
</mtr>  <mtr><mtd 
class="array"  columnalign="left"> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo>      <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">|</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-rel">|</mo></mrow></mfrac><mo 
class="MathClass-punc">.</mo> </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(4)</td></tr></table>
<!--l. 1139--><p class="indent" >   Notice that, if (for example) the error
<!--l. 1139--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>, the similarity
is <!--l. 1140--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math> (the
maximum similarity). On the other side, if the error is high, the similarity tends to be low
(but never <!--l. 1142--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>).
</p><!--l. 1144--><p class="indent" >   With this information, that can be recovered by the decoder, the improved
prediction is deﬁned as </p><table class="equation"><tr><td> <a 
 id="x1-26004r5"></a>
<!--l. 1146--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                  <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo accent="true">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
        <mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></mfrac>        <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(5)</td></tr></table>
<!--l. 1149--><p class="indent" >   The Fig. <a 
href="#x1-26019r12">12<!--tex4ht:ref: fig:weighted_average --></a> shows an implementation of this equation.
</p><!--l. 1152--><p class="indent" >   Notice that, if (for example) <!--l. 1152--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
and <!--l. 1153--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">≈</mo> <mn>0</mn></math>, then
<!--l. 1154--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo accent="true">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">≈</mo> <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></math>, and
viceversa. If <!--l. 1155--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></math>,
then <!--l. 1156--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo accent="true">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
><mo 
class="MathClass-bin">+</mo><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></mrow> 
           <mrow 
><mn>2</mn></mrow></mfrac>             </math>
(even if both similarities are small).
</p>
                                                                  

                                                                  
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
                                                                  

                                                                  
<!--l. 1160--><div class="lstinputlisting">
<a 
 id="x1-26005r6"></a>
<a 
 id="x1-26006"></a>
<br /> <div class="caption" 
><span class="id">Listing 6: </span><span  
class="content"><a 
href="https://github.com/Sistemas-Multimedia/MCOLP/blob/master/src/weighted_average.py" >weighted_average.py</a>.</span></div><!--tex4ht:label?: x1-26005r10 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26007r1"></a></span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26008r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26009r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26010r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26011r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26012r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26013r7"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26014r8"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">EAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAL</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26015r9"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">ECL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCL</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26016r10"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1/(1+</span><span 
class="ectt-1000">abs</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">EAL</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26017r11"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1/(1+</span><span 
class="ectt-1000">abs</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">ECL</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-26018r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000">)/(</span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000">)</span>
</div>
<a 
 id="x1-26019r12"></a>
<a 
 id="x1-26020"></a>
<br />                                                                  <div class="caption" 
><span class="id">
Figure 12: : </span><span  
class="content">Computation of the weighted average prediction.              </span></div><!--tex4ht:label?: x1-26019r10 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h3 class="sectionHead"><span class="titlemark">11   </span> <a 
 id="x1-2700011"></a>Lossy compression: quantization</h3>
<!--l. 1170--><p class="noindent" ><a 
href="https://vicente-gonzalez-ruiz.github.io/quantization/" >Quantization</a> allows to remove information from signals. We will use it in MCOLP
to achieve higher compression ratios, but at the expense of losing visual
information (ideally, the less relevant information for the <a 
href="https://vicente-gonzalez-ruiz.github.io/human_visual_system/" >HVS</a> should be removed
ﬁrst).
</p><!--l. 1176--><p class="indent" >   When the signal cannot be recoverd perfectly, we can use a <a 
href="https://vicente-gonzalez-ruiz.github.io/distortion_metrics/" >distortion metric</a> to
ﬁnd how much error has been generated.
</p><!--l. 1182--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.1   </span> <a 
 id="x1-2800011.1"></a>Example: Eﬀects caused by the total attenuation of the motion compensated
(MCed) <!--l. 1182--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands</h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-17">
predictor=2
# You must be in the ’src’ directory.
rm /tmp/*.png
cp ../sequences/stockholm/*.png /tmp
# 1D 1-iteration MDWT.
python3 -O MDWT.py -p /tmp/
# 1D 1-iteration MCOLP.
python3 -O MCOLP.py -p /tmp/
# Let’s delete the motion compensated subbands and reconstruct the sequence ...
rm -f /tmp/LH001.png
rm -f /tmp/HL001.png
rm -f /tmp/HH001.png
rm -f /tmp/LH002.png
rm -f /tmp/HL002.png
rm -f /tmp/HH002.png
rm -f /tmp/LH003.png
rm -f /tmp/HL003.png
rm -f /tmp/HH003.png
# 1D 1-iteration iMCOLP.
python3 -O MCOLP.py -P $predictor -b -p /tmp/
# 1D 1-iteration iMDWT.
python3 -O MDWT.py -b -p /tmp/
# Visualization of the reconstruction.
for i in /tmp/00?.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
# Visualization of the differences with the original sequence.
rm -f /tmp/diff*.png; for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done; animate /tmp/diff*.png
# MSE per frame
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); MSE=‘python3 -O ../tools/MSE.py -x ../sequences/stockholm/$ii.png -y /tmp/$ii.png‘; printf &#x0022;MSE(%s)=%s\n&#x0022; $ii $MSE; done
# PSNR per frame
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); PSNR=‘python3 -O ../tools/PSNR.py -x ../sequences/stockholm/$ii.png -y /tmp/$ii.png‘; printf &#x0022;PSNR(%s)=%s\n&#x0022; $ii $PSNR; done
</pre>
<!--l. 1227--><p class="nopar" >
                                                                  

                                                                  
</p><!--l. 1231--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.2   </span> <a 
 id="x1-2900011.2"></a>Example: Eﬀects caused by the quantization of MCed
<!--l. 1231--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands</h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-18">
q_step=32
predictor=2
# You must be in the ’src’ directory.
rm /tmp/*.png
cp ../sequences/stockholm/* /tmp
python3 -O MDWT.py -p /tmp/
python3 -O MCOLP.py -P $predictor -p /tmp/
#python3 ../tools/show_statistics.py -i /tmp/LH001.png
python3 ../tools/quantize.py -i /tmp/LH001.png -o /tmp/LH001.png -q $q_step
#python3 ../tools/show_statistics.py -i /tmp/LH001.png
python3 ../tools/quantize.py -i /tmp/HL001.png -o /tmp/HL001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH001.png -o /tmp/HH001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH002.png -o /tmp/LH002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL002.png -o /tmp/HL002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH002.png -o /tmp/HH002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH003.png -o /tmp/LH003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL003.png -o /tmp/HL003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH003.png -o /tmp/HH003.png -q $q_step
python3 -O MCOLP.py -P $predictor -p /tmp/ -b
python3 -O MDWT.py -p /tmp/ -b
for i in /tmp/00?.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
rm -f /tmp/diff*.png; for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done; animate /tmp/diff*.png
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); MSE=‘python3 -O ../tools/MSE.py -x ../sequences/stockholm/$ii.png -y /tmp/$ii.png‘; printf &#x0022;MSE(%s)=%s\n&#x0022; $ii $MSE; done
</pre>
<!--l. 1267--><p class="nopar" >
</p><!--l. 1271--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.3   </span> <a 
 id="x1-3000011.3"></a>Example: Quantization of all
<!--l. 1271--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands (MCed and intra)</h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-19">
q_step=32
predictor=2
# You must be in the ’src’ directory.
rm /tmp/*.png
cp ../sequences/stockholm/* /tmp
python3 -O MDWT.py -p /tmp/
python3 -O MCOLP.py -P $predictor -p /tmp/
python3 ../tools/quantize.py -i /tmp/LH000.png -o /tmp/LH000.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL000.png -o /tmp/HL000.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH000.png -o /tmp/HH000.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH001.png -o /tmp/LH001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL001.png -o /tmp/HL001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH001.png -o /tmp/HH001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH002.png -o /tmp/LH002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL002.png -o /tmp/HL002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH002.png -o /tmp/HH002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH003.png -o /tmp/LH003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL003.png -o /tmp/HL003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH003.png -o /tmp/HH003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH004.png -o /tmp/LH004.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL004.png -o /tmp/HL004.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH004.png -o /tmp/HH004.png -q $q_step
python3 -O MCOLP.py -P $predictor -p /tmp/ -b
python3 -O MDWT.py -p /tmp/ -b
for i in /tmp/00?.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
rm -f /tmp/diff*.png; for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done; animate /tmp/diff*.png
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); MSE=‘python3 -O ../tools/MSE.py -x ../sequences/stockholm/$ii.png -y /tmp/$ii.png‘; printf &#x0022;MSE(%s)=%s\n&#x0022; $ii $MSE; done
</pre>
<!--l. 1313--><p class="nopar" >
</p><!--l. 1317--><p class="noindent" >
                                                                  

                                                                  
</p>
   <h4 class="subsectionHead"><span class="titlemark">11.4   </span> <a 
 id="x1-3100011.4"></a>Example: Quantization of all subbands</h4>
                                                                  

                                                                  
   <pre class="verbatim" id="verbatim-20">
q_step=128
predictor=2
# You must be in the ’src’ directory.
rm /tmp/*.png
cp ../sequences/stockholm/* /tmp
python3 -O MDWT.py -p /tmp/
python3 -O MCOLP.py -P $predictor -p /tmp/
python3 ../tools/quantize.py -i /tmp/LL000.png -o /tmp/LL000.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH000.png -o /tmp/LH000.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL000.png -o /tmp/HL000.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH000.png -o /tmp/HH000.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LL001.png -o /tmp/LL001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH001.png -o /tmp/LH001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL001.png -o /tmp/HL001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH001.png -o /tmp/HH001.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LL002.png -o /tmp/LL002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH002.png -o /tmp/LH002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL002.png -o /tmp/HL002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH002.png -o /tmp/HH002.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LL003.png -o /tmp/LL003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH003.png -o /tmp/LH003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL003.png -o /tmp/HL003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH003.png -o /tmp/HH003.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LL004.png -o /tmp/LL004.png -q $q_step
python3 ../tools/quantize.py -i /tmp/LH004.png -o /tmp/LH004.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HL004.png -o /tmp/HL004.png -q $q_step
python3 ../tools/quantize.py -i /tmp/HH004.png -o /tmp/HH004.png -q $q_step
python3 -O MCOLP.py -P $predictor -p /tmp/ -b
python3 -O MDWT.py -p /tmp/ -b
for i in /tmp/00?.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
rm -f /tmp/diff*.png; for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done; animate /tmp/diff*.png
                                                                  

                                                                  
for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); MSE=‘python3 -O ../tools/MSE.py -x ../sequences/stockholm/$ii.png -y /tmp/$ii.png‘; printf &#x0022;MSE(%s)=%s\n&#x0022; $ii $MSE; done
</pre>
<!--l. 1364--><p class="nopar" >
</p>
    
</body> 
</html>
                                                                  


