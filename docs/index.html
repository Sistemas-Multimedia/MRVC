<!DOCTYPE html> 
<html> 
<head> <title>Motion Compensated Discrete Wavelet Transform (MCDWT)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Motion Compensated Discrete Wavelet
Transform (MCDWT)</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">January 9, 2020</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Intro</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">The 2D DWT (Distrete Wavelet Transform)</a></span>
<br />    <span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-4">Implementation of the 3 components (color) DWT step</a></span>
<br />    <span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-8">Multi-level DWT structures</a></span>
<br />    <span class="subsectionToc" >2.3 <a 
href="#x1-60002.3" id="QQ2-1-9">Scalability provided by the 2D DWT</a></span>
<br />    <span class="subsectionToc" >2.4 <a 
href="#x1-70002.4" id="QQ2-1-10">A 1-iteration 2D DWT example</a></span>
<br />    <span class="subsectionToc" >2.5 <a 
href="#x1-80002.5" id="QQ2-1-11">A 2-iterations 2D DWT example</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-90003" id="QQ2-1-12">Motion DWT (MDWT)</a></span>
<br />    <span class="subsectionToc" >3.1 <a 
href="#x1-100003.1" id="QQ2-1-16">Scalability provided by MDWT</a></span>
<br />    <span class="subsectionToc" >3.2 <a 
href="#x1-110003.2" id="QQ2-1-17">1-iteration MDWT example</a></span>
<br />    <span class="subsectionToc" >3.3 <a 
href="#x1-120003.3" id="QQ2-1-18">2-iterations MDWT example</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-130004" id="QQ2-1-19">Video transform alternatives</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-140005" id="QQ2-1-20">Motion Compensated Discrete Wavelet Transform (MCDWT)</a></span>
<br />    <span class="subsectionToc" >5.1 <a 
href="#x1-150005.1" id="QQ2-1-21">The MCDWT butterﬂy</a></span>
<br />    <span class="subsectionToc" >5.2 <a 
href="#x1-160005.2" id="QQ2-1-25">The MCDWT step</a></span>
<br />    <span class="subsectionToc" >5.3 <a 
href="#x1-170005.3" id="QQ2-1-27">The forward MCDWT</a></span>
<br />    <span class="subsectionToc" >5.4 <a 
href="#x1-180005.4" id="QQ2-1-31">(Spatial) Multiresolution</a></span>
<br />    <span class="subsectionToc" >5.5 <a 
href="#x1-190005.5" id="QQ2-1-33">Scalability provided by MCDWT</a></span>
<br />    <span class="subsectionToc" >5.6 <a 
href="#x1-200005.6" id="QQ2-1-34">MCDWT 1-levels example</a></span>
<br />    <span class="subsectionToc" >5.7 <a 
href="#x1-210005.7" id="QQ2-1-35">Showing some statistics</a></span>
<br />    <span class="subsectionToc" >5.8 <a 
href="#x1-220005.8" id="QQ2-1-36">Filtering the MC subbands</a></span>
<br />    <span class="subsectionToc" >5.9 <a 
href="#x1-230005.9" id="QQ2-1-37">2D-MDWT-MCDWT 2-levels example</a></span>
<br />   <span class="sectionToc" >6 <a 
href="#x1-240006" id="QQ2-1-38">Adaptive motion compensation based on the distortion of the prediction error</a></span>
                                                                  

                                                                  
<br />   <span class="sectionToc" >7 <a 
href="#x1-250007" id="QQ2-1-40">Orthogonal, orthonormal, and biorthogonal transforms</a></span>
<br />   <span class="sectionToc" >8 <a 
href="#x1-260008" id="QQ2-1-41">Quantization eﬀects</a></span>
<br />    <span class="subsectionToc" >8.1                                  <a 
href="#x1-270008.1" id="QQ2-1-42">Quantization                                  of
(<!--l. 43--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>) MC subbands</a></span>
<br />    <span class="subsectionToc" >8.2                      <a 
href="#x1-280008.2" id="QQ2-1-43">Quantization                      of                      all
<!--l. 44--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands</a></span>
<br />    <span class="subsectionToc" >8.3                      <a 
href="#x1-290008.3" id="QQ2-1-44">Quantization                      of                      all
<!--l. 45--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands</a></span>
<br />   <span class="sectionToc" >9 <a 
href="#x1-300009" id="QQ2-1-45">Lossy compression eﬀects</a></span>
<br />    <span class="subsectionToc" >9.1                                  <a 
href="#x1-310009.1" id="QQ2-1-46">Compression                                  of
(<!--l. 47--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>) MC subbands</a></span>
<br />    <span class="subsectionToc" >9.2                      <a 
href="#x1-320009.2" id="QQ2-1-47">Quantization                      of                      all
<!--l. 48--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands</a></span>
<br />    <span class="subsectionToc" >9.3                      <a 
href="#x1-330009.3" id="QQ2-1-48">Quantization                      of                      all
<!--l. 49--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands</a></span>
<br />   <span class="sectionToc" >10 <a 
href="#x1-3400010" id="QQ2-1-49">MCDWT decomposition</a></span>
<br />   <span class="sectionToc" >11 <a 
href="#x1-3500011" id="QQ2-1-51">Encoding of B-type H-subbands (experimental)</a></span>
<br />   <span class="sectionToc" >12 <a 
href="#x1-3600012" id="QQ2-1-52">Encoding of I-type H-subbands</a></span>
<br />   <span class="sectionToc" ><a 
href="#Q1-1-53">References</a></span>
   </div>
<!--l. 8--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Intro</h3>
<!--l. 11--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Video" >Video</a> data contain high amounts of <a 
href="https://vicente-gonzalez-ruiz.github.io/redundancy/" >redundancy</a>, spatial and temporal.
For this reason, most of <a 
href="https://vicente-gonzalez-ruiz.github.io/video_compression/" >video encoders</a> compress an input sequence of
<a 
href="https://en.wikipedia.org/wiki/Digital_image" >images</a><span class="footnote-mark"><a 
href="index2.html#fn1x0"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-2001f1"></a> ,
basically, in two stages: (1) a transform stage in the <a 
href="https://en.wikipedia.org/wiki/Time_domain" >time</a> and in the <a 
href="https://www.quora.com/What-is-spatial-domain-in-image-processing" >spatial</a> domains
that produces a collection of <a 
href="https://en.wikipedia.org/wiki/Decorrelation" >uncorrelated</a> <a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >coeﬃcients</a>, and (2) an <a 
href="https://en.wikipedia.org/wiki/Entropy_encoding" >entropy
encoding</a> phase which removes the statistical redundancy that can still remains
after the decorrelation (transform). These coeﬃcients have two interesting
features:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-2003x1">Usually,  a   <a 
href="https://vicente-gonzalez-ruiz.github.io/symbol_compression/" ><span 
class="ecbx-1000">smaller  entropy</span></a> than  the  original  pixels.  This  helps  to
     increase the <a 
href="https://en.wikipedia.org/wiki/Data_compression_ratio" >compression ratio</a>.
     </li>
     <li 
  class="enumerate" id="x1-2005x2">A <a 
href="https://en.wikipedia.org/wiki/Image_resolution" ><span 
class="ecbx-1000">multiresolution representation</span></a> <span 
class="ecbx-1000">(in space and time) </span>of the visual
     information.  This  provides  the  posibility  of  decoding  the  sequence  of
     images using a smaller resolution (in space and time). This feature is
     known as <a 
href="https://vicente-gonzalez-ruiz.github.io/video_compression/" >spatial/temporal scalability in video</a>.
                                                                  

                                                                  
     </li>
     <li 
  class="enumerate" id="x1-2007x3">Usually,  <span 
class="ecbx-1000">most  of  the  </span><a 
href="https://en.wikipedia.org/wiki/Energy_(signal_processing)" ><span 
class="ecbx-1000">energy</span></a> (and  therefore,  generally,  most  of  the
     information  interesting  for  the  humans)  <span 
class="ecbx-1000">is  represented  by  </span><a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding" ><span 
class="ecbx-1000">a  small</span>
     <span 
class="ecbx-1000">number of coeﬃcients</span></a>. This helps to improve the compression ratio
     and to prioritize the data in <a 
href="https://vicente-gonzalez-ruiz.github.io/media_encoding_models/" >progressive transmission scenarios</a>.</li></ol>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>The 2D DWT (Distrete Wavelet Transform)</h3>
<!--l. 54--><p class="noindent" ><a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/#x1-3100020" >The  2D  DWT  (Distrete  Wavelet
Transform)<span class="footnote-mark"><a 
href="index3.html#fn2x0"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-3001f2"></a> </a>
is a digital transform that, applied to an image, performs a spatial decorrelation and
obtains a <a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/index.html#x1-3500024" >multiresolution (generally dyadic) representation</a> of such image, conforming
a collection of DWT subbands. The forward transform converts the image into a
set of frequency subbands with coeﬃcients representing diﬀerent spatial
areas and frequency orientations. There is an equivalence between DWT
subbands and <a 
href="http://fourier.eng.hmc.edu/e161/lectures/canny/node3.html" >Laplacian Pyramids</a>, and it is quite simple to <a 
href="https://vicente-gonzalez-ruiz.github.io/pyramids-and-wavelets/" >pass from a
decomposition<span class="footnote-mark"><a 
href="index4.html#fn3x0"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-3002f3"></a> 
representation to a pyramid representation and viceversa</a>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Implementation of the 3 components (color) DWT step</h4>
<!--l. 71--><p class="noindent" ><a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/DWT.py" >DWT.py</a> (see Fig. <a 
href="#x1-40901">1<!--tex4ht:ref: fig:DWT --></a>) implements the forward and backward 1-iteration (step) 2D
DWT for color images.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-4001r1"></a><a 
 id="x1-4066r2"></a><a 
 id="x1-40901"></a>
                                                                  

                                                                  
<!--l. 77--><div class="lstinputlisting">
<a 
 id="x1-4002"></a>
<br /> <div class="caption" 
><span class="id">Listing 1: </span><span  
class="content">Forward 1-iteration DWT (<a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/DWT.py" >DWT.py</a>)</span></div><!--tex4ht:label?: x1-4001r2 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4003r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4004r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4005r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4006r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4007r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4008r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4009r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">]</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">usually</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">YUV</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4010r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4011r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4012r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4013r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4014r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4015r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">V</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4016r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4017r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4018r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4019r17"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4020r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4021r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4022r20"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4023r21"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4024r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4025r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4026r24"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4027r25"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4028r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">L</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">L</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">low</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencie</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4029r27"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subband</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4030r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subbands</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">are</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4031r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4032r30"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4033r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4034r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4035r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4036r34"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4037r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4038r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4039r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4040r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4041r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4042r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4043r41"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4044r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4045r43"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4046r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">This</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">structure</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">provides</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">spatial</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">resolution</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4047r45"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4048r46"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4049r47"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4050r48"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4051r49"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">y</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4052r50"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4053r51"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4054r52"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4055r53"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4056r54"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4057r55"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4058r56"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4059r57"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(3):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4060r58"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt2</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">bior3</span><span 
class="ectt-1000">.5</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4061r59"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4062r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4063r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4064r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4065r63"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)))</span>
</div>
<!--l. 80--><div class="lstinputlisting">
<a 
 id="x1-4067"></a>
<br /><div class="caption" 
><span class="id">Listing 2: </span><span  
class="content">Backward 1-level DWT (<a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/DWT.py" >DWT.py</a>)</span></div><!--tex4ht:label?: x1-4066r2 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4068r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4069r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4070r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4071r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4072r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4073r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4074r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4075r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4076r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4077r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4078r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4079r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4080r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4081r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4082r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inversely</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4083r16"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4084r17"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4085r18"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4086r19"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4087r20"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4088r21"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][2]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-4089r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span>
</div>
<br /> <div class="caption" 
><span class="id">Figure 1: </span><span  
class="content">Implementation of the color DWT step (forward and backward).
<!--l. 85--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
and
<!--l. 85--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
stands for <span 
class="ecti-1000">low-pass ﬁltered </span>and <span 
class="ecti-1000">high-pass ﬁltered</span>, respectively. More information
about the implementation can be found at <a 
href="https://pywavelets.readthedocs.io/en/latest/index.html" >PyWavelets</a>.</span></div><!--tex4ht:label?: x1-40901 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 89--><p class="indent" >   Notice that the <!--l. 89--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math>-iterations
DWT can be computed y applying the DWT step
<!--l. 90--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math> times, recursively,
to the subband <!--l. 90--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Multi-level DWT structures</h4>
<!--l. 93--><p class="noindent" >A dyadic 0DWT is a recursive use of the
(1-iteration<span class="footnote-mark"><a 
href="index5.html#fn4x0"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-5001f4"></a> ) 2D-DWT
applied to the <!--l. 99--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math>
subband. For example, if the 2D DWT is applied
<!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>-times
to the <!--l. 100--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math>
subband, recursively, a decomposition of spatial resolution
<!--l. 101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>-levels
is generated. For the sake of simplicity, we will denote the subbands
<!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>L</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> as only
<!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>, and
<!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math> as
only <!--l. 103--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>.
See <a 
href="https://nbviewer.jupyter.org/github/Sistemas-Multimedia/MCDWT/blob/master/docs/DWT_vs_LPT.ipynb" >DWT versus LPT</a>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.3   </span> <a 
 id="x1-60002.3"></a>Scalability provided by the 2D DWT</h4>
<!--l. 108--><p class="noindent" >Depending on the number of subband levels (pyramid levels in the <a 
href="https://vicente-gonzalez-ruiz.github.io/https://pywavelets.readthedocs.io/en/latest/index.html/" >pyramid representation</a>),
we can reconstruct an image at diﬀerent spatial scales (resolutions). For example, if an
image <!--l. 111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math>
has been transformed using the DWT of 2 iterations, we get: </p>
     <ul class="itemize1">
     <li class="itemize">Subband <!--l. 114--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>
     with the scale 2.
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-1">
         +------+
      <br />    |      |
      <br />Y/4 |  L2  |
      <br />    |      |
      <br />    +------+
      <br />       X/4
</div>
     <!--l. 122--><p class="nopar" >
     </p></li>
     <li class="itemize">Subband <!--l. 123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     (<!--l. 124--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >iDWT</mtext></mstyle> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >inverse DWT</mtext></mstyle> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >backward DWT</mtext></mstyle></math>) with
     the scale <!--l. 125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>1</mn></math>.
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-2">
         +-------------+
      <br />    |             |
      <br />    |             |
      <br />Y/2 |     L1      |
      <br />    |             |
      <br />    |             |
      <br />    +-------------+
      <br />          X/2
</div>
     <!--l. 135--><p class="nopar" >
     </p></li>
     <li class="itemize"><!--l. 137--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math> (the original image)
     with the scale <!--l. 138--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>.
                                                                  

                                                                  
     <div class="verbatim" id="verbatim-3">
         +---------------------------+
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />  Y |            L0             |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    |                           |
      <br />    +---------------------------+
      <br />                  X
</div>
     <!--l. 156--><p class="nopar" ></p></li></ul>
<!--l. 159--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.4   </span> <a 
 id="x1-70002.4"></a>A 1-iteration 2D DWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-4">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br /># Copy an image (the output directory must be the same as the input one):
 <br />rm /tmp/*.png
 <br />cp ../sequences/stockholm/000.png /tmp
 <br />
 <br /># 1-iteration 2D forward DWT:
 <br />python3 -O DWT.py -p /tmp/ -i 000
 <br />
 <br /># Visualize the subbands:
 <br />display -normalize /tmp/LL000.png # &#x003C;- LL1
 <br />display -normalize /tmp/LH000.png # &#x003C;- LH1
 <br />display -normalize /tmp/HL000.png # &#x003C;- HL1
 <br />display -normalize /tmp/HH000.png # &#x003C;- HH1
 <br />
 <br /># 1-iteration 2D backward DWT:
 <br />python3 -O DWT.py -b -p /tmp/ -i 000
 <br />
 <br /># Visualize the reconstruction:
 <br />display -normalize /tmp/000.png
 <br />
 <br /># Show diferences (PyWavelets uses floating point arithmetic):
 <br />../tools/show_differences.sh -1 /tmp/000.png -2 ../sequences/stockholm/000.png -o /tmp/diffs.png
 <br />display -normalize /tmp/diffs.png
</div>
<!--l. 185--><p class="nopar" >
</p><!--l. 187--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.5   </span> <a 
 id="x1-80002.5"></a>A 2-iterations 2D DWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-5">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br /># Copy a image (the output directory must be the same than the input one):
 <br />rm /tmp/*.png
 <br />cp ../sequences/stockholm/000.png /tmp
 <br />
 <br /># First iteration:
 <br />python3 -O DWT.py -p /tmp/ -i 000
 <br />
 <br /># Second iteration:
 <br />python3 -O DWT.py -p /tmp/LL -i 000
 <br />
 <br /># Visualize the subbands:
 <br />ls -l /tmp/*.png
 <br />display -normalize /tmp/LL000.png # &#x003C;- LL1
 <br />display -normalize /tmp/LH000.png # &#x003C;- LH1
 <br />display -normalize /tmp/HL000.png # &#x003C;- HL1
 <br />display -normalize /tmp/HH000.png # &#x003C;- HH1
 <br />display -normalize /tmp/LLLL000.png # &#x003C;- LL2
 <br />display -normalize /tmp/LLLH000.png # &#x003C;- LH2
 <br />display -normalize /tmp/LLHL000.png # &#x003C;- HL2
 <br />display -normalize /tmp/LLHH000.png # &#x003C;- HH2
 <br />
 <br /># Reverse second iteration:
 <br />python3 -O DWT.py -b -p /tmp/LL -i 000
 <br />display -normalize /tmp/LL000.png
 <br />
 <br /># Reverse first iteration:
 <br />python3 -O DWT.py -b -p /tmp/ -i 000
 <br />display -normalize /tmp/000.png
 <br />
 <br /># Show diferences:
 <br />../tools/show_differences.sh -1 /tmp/000.png -2 ../sequences/stockholm/000.png -o /tmp/diffs.png
 <br />display -normalize /tmp/diffs.png
</div>
<!--l. 223--><p class="nopar" >
</p><!--l. 227--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-90003"></a>Motion DWT (MDWT)</h3>
                                                                  

                                                                  
<!--l. 228--><p class="noindent" >The DWT can be applied to a sequence of images by simply transforming
each image of the sequence independently. This is done, for example, in
the <a 
href="https://vicente-gonzalez-ruiz.github.io/JPEG2000/" >Motion JPEG2000 video compression standard</a>. Notice that only the
spatial redundancy is exploited in MDWT. All the temporal redundancy still
remains in the video. The decomposition structure generated by MDWT
is shown in the Fig <a 
href="#x1-90502">2<!--tex4ht:ref: fig:forward_MDWT --></a>. 1-iteration MDWT inputs a sequence of images
<!--l. 235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and outputs a sequence
of decompositions <!--l. 235--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
each one providing 2 spatial resolution levels
(<!--l. 236--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
<!--l. 237--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">}</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>i</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math>) of
the image sequence.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-9001r3"></a><a 
 id="x1-9025r4"></a><a 
 id="x1-90502"></a>
                                                                  

                                                                  
<!--l. 241--><p class="noindent" ><div style="text-align:center;"> <img width=800 src="graphics/forward_MDWT.svg" /> </div>  </p><!--l. 242--><div class="lstinputlisting">
<a 
 id="x1-9002"></a>
<br /> <div class="caption" 
><span class="id">Listing 3: </span><span  
class="content">Forward MDWT (<a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/MDWT.py" >MDWT.py</a>)</span></div><!--tex4ht:label?: x1-9001r3 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9003r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9004r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9005r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9006r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9007r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">placed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">at</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9008r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9009r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9010r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9011r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9012r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9013r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9014r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9015r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9016r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9017r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9018r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9019r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9020r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9021r19"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9022r20"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9023r21"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9024r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span>
</div>
<!--l. 243--><div class="lstinputlisting">
<a 
 id="x1-9026"></a>
<br /><div class="caption" 
><span class="id">Listing 4: </span><span  
class="content">Backward MDWT (<a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/MDWT.py" >MDWT.py</a>)</span></div><!--tex4ht:label?: x1-9025r3 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9027r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9028r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9029r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9030r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9031r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">placed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">at</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x003C;</span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">&#x003E;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9032r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9033r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9034r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9035r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9036r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9037r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9038r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9039r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9040r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9041r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9042r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000">):</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9043r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9044r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9045r19"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9046r20"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9047r21"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9048r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-9049r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span>
</div>
<br /> <div class="caption" 
><span class="id">Figure 2: </span><span  
class="content">MDWT.</span></div><!--tex4ht:label?: x1-90502 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-100003.1"></a>Scalability provided by MDWT</h4>
<!--l. 249--><p class="noindent" >MDWT sequences (of (subband) decompositions) are scalable in space and in time.
Spatial scalability is a direct consequence of the 2D DWT (the number of spatial
resolution levels can be generated bycontrolled by the number of iterations of DWT).
On the other hand, it is trivial to observe that MDWT provides <span 
class="ecti-1000">fully </span>temporal
scalability (we can access to the images randomly) because each image of the input
sequence is transformed independently.
</p><!--l. 257--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-110003.2"></a>1-iteration MDWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-6">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br /># Create the output directory for the 1st-level decompositions:
 <br />yes | cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 2D 1-iteration forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/ -N 5
 <br />
 <br /># Visualize the subbands:
 <br />for i in /tmp/LL00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/LL*.norm
 <br />for i in /tmp/LH00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/LH*.norm
 <br />for i in /tmp/HL00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/HL*.norm
 <br />for i in /tmp/HH00?.png; do convert -normalize $i $i.norm; done
 <br />animate /tmp/HH*.norm
 <br />
 <br /># 2D 1-iteration backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/ -N 5
 <br />
 <br /># Visualization of the reconstruction:
 <br />rm /tmp/*.norm
 <br />for i in /tmp/00?.png; do convert -normalize $i $i.norm; done; animate /tmp/00?.png.norm
</div>
<!--l. 283--><p class="nopar" >
</p><!--l. 285--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.3   </span> <a 
 id="x1-120003.3"></a>2-iterations MDWT example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-7">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br /># Create the output directory for the 1st-level decompositions:
 <br />yes | cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 2D 2-iterations forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/ -N 5
 <br />python3 -O MDWT.py -p /tmp/LL -N 5
 <br />
 <br />
 <br /># 2D 2-iterations backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/LL -N 5
 <br />python3 -O MDWT.py -b -p /tmp/ -N 5
 <br />
 <br /># Visualization of the reconstruction:
 <br />rm /tmp/*.norm
 <br />for i in /tmp/00?.png; do convert -normalize $i $i.norm; done; animate /tmp/00?.png.norm
</div>
<!--l. 304--><p class="nopar" >
</p><!--l. 308--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-130004"></a>Video transform alternatives</h3>
<!--l. 311--><p class="noindent" >To remove both, spatial and temporal redundancies, two diﬀerent alternatives are
available: (1) t+2D transforms and (2) 2D+t transforms. In a t+2D transform, the
video is ﬁrst <a 
href="https://en.wikipedia.org/wiki/Digital_filter#Analysis_techniques" >analyzed</a> (transformed) over the time domain and next, over the space
domain. A 2D+t transform does just the opposite. Each choice has a number of <span 
class="ecti-1000">pros</span>
and <span 
class="ecti-1000">cons</span>. For example, in a t+2D transform we can apply directly any image
predictor based on <a 
href="https://en.wikipedia.org/wiki/Motion_estimation" >motion estimation</a> because the input is a normal video.
However, if we implement a 2D+t transform, the input to the motion estimator
is a sequence decompositions. <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >The overwhelming majority of DWT&#x2019;s</a> are
not <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >shift invariant</a>, which basically means that, exactly the same object
placed in two diﬀerent images in diﬀerent positions will generate diﬀerent
wavelet coeﬃcients, even if the displacement is an integer number of pixels and
therefore, the pixels of the object in both images are identical. Therefore, motion
estimators which compare coeﬃcient values will not work with accuracy on the
decomposition domain. On the other hand, if we want to provide true spatial
scalability (processing only those <a 
href="https://www.tutorialspoint.com/dip/spatial_resolution.htm" >spatial resolutions</a> (scales) necessary to get
a spatially scaled of our video), a t+2D transformed video presents some
drawbacks:
</p><!--l. 338--><p class="indent" >
                                                                  

                                                                  
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-13002x1">The perfect reconstruction of the original images only is possible of the t
     stage is identical at both, the <a 
href="https://en.wikipedia.org/wiki/Encoder" >encoder</a> and the <a 
href="https://en.wikipedia.org/wiki/Decoder" >decoder</a>. Therefore, if the
     encoder apply t at the full resolution (scale 0), the decoder must apply t
     at full resolution, also, even if the resolution of the reconstructed images
     were smaller. This could be unfeasible for receivers with low computational
     resourcers.
     </li>
     <li 
  class="enumerate" id="x1-13004x2">Perfect reconstruction can be sacriﬁed using a quantized version of the
     motion information, but the rate/distortion (R/D) tradeoﬀ will be worst.
     In this case, also, the decoder would be wasting motion information.
     </li>
     <li 
  class="enumerate" id="x1-13006x3">This last problem (the waste of motion information) could be avoided
     if the motion data were encoded in a progressive representation (each
     one suitable for working in a diﬀerent spatial resolution of the images).
     Unfortunately, progressive representations use to need more data than
     non-progressive ones.</li></ol>
<!--l. 358--><p class="indent" >   Finally, it is important to realize that the presence of the motion data in the
code-stream introduces also complexity into the decoding process because, in a
quality scalable scenario, for example, it is not trivial (specially when non-linear
systems such as those based on ME are involved) to decide how to interleave the
motion and the texture information in a code-stream that can be decoded partially
depending on the avaliable bandwidth.
</p><!--l. 369--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-140005"></a>Motion Compensated Discrete Wavelet Transform (MCDWT)</h3>
<!--l. 370--><p class="noindent" >MCDWT is a 2D+t transform. The 2D stage is MDWT, and it is applied ﬁrst. The t
stage is a 1D DWT, which removes the temporal redundancy between adjacent
<!--l. 372--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands by means of <a 
href="https://en.wikipedia.org/wiki/Motion_compensation" >Motion Compensation (MC)</a>. A special characteristic of
MCDWT is that the motion information is not transmitted from the encoder to the
decoder, which must replicate it or at least, predict it. This is possible because to
estimate de motion at the encoder, only the information that it is accesible by the
decoder is used.
</p><!--l. 380--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-150005.1"></a>The MCDWT butterﬂy</h4>
<!--l. 381--><p class="noindent" >MCDWT butterly inputs three decompositions
<!--l. 381--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
                                                                  

                                                                  
<!--l. 381--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
<!--l. 382--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>, and outputs a
residue subband <!--l. 383--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which replaces to <!--l. 383--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
in the original <!--l. 383--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
decomposition. Therefore, after the use of the buﬀerﬂy, we get
<!--l. 385--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math> (an <a 
href="https://en.wikipedia.org/wiki/Video_compression_picture_types" >intra-coded “I”
image</a>), <!--l. 387--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></math> (a <a 
href="https://en.wikipedia.org/wiki/Video_compression_picture_types" >bidirectionally
predicted “B” image</a><span class="footnote-mark"><a 
href="index6.html#fn5x0"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-15001f5"></a> )
and <!--l. 393--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
(another intra-coded “I” image). This replacement is fully reversible because the
forward transform uses only the information that the backward transform
will have access to. Notice that the <a 
href="http://www.vtvt.ece.vt.edu/research/references/video/DCT_Video_Compression/Zhang92a.pdf" >pyramid domain</a> (which is invariant to
the pixels displacements) has been used to estimate and compensate the
<!--l. 399--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-150023"></a><a 
 id="x1-15003r5"></a><a 
 id="x1-15060r6"></a>
                                                                  

                                                                  
<!--l. 403--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/forward_butterfly.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 3: </span><span  
class="content">Forward MCDWT butterﬂy.</span></div><!--tex4ht:label?: x1-150023 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 407--><div class="lstinputlisting">
<a 
 id="x1-15004"></a>
<br /> <div class="caption" 
><span class="id">Listing 5: </span><span  
class="content">MCDWT.py (extract)</span></div><!--tex4ht:label?: x1-15003r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15005r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15006r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15007r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15008r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15009r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15010r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15011r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15012r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15013r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15014r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15015r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15016r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15017r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15018r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">requency</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">information</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15019r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15020r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15021r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15022r18"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15023r19"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15024r20"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15025r21"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15026r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15027r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15028r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15029r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15030r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15031r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15032r28"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15033r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15034r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15035r31"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15036r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15037r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15038r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15039r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15040r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">tilde</span><span 
class="ecit-1000">{</span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">}</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15041r37"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15042r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15043r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15044r40"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15045r41"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15046r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15047r43"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15048r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15049r45"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15050r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15051r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15052r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15053r49"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15054r50"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15055r51"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15056r52"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15057r53"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15058r54"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15059r55"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">[1]</span>
   
   </div>
<!--l. 408--><div class="lstinputlisting">
<a 
 id="x1-15061"></a>
<br /><div class="caption" 
><span class="id">Listing 6: </span><span  
class="content">simple_average.py (extract)</span></div><!--tex4ht:label?: x1-15060r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15062r1"></a></span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15063r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15064r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15065r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15066r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-15067r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">/</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span>
   
   </div>
<!--l. 410--><p class="indent" >   Notice that, even if <!--l. 410--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 410--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
(at full resolution) are available at the decoder, only
<!--l. 411--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> is.
So, it does not make sense to search the low resolution structures of
<!--l. 412--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> in the high
resolution images <!--l. 412--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 413--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>,
because even if a perfect match is achieved (think about the three decompositions
<!--l. 414--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>,
<!--l. 414--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> and
<!--l. 414--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
are identical), the prediction error would be diﬀerent than
<!--l. 415--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
as a consequence of that the high resolution information is missing in
<!--l. 416--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-160005.2"></a>The MCDWT step</h4>
<!--l. 419--><p class="noindent" >A step of the MCDWT is carried out when the MCDWT butterﬂy is applied to all
the images of the input sequece using the pattern shown in the Fig. <a 
href="#x1-160014">4<!--tex4ht:ref: fig:forward_MCDWT_step --></a>. Notice that
only the images with an odd number are transformed. </p><hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-160014"></a>
                                                                  

                                                                  
<!--l. 425--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/forward_MCDWT_step.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 4: </span><span  
class="content">MCDWT forward step.</span></div><!--tex4ht:label?: x1-160014 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-170005.3"></a>The forward MCDWT</h4>
<!--l. 432--><p class="noindent" >The forward MCDWT is the result of appliying the forward MCDWT step recursively, to the image
with number <!--l. 433--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>i</mi></mrow></msup 
></math>,
where <!--l. 433--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
is the iteration of the MCDWT step. As a result, chooding
<!--l. 434--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>i</mi></math>
large enough, except for the ﬁrst and the last image of the sequence, all the
<!--l. 436--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>-subbands
are temporally decorrelated.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-170015"></a><a 
 id="x1-17002r7"></a><a 
 id="x1-17064r8"></a>
                                                                  

                                                                  
<!--l. 440--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/temporal_decorrelation.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 5: </span><span  
class="content">MCDWT forward transform.</span></div><!--tex4ht:label?: x1-170015 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 445--><div class="lstinputlisting">
<a 
 id="x1-17003"></a>
<br /> <div class="caption" 
><span class="id">Listing 7: </span><span  
class="content">Code of the forward transform (MCDWT.py)</span></div><!--tex4ht:label?: x1-17002r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17004r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17005r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17006r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17007r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17008r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17009r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17010r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17011r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17012r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17013r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17014r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17015r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17016r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17017r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">requency</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">information</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17018r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17019r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17020r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17021r18"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17022r19"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17023r20"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17024r21"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17025r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17026r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17027r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17029r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17030r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17031r28"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17032r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17033r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17034r31"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17035r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17036r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17037r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17038r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17039r36"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">\</span><span 
class="ecit-1000">tilde</span><span 
class="ecit-1000">{</span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">}</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17040r37"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17041r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17042r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17043r40"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17044r41"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17045r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17046r43"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17047r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17048r45"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17049r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17050r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17051r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17052r49"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17053r50"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17054r51"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17055r52"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">predictor</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17056r53"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17057r54"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17058r55"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17059r56"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17060r57"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">=2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17061r58"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">A</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Discrete</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Wavelet</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Transform</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17062r59"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17063r60"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">The</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">video</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span>
   
   </div>
<!--l. 446--><div class="lstinputlisting">
<a 
 id="x1-17065"></a>
<br /><div class="caption" 
><span class="id">Listing 8: </span><span  
class="content">Code of the backward transform (MCDWT.py)</span></div><!--tex4ht:label?: x1-17064r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17066r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">directory</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000">&#x003E;,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">and</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">the</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">output</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">as</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">a</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1-</span><span 
class="ectt-1000">levels</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">MC</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17067r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decompositions</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">will</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generated</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">the</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">same</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">directory</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17068r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17069r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Input</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17070r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17071r6"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17072r7"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prefix</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">str</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17073r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17074r9"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Localization</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">of</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">the</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">input</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">output</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">images</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">Example</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17075r10"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17076r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-17077r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">int</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-180005.4"></a>(Spatial) Multiresolution</h4>
<!--l. 449--><p class="noindent" >Spatial dyadic multiresolution can be obtained by appliying a sequence of
(MDWT+MCDWT) steps (see Fig. <a 
href="#x1-180016">6<!--tex4ht:ref: fig:multiresolution --></a>).
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-180016"></a><a 
 id="x1-24005r9"></a>
                                                                  

                                                                  
<!--l. 454--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/multiresolution.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 6:  </span><span  
class="content">MDWT+MCDWT  multiresolution  procedure.  The  input  to  the
second iteration of the MDWT+MCDWT transform is the output of a previous
(ﬁrst)  iteration  MDWT+MCDWT  transform.  The  second  iteration  is  only
applied to the scale 1.</span></div><!--tex4ht:label?: x1-180016 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 462--><p class="indent" >   Spatial dyadic multiresolution can be obtained by appliying a sequence of
MDWT+MCDWT steps (see Fig. <a 
href="#x1-180016">6<!--tex4ht:ref: fig:multiresolution --></a>).
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.5   </span> <a 
 id="x1-190005.5"></a>Scalability provided by MCDWT</h4>
<!--l. 466--><p class="noindent" >The spatial decomposition generated by MCDWT is identical to the produced by
MDWT, and therefore, MCDWT provides the same spatial scalability than MDWT.
In order to obtain several spatial resolutions, MCDWT should be applied to the
low-frequency subbands, recursively. As it is shown in the example of the Figure <a 
href="#x1-180016">6<!--tex4ht:ref: fig:multiresolution --></a>,
MCDWT has been applied to the output of the example of the Figure <a 
href="#x1-170015">5<!--tex4ht:ref: fig:forward_MCDWT --></a>.
Notice that between two consecutive iterations of MCDWT, MDWT must be
applied to the low-frequency subband in order to reduce the resolution of the
analysis.
</p><!--l. 476--><p class="indent" >   On the other hand, MCDWT decreases the temporal scalability oﬀered
by MDWT to allowing only dyadic access (depending on required image
and the number of MCDWT levels, more than one decomposition needs to
be inversely transformed). For example, if only one step of the backward
transform is applied to the example of the Figure <a 
href="#x1-170015">5<!--tex4ht:ref: fig:forward_MCDWT --></a>, only the decompositions of
<!--l. 481--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></math>,
<!--l. 482--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math> and
<!--l. 482--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
></math> will
be reconstructed (the second <a 
href="https://en.wikipedia.org/wiki/Temporal_resolution" >temporal resolution</a>). If a second iteration of the
backward transform is used, all the decompositions are rendered.
</p><!--l. 487--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.6   </span> <a 
 id="x1-200005.6"></a>MCDWT 1-levels example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-8">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 1D 1-levels forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/
 <br />
 <br /># 1D 1-levels forward MCDWT:
 <br />python3 -O MCDWT.py -p /tmp/
 <br />
 <br />rm /tmp/00?.png
 <br />
 <br /># 1D 1-levels backward MCDWT:
 <br />python3 -O MCDWT.py -b -p /tmp/
 <br />
 <br /># 1D 1-levels backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/
 <br />
 <br /># Visualization of the reconstruction:
 <br />for i in /tmp/???.png; do python3 ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/???.png.png
</div>
<!--l. 509--><p class="nopar" >
</p><!--l. 511--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.7   </span> <a 
 id="x1-210005.7"></a>Showing some statistics</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-9">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 1D 1-levels forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/
 <br />
 <br /># First and last decompositions are not transformed by MCDWT (step 1/2):
 <br />ls -l /tmp/HH000.png
 <br />ls -l /tmp/HL004.png
 <br />
 <br /># The rest, are transformed (step 1/2):
 <br />ls -l /tmp/HL001.png
 <br />ls -l /tmp/LH002.png
 <br />ls -l /tmp/HH003.png
 <br />
 <br /># Showing statistics (step 1/2):
 <br />python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/LH002.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL002.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HH002.png
 <br />
 <br /># 1D 1-levels forward MCDWT:
 <br />python3 -O MCDWT.py -p /tmp/
 <br />
 <br /># First and last decompositions are not transformed by MCDWT step 2/2):
 <br />ls -l /tmp/HH000.png
 <br />ls -l /tmp/HL004.png
 <br />
 <br /># The rest, are transformed (step 2/2):
 <br />ls -l /tmp/HL001.png
 <br />ls -l /tmp/LH002.png
 <br />ls -l /tmp/HG003.png
 <br />
 <br /># Showing statistics:
 <br />python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HH001.png
 <br />python3 ../tools/show_statistics.py -i /tmp/LH002.png
 <br />python3 ../tools/show_statistics.py -i /tmp/HL002.png
                                                                  

                                                                  
 <br />python3 ../tools/show_statistics.py -i /tmp/HH002.png
 <br />
 <br /># Visualization of the H-subbands
 <br />for i in /tmp/LH00?.png; do convert -normalize $i $i.png; done; animate /tmp/LH00?.png.png
 <br />for i in /tmp/HL00?.png; do convert -normalize $i $i.png; done; animate /tmp/HL00?.png.png
 <br />for i in /tmp/HH00?.png; do convert -normalize $i $i.png; done; animate /tmp/HH00?.png.png
</div>
<!--l. 561--><p class="nopar" >
</p><!--l. 563--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.8   </span> <a 
 id="x1-220005.8"></a>Filtering the MC subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-10">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />cp ../sequences/stockholm/*.png /tmp
 <br />
 <br /># 1D 1-levels forward MDWT:
 <br />python3 -O MDWT.py -p /tmp/
 <br />
 <br /># 1D 1-levels forward MCDWT:
 <br />python3 -O MCDWT.py -p /tmp/
 <br />
 <br /># Let&#x2019;s clear the motion compensated subbands and reconstruct the sequence ...
 <br />
 <br /># Create a zero subband:
 <br />bash ../tools/create_black_image.sh; python ../tools/add_offset.py -i /tmp/zero.png -o /tmp/zero16.png -f 32768
 <br />python3 ../tools/show_statistics.py -i /tmp/zero16.png
 <br />
 <br /># &#x0022;Delete&#x0022; the motion compensated subbands:
 <br />yes | cp /tmp/zero16.png /tmp/LH001.png
 <br />yes | cp /tmp/zero16.png /tmp/HL001.png
 <br />yes | cp /tmp/zero16.png /tmp/HH001.png
 <br />yes | cp /tmp/zero16.png /tmp/LH002.png
 <br />yes | cp /tmp/zero16.png /tmp/HL002.png
 <br />yes | cp /tmp/zero16.png /tmp/HH002.png
 <br />yes | cp /tmp/zero16.png /tmp/LH003.png
 <br />yes | cp /tmp/zero16.png /tmp/HL003.png
 <br />yes | cp /tmp/zero16.png /tmp/HH003.png
 <br />
 <br /># 1D 1-levels backward MCDWT:
 <br />python3 -O MCDWT.py -b -p /tmp/
 <br />
 <br /># 1D 1-levels backward MDWT:
 <br />python3 -O MDWT.py -b -p /tmp/
 <br />
 <br /># Visualization of the reconstruction:
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
 <br />
 <br /># Visualization of the differences with the original sequence:
 <br />rm -f /tmp/diff*.png; for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/$ii.png -2 ../sequences/stockholm/$ii.png -o /tmp/diff_$ii.png; done; animate /tmp/diff*.png
</div>
<!--l. 603--><p class="nopar" >
</p><!--l. 605--><p class="noindent" >
                                                                  

                                                                  
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.9   </span> <a 
 id="x1-230005.9"></a>2D-MDWT-MCDWT 2-levels example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-11">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/
 <br />python3 -O MCDWT.py -p /tmp/
 <br />python3 -O MDWT.py -p /tmp/LL
 <br />python3 -O MCDWT.py -p /tmp/LL
 <br />
 <br />rm /tmp/00?.png
 <br />
 <br />python3 -O MCDWT.py -p /tmp/LL -b
 <br />python3 -O MDWT.py -p /tmp/LL -b
 <br />python3 -O MCDWT.py -p /tmp/ -b
 <br />python3 -O MDWT.py -p /tmp/ -b
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 623--><p class="nopar" >
</p><!--l. 627--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">6   </span> <a 
 id="x1-240006"></a>Adaptive motion compensation based on the distortion of the prediction
error</h3>
<!--l. 630--><p class="noindent" >As can be seen in the MCDWT buﬀerﬂy (see Fig. <a 
href="#x1-150023">3<!--tex4ht:ref: fig:forward_butterfly --></a>), both predictions
<!--l. 631--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> and
<!--l. 632--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> have
the same weight to build the prediction </p><table class="equation"><tr><td> <a 
 id="x1-24001r1"></a>
<!--l. 633--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                      <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
         <mrow 
><mn>2</mn></mrow></mfrac>         <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(1)</td></tr></table>
                                                                  

                                                                  
<!--l. 636--><p class="indent" >   This simple computation, that can have very eﬀective for example in <a 
href="https://biteable.com/blog/tips/video-transitions-effects-examples/" >dissolves</a>
video transitions, can also be counterproductive when objects appear only
in one of the reference images. For this reason, in this section a diﬀerent
predictor is proposed, based on the prediction error generated during the ME
process.
</p><!--l. 643--><p class="indent" >   Let <!--l. 643--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> the prediction
generated for the subband <!--l. 643--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
using <!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as reference
and <!--l. 644--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">→</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as motion, and
let <!--l. 645--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> the prediction
generated for <!--l. 645--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
using <!--l. 645--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> as
reference and <!--l. 646--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">→</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
as motion. We now compute the prediction errors </p><table class="equation"><tr><td> <a 
 id="x1-24002r2"></a>
<!--l. 648--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" columnlines="" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left"> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-punc">.</mo>  </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(2)</td></tr></table>
<!--l. 655--><p class="indent" >   Now, we deﬁne the similarity matrices as </p><table class="equation"><tr><td> <a 
 id="x1-24003r3"></a>
<!--l. 656--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" columnlines="" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left">  <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo>      <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">|</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-rel">|</mo></mrow></mfrac> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left"> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo>      <mfrac><mrow 
><mn>1</mn></mrow> 
<mrow 
><mn>1</mn><mo 
class="MathClass-bin">+</mo><mo 
class="MathClass-rel">|</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-rel">|</mo></mrow></mfrac><mo 
class="MathClass-punc">.</mo>  </mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(3)</td></tr></table>
<!--l. 663--><p class="indent" >   Notice that, if (for example) the error
<!--l. 663--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>e</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>0</mn></math>, the
similarity is <!--l. 664--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
(the maximum similarity), and if the error is high, the similarity tends to be
<!--l. 665--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>.
</p><!--l. 667--><p class="indent" >   With this information, that can be recovered by the decoder, the improved
prediction is deﬁned as </p><table class="equation"><tr><td> <a 
 id="x1-24004r4"></a>
                                                                  

                                                                  
<!--l. 669--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                  <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
        <mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></mfrac>        <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(4)</td></tr></table>
<!--l. 673--><p class="indent" >   Notice that, if (for example) <!--l. 673--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>
and <!--l. 674--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">≈</mo> <mn>0</mn></math>, then
<!--l. 675--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">≈</mo> <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></math>, and
viceversa. If <!--l. 676--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></math>,
then <!--l. 677--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-op">̂</mo></mover></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mrow 
><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mo 
class="MathClass-bin">+</mo><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
        <mrow 
><mn>2</mn></mrow></mfrac>         </math>
(even if both similarities are small).
</p>
   <!--l. 679--><div class="lstinputlisting">
<a 
 id="x1-24006"></a>
<br /> <div class="caption" 
><span class="id">Listing 9: </span><span  
class="content">weighted_average.py (extract)</span></div><!--tex4ht:label?: x1-24005r6 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24007r1"></a></span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24008r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24009r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">motion_estimation</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24010r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24011r5"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24012r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_AL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24013r7"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">estimate_frame</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">flow_CL_BL</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24014r8"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">EAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BAL</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24015r9"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">ECL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BCL</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24016r10"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1/(1+</span><span 
class="ectt-1000">abs</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">EAL</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24017r11"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1/(1+</span><span 
class="ectt-1000">abs</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">ECL</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-24018r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BAH</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">BCH</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000">)/(</span><span 
class="ectt-1000">SAL</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">SCL</span><span 
class="ectt-1000">)</span>
   
   </div>
<!--l. 683--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">7   </span> <a 
 id="x1-250007"></a>Orthogonal, orthonormal, and biorthogonal transforms</h3>
<!--l. 686--><p class="noindent" >In signal processing<span class="footnote-mark"><a 
href="index7.html#fn6x0"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-25001f6"></a> ,
a transform (such as the <a 
href="https://en.wikipedia.org/wiki/Discrete_cosine_transform" >Discrete Cosine Transform</a>, the <a 
href="https://en.wikipedia.org/wiki/Hadamard_transform" >Walsh-Hadamard Transform</a>
or the <a 
href="https://en.wikipedia.org/wiki/Karhunen%E2%80%93Lo%C3%A8ve_theorem" >Karhunen-Loève Transform</a>) is orthogonal when the coeﬃcients generated by
the transform are uncorrelated (there is no way to infer one coeﬃcient from
another).
</p><!--l. 701--><p class="indent" >   If the <a 
href="https://en.wikipedia.org/wiki/Norm_(mathematics)" >norm</a> of all the basis of an orthogonal transform is one, then the
transform is said <a 
href="https://en.wikipedia.org/wiki/Orthonormal_basis" >orthonormal</a>. Orthonormal transforms are interesting because of
their:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-25003x1"><a 
href="https://en.wikipedia.org/wiki/Energy_(signal_processing)" ><span 
class="ecbx-1000">Energy</span></a>  <span 
class="ecbx-1000">preservation</span>:  The  energy  of  the  output  is  the  same  than
     the energy of the input. This means that, for example, a quantization
                                                                  

                                                                  
     error produced in a coeﬃcient of the transform will generate the same
     quantization  error  at  the  output  (the  complete  signal)  of  the  inverse
     transform. The same holds by the forward transform.
     </li>
     <li 
  class="enumerate" id="x1-25005x2"><span 
class="ecbx-1000">Implementation</span>:  The  transform  matrix  of  the  inverse  transform  is
     the transpose of the forward transform. In orthogonal transforms, the
     transform matrix of the inverse transform is the inverse of the transform
     matrix of the forward transform.</li></ol>
<!--l. 720--><p class="indent" >   Biorthogonal transforms (and in particular, <a 
href="https://en.wikipedia.org/wiki/Biorthogonal_wavelet" >biorthogonal wavelets</a>) do
no satisfy any of these features: they are not energy preserving (this can
be also observed because the frequency-domain responses of the analysis
and synthesis ﬁlters are not symmetric), and there is not an algebraic way
(matrix transposition/inversion) to compute the backward transform from the
forward one, and viceversa. This, that can be considered as a drawback, gives
an extra degree of freedom to design the analysis and the synthesis ﬁlters
(whose only requirement is that transform pair to be reversible), providing in
general the possibility of using more soﬁsticated ﬁlters such as those based
on non-linear ﬁltering, as for example, those that use motion estimation
algorithms.
</p><!--l. 734--><p class="indent" >   In general, each subband <!--l. 734--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
of a decomposition generated by a biorthogonal 2D-DWT transform have a diﬀerent subband
gain <!--l. 736--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>α</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
></math>.
Usually, the lower the frequency of the subband, the higher the gain. Notice also,
that these gains also are diﬀerent for each transform.
</p><!--l. 740--><p class="indent" >   Subband gains are important in lossy signal compression because they quantify
the relative importance of the wavelet coeﬃcients of the diﬀerent subbands when we
introduce distortion in the wavelet domain. Thus, for example, if we decide to
quantize a wavelet coeﬃcient, the amount of distortion that we are generating in the
signal domain will depend on the subband where that coeﬃcient is localized. In
general, low-frequency coeﬃcients are more “important” that high-frequency
ones.
</p><!--l. 749--><p class="indent" >   To compute the subband gains we have two options:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-25007x1">The algebraic way. We will need the expressions of the four ﬁlters (two
     anaylsis ﬁlters and two synthesis ﬁlters) and deduce the gains.
     </li>
     <li 
  class="enumerate" id="x1-25009x2">The algorithmic way. We will need to compute the energy of the impulse response
     of the inverse transform, when we apply such impulse to each one of the
     subbands of the decomposition. Supposing that, after appliying the DWT to an
     image, the coeﬃcients of the subband HH are the least energetic with an energy
     <!--l. 758--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math>, the subband
     gain for subband <!--l. 759--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
     is computed as <table class="equation"><tr><td> <a 
 id="x1-25010r5"></a>
                                                                  

                                                                  
     <!--l. 760--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                            <msub><mrow 
><mi 
>α</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
><mo 
class="MathClass-bin">∕</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo>
</math></td><td class="eq-no">(5)</td></tr></table>
     <!--l. 763--><p class="noindent" >where <!--l. 763--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>E</mi></mrow><mrow 
><mi 
>b</mi></mrow></msub 
></math>
     is the energy of the reconstruction when the impulse signal is localized at
     <!--l. 764--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>.
     Notice that all the gains should be larger than one.</p></li></ol>
<!--l. 768--><p class="indent" >   This computation can be also applied to MCDWT, by computing the subband gains as a function
of the number <!--l. 769--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>
of temporal decompositions.
</p>
   <h3 class="sectionHead"><span class="titlemark">8   </span> <a 
 id="x1-260008"></a>Quantization eﬀects</h3>
<!--l. 775--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.1   </span> <a 
 id="x1-270008.1"></a>Quantization of (<!--l. 775--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>)
MC subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-12">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/ -N 3
 <br />python3 -O MCDWT.py -p /tmp/ -N 3
 <br />
 <br />q_step=32
 <br />python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/quantize.py -i /tmp/LH001.png -o /tmp/LH001.png -q $q_step
 <br />python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/quantize.py -i /tmp/HL001.png -o /tmp/HL001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HH001.png -o /tmp/HH001.png -q $q_step
 <br />
 <br />python3 -O MCDWT.py -p /tmp/ -b -N 3
 <br />python3 -O MDWT.py -p /tmp/ -b -N 3
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 794--><p class="nopar" >
</p><!--l. 796--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.2   </span> <a 
 id="x1-280008.2"></a>Quantization of all <!--l. 796--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-13">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/ -N 3
 <br />python3 -O MCDWT.py -p /tmp/ -N 3
 <br />
 <br />q_step=32
 <br />python3 ../tools/quantize.py -i /tmp/LH000.png -o /tmp/LH000.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HL000.png -o /tmp/HL000.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HH000.png -o /tmp/HH000.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/LH001.png -o /tmp/LH001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HL001.png -o /tmp/HL001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HH001.png -o /tmp/HH001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/LH002.png -o /tmp/LH002.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HL002.png -o /tmp/HL002.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HH002.png -o /tmp/HH002.png -q $q_step
 <br />
 <br />python3 -O MCDWT.py -p /tmp/ -b -N 3
 <br />python3 -O MDWT.py -p /tmp/ -b -N 3
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 819--><p class="nopar" >
</p><!--l. 832--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">8.3   </span> <a 
 id="x1-290008.3"></a>Quantization of all <!--l. 832--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-14">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/ -N 3
 <br />python3 -O MCDWT.py -p /tmp/ -N 3
 <br />
 <br />q_step=128
 <br />python3 ../tools/quantize.py -i /tmp/LL000.png -o /tmp/LL000.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/LH000.png -o /tmp/LH000.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HL000.png -o /tmp/HL000.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HH000.png -o /tmp/HH000.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/LL001.png -o /tmp/LL001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/LH001.png -o /tmp/LH001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HL001.png -o /tmp/HL001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HH001.png -o /tmp/HH001.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/LL002.png -o /tmp/LL002.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/LH002.png -o /tmp/LH002.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HL002.png -o /tmp/HL002.png -q $q_step
 <br />python3 ../tools/quantize.py -i /tmp/HH002.png -o /tmp/HH002.png -q $q_step
 <br />
 <br />python3 -O MCDWT.py -p /tmp/ -b -N 3
 <br />python3 -O MDWT.py -p /tmp/ -b -N 3
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 858--><p class="nopar" >
</p><!--l. 862--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">9   </span> <a 
 id="x1-300009"></a>Lossy compression eﬀects</h3>
<!--l. 865--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.1   </span> <a 
 id="x1-310009.1"></a>Compression of (<!--l. 865--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>)
MC subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-15">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/ -N 3
 <br />python3 -O MCDWT.py -p /tmp/ -N 3
 <br />
 <br />quality=50
 <br />#python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/compress.py -i /tmp/LH001.png -o /tmp/LH001.png -q $quality
 <br />#python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/add_offset.py -i /tmp/LH001.png -o /tmp/LH001.png -f 32640
 <br />#python3 ../tools/show_statistics.py -i /tmp/LH001.png
 <br />python3 ../tools/compress.py -i /tmp/HL001.png -o /tmp/HL001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HL001.png -o /tmp/HL001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HH001.png -o /tmp/HH001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HH001.png -o /tmp/HH001.png -f 32640
 <br />
 <br />python3 -O MCDWT.py -p /tmp/ -b -N 3
 <br />python3 -O MDWT.py -p /tmp/ -b -N 3
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 888--><p class="nopar" >
</p><!--l. 890--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.2   </span> <a 
 id="x1-320009.2"></a>Quantization of all <!--l. 890--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-16">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/ -N 3
 <br />python3 -O MCDWT.py -p /tmp/ -N 3
 <br />
 <br />quality=10
 <br />python3 ../tools/compress.py -i /tmp/LH000.png -o /tmp/LH000.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LH000.png -o /tmp/LH000.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HL000.png -o /tmp/HL000.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HL000.png -o /tmp/HL000.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HH000.png -o /tmp/HH000.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HH000.png -o /tmp/HH000.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/LH001.png -o /tmp/LH001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LH001.png -o /tmp/LH001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HL001.png -o /tmp/HL001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HL001.png -o /tmp/HL001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HH001.png -o /tmp/HH001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HH001.png -o /tmp/HH001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/LH002.png -o /tmp/LH002.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LH002.png -o /tmp/LH002.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HL002.png -o /tmp/HL002.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HL002.png -o /tmp/HL002.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HH002.png -o /tmp/HH002.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HH002.png -o /tmp/HH002.png -f 32640
 <br />
 <br />python3 -O MCDWT.py -p /tmp/ -b -N 3
 <br />python3 -O MDWT.py -p /tmp/ -b -N 3
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 922--><p class="nopar" >
</p><!--l. 924--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">9.3   </span> <a 
 id="x1-330009.3"></a>Quantization of all <!--l. 924--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-17">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br />yes | cp ../sequences/stockholm/* /tmp
 <br />python3 -O MDWT.py -p /tmp/ -N 3
 <br />python3 -O MCDWT.py -p /tmp/ -N 3
 <br />
 <br />quality=10
 <br />python3 ../tools/compress.py -i /tmp/LL000.png -o /tmp/LL000.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LL000.png -o /tmp/LL000.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/LH000.png -o /tmp/LH000.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LH000.png -o /tmp/LH000.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HL000.png -o /tmp/HL000.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HL000.png -o /tmp/HL000.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HH000.png -o /tmp/HH000.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HH000.png -o /tmp/HH000.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/LL001.png -o /tmp/LL001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LL001.png -o /tmp/LL001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/LH001.png -o /tmp/LH001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LH001.png -o /tmp/LH001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HL001.png -o /tmp/HL001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HL001.png -o /tmp/HL001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HH001.png -o /tmp/HH001.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HH001.png -o /tmp/HH001.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/LL002.png -o /tmp/LL002.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LL002.png -o /tmp/LL002.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/LH002.png -o /tmp/LH002.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/LH002.png -o /tmp/LH002.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HL002.png -o /tmp/HL002.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HL002.png -o /tmp/HL002.png -f 32640
 <br />python3 ../tools/compress.py -i /tmp/HH002.png -o /tmp/HH002.png -q $quality
 <br />python3 ../tools/add_offset.py -i /tmp/HH002.png -o /tmp/HH002.png -f 32640
 <br />
 <br />python3 -O MCDWT.py -p /tmp/ -b -N 3
 <br />python3 -O MDWT.py -p /tmp/ -b -N 3
 <br />
 <br />for i in /tmp/00?.png; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/00?.png.png
</div>
<!--l. 962--><p class="nopar" >
</p><!--l. 966--><p class="noindent" >
</p>
                                                                  

                                                                  
   <h3 class="sectionHead"><span class="titlemark">10   </span> <a 
 id="x1-3400010"></a>MCDWT decomposition</h3>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-340017"></a>
                                                                  

                                                                  
<!--l. 971--><p class="noindent" ><div style="text-align:center;"> <img width=1200 src="graphics/MCDWT_decomposition.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 7: </span><span  
class="content">MCDWT(<!--l. 975--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>,
<!--l. 975--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi> <mo 
class="MathClass-rel">=</mo> <mn>3</mn></math>)
decomposition (notice that <!--l. 975--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >GOP_size</mtext></mstyle> <mo 
class="MathClass-rel">=</mo> <mn>8</mn> <mo 
class="MathClass-rel">=</mo> <msup><mrow 
><mn>2</mn></mrow><mrow 
><mi 
>T</mi></mrow></msup 
></math>).
The  arrows  indicate  image  dependencies  (for  example,  to  decode  image  1,
images 0 and 2 should have been decoded.</span></div><!--tex4ht:label?: x1-340017 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
<!--l. 979--><p class="indent" >   MCDWT(<!--l. 979--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>,
<!--l. 979--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>),
where <!--l. 979--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi></math>
is the number of levels of the spatial transform and
<!--l. 980--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>
is the number of levels of the temporal transform, decomposes
a sequence of images into a sequence of subbands organized in
<!--l. 982--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math> of temporal
scales of <!--l. 982--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>S</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>
spatial scales (see Fig. <a 
href="#x1-340017">7<!--tex4ht:ref: fig:MCDWT_decomposition --></a>).
</p>
   <h3 class="sectionHead"><span class="titlemark">11   </span> <a 
 id="x1-3500011"></a>Encoding of B-type H-subbands (experimental)</h3>
<!--l. 990--><p class="noindent" >The subband <!--l. 990--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
generated by the MCDWT butterﬂy (see Sec. <span 
class="ecbx-1000">??</span>) is no longer needed for
applying the butterﬂy to diﬀerent decompositions and scales. For this
reason, we can compress this subband. As a result, after using the butterﬂy
to «««&#x003C; all the decompositions of the sequence and all the scales, all the
<!--l. 994--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands can be compressed, excepting the intra-coded image
of each GOP. Notice that the redundancy exploited in B-type
<!--l. 996--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands is temporal.
</p><!--l. 999--><p class="indent" >   A <!--l. 999--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
subband can be compressed by sorting its coeﬃcients by energy and predicting them.
Thus, the better the prediction the higher the compression ratio. To sort the coeﬃcients of
subband <!--l. 1002--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
by energy without using it (remember that the decoder does not know this
information), we can think that there is a correlation between the coeﬃcients of
<!--l. 1004--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math> and
<!--l. 1005--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>,
that is, the prediction error resulting of substracting to
<!--l. 1006--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> a
prediction <!--l. 1006--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̂</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>
generated with the same motion information used to built the prediction
<!--l. 1007--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̂</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>. Such
idea has been implemented in the following algorithm:
</p><!--l. 1010--><p class="indent" >
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-35001x11">Compute the prediction error for the
     <!--l. 1011--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
     subband <table class="equation"><tr><td> <a 
 id="x1-35002r6"></a>
                                                                  

                                                                  
     <!--l. 1012--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                     <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">−</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̂</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow>
</math></td><td class="eq-no">(6)</td></tr></table>
     <!--l. 1015--><p class="noindent" >where (see Eq. <a 
href="#x1-24003r3">3<!--tex4ht:ref: eq:weighted_prediction --></a>) </p><table class="equation"><tr><td> <a 
 id="x1-35003r7"></a>
     <!--l. 1016--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                             <mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̂</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mfrac><mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>b</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow> 
       <mrow 
><mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>a</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mi 
>c</mi></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></mfrac>        <mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(7)</td></tr></table>
     </li>
     <li 
  class="enumerate" id="x1-35004x11">Compute the 2D-DWT of subband
     <!--l. 1020--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> <table class="equation"><tr><td>
     <a 
 id="x1-35005r8"></a>
     <!--l. 1021--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                 <mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >DWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(8)</td></tr></table>
     </li>
     <li 
  class="enumerate" id="x1-35006x11">Find the indices for <!--l. 1025--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>
     that sorts it in descending order by energy <table class="equation"><tr><td> <a 
 id="x1-35007r9"></a>
                                                                  

                                                                  
     <!--l. 1026--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
        <mstyle 
class="text"><mtext  >indices</mtext></mstyle> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >unravel_index</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle 
class="text"><mtext  >argsort</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle 
class="text"><mtext  >abs</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">,</mo><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">.</mo><mstyle 
class="text"><mtext  >width</mtext></mstyle><mo 
class="MathClass-punc">,</mo><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">.</mo><mstyle 
class="text"><mtext  >height</mtext></mstyle></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(9)</td></tr></table>
     </li>
     <li 
  class="enumerate" id="x1-35009x1">Go over <!--l. 1035--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>
     sending the wavelet coeﬃcients of subbands
     <!--l. 1036--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>,
     <!--l. 1036--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math> and
     <!--l. 1036--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>
     in descending order by energy.
     </li>
     <li 
  class="enumerate" id="x1-35010x1"><!--l. 1051--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi> <mo 
class="MathClass-rel">&#x003E;</mo><mo 
class="MathClass-rel">&#x003E;</mo><mo 
class="MathClass-rel">=</mo> <mn>1</mn></math>.
     </li>
     <li 
  class="enumerate" id="x1-35011x1">Goto step 6.</li></ol>
<!--l. 1057--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">12   </span> <a 
 id="x1-3600012"></a>Encoding of I-type H-subbands</h3>
<!--l. 1060--><p class="noindent" >After a <!--l. 1060--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi></math>-levels MCDWT
transform of a sequence, <!--l. 1060--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>T</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>
temporal subbands are generated, and the temporal subband
<!--l. 1061--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>T</mi><mo 
class="MathClass-bin">+</mo><mn>1</mn></mrow></msup 
></math> has
a one I-type subband for each GOP (see Fig <a 
href="#x1-340017">7<!--tex4ht:ref: fig:MCDWT_decomposition --></a>). Notice that, in a I-type
image, the redundancy exploited to accumulate the visual information in the
<!--l. 1065--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
subband (or to remove the visual information in the
<!--l. 1065--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands) is spatial.
</p><!--l. 1068--><p class="indent" >   After using MCDWT, I-type images are decomposed into the four subbands
<!--l. 1069--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math> (low-frequencies),
<!--l. 1069--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>H</mi></math>,
<!--l. 1069--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><mi 
>L</mi></math> and
<!--l. 1069--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi><mi 
>H</mi></math>
(high-frequencies). Depending on the image content and wavelets used in the 2D-DWT,
<!--l. 1071--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands contain a certain
                                                                  

                                                                  
amount of <span 
class="ecti-1000">visual information</span><span class="footnote-mark"><a 
href="index8.html#fn7x0"><sup class="textsuperscript">7</sup></a></span><a 
 id="x1-36001f7"></a> .
The key here is to reduce as much as possible such visual information, leaving in the
<!--l. 1074--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math> subbands only
<span 
class="ecti-1000">visual noise</span><span class="footnote-mark"><a 
href="index9.html#fn8x0"><sup class="textsuperscript">8</sup></a></span><a 
 id="x1-36002f8"></a>  If we
achieve this, the <!--l. 1076--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands, expressed in a sign/magnitude representation will have two features: (1)
the probability of ﬁnding zeros when we are moving from the least signiﬁcant
bit-planes fo the most signiﬁcant ones of the magnitude of the coeﬃcients will
increase (to the point where from one bit-plane upwards, all the bits will be zero),
and (2) the correlation in the sign bit-plane will be zero. In this situation, an eﬃcient
encoding method is to compress the bit-planes, starting at the MSBP with at least
one bit to 1 (in other words, “send” the ones of the MSBP), sending before the
corresponding sign. If more than one one is found in the MSBP, the bits should be
processed by descending magnitude, i.e., sending ﬁrst those bits that corresponds
with coeﬃcients with a higher magnitude. This information can be extracted from
the <!--l. 1089--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
subband as below is shown.
</p><!--l. 1091--><p class="indent" >   Information in the <!--l. 1091--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
subband can be used to futher reduce the visual information of
<!--l. 1092--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands and to estimate the value of its high-frequency coeﬃcients, and therefore to
sort them (at least approximately) by their magnitude. The idea is to predict the
<!--l. 1094--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
coeﬃcients by introducing some (visual) information in the
<!--l. 1095--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> subband,
and to perform again the 2D-DWT (using the same wavelets). This generates a
<!--l. 1097--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi></math> subbands that
substracted to <!--l. 1097--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
should remove the visual information from them (decorrelating the signs and
reducing the number of bits necessary to represent most of the coeﬃcients). </p><table class="equation"><tr><td>
<a 
 id="x1-36003r10"></a>
                                                                  

                                                                  
<!--l. 1101--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                           <mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover> <mo 
class="MathClass-rel">=</mo> <mi 
>H</mi> <mo 
class="MathClass-bin">−</mo><mi 
>Ĥ</mi>
</math></td><td class="eq-no">(10)</td></tr></table>
<!--l. 1105--><p class="indent" >   <!--l. 1105--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></math>
is as a prediction error that basically should store noise. Therefore, if
<!--l. 1106--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></math>
is not transmitted at all, a good approximation of
<!--l. 1107--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
></math> should be
recontructed. However, in most of cases, some amount of (unpredictable) visual information
will remain in <!--l. 1109--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></math>,
concentrated in the MSBPs. The current representation of the rest
of BPs (with unpredictable bits) should be eﬃcient. Sumarizing,
<!--l. 1111--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></math> is a
triple subbands of spatially uncorrelated coeﬃcients, most of them small, with zeros
in the MSBPs and random bits in the LSBPs, and to progressively encode them, a
BP compressor can be used.
</p><!--l. 1116--><p class="indent" >   At this point, any BLIC (Bi-Level Image Compressor) should be applicable.
However, there is a dependencies between the BPs that using a BLIC that
cannot be exploited. The question is, could it be possible to predict the
coordinates of the ones in a BP? (by default the BPs are zero). If this
is possible, a sequence of bits (with so many bits as coeﬃcients are in
<!--l. 1121--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>)
can encode the success of such prediction. Suppose that
<!--l. 1122--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi> <mi 
>↓</mi></math> (the list of indexes
the sorts <!--l. 1123--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi></math> in
descending order by amplitude) determines the possible localization of the most energetic coeﬃcients
in <!--l. 1125--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover></math>. If so, the MSB of
the ﬁrst elements of <!--l. 1126--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Ĥ</mi> <mi 
>↓</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
(the list of residue coeﬃcients (approximately-) sorted by energy) will be 1
(with a high probability) and the rest will be 0 (with a high probability).
For example, if there are ﬁve 1&#x2019;s in the MSB of the beginning of
<!--l. 1130--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Ĥ</mi> <mi 
>↓</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> (that
is, a perfect prediction in which we can localize the position of the most energetic
coeﬃcients, but not its magnitude that is, if their MSB is 1 or 0), the complete BP can
be encoded with the symbols &#x003C;5&#x003E;&#x003C;0&#x003E; (ﬁve 1&#x2019;s localized in the ﬁrst ﬁve positions of
<!--l. 1134--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Ĥ</mi> <mi 
>↓</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>). If for example, the MSB
of the ﬁrst elements of <!--l. 1136--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Ĥ</mi> <mi 
>↓</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
are 0101001000110... (obviously this prediction is not perfect), then the output
symbols are &#x003C;0&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;&#x003C;2&#x003E;&#x003C;1&#x003E;&#x003C;3&#x003E;&#x003C;2&#x003E;&#x003C;0&#x003E;, which can be re-encoded as
&#x003C;0&#x003E;&#x003C;1,3&#x003E;&#x003C;2,1&#x003E;&#x003C;1,1&#x003E;&#x003C;3,1&#x003E;&#x003C;2,1&#x003E;,&#x003C;0&#x003E;.
</p><!--l. 1141--><p class="indent" >   The output of the last stage is a sequence of symbols with a exponiental
probability distribution that can be encoded eﬃciently with a variable-length code.
Or using DPCM?
                                                                  

                                                                  
</p><!--l. 1145--><p class="indent" >   The perfect prediction of the 2nd MSBP of
<!--l. 1146--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Ĥ</mi> <mi 
>↓</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> if
formed by the ﬁrst reﬁnements bits of those coeﬃentes that already are signiﬁcative,
and by the ﬁrst 1 of those coeﬃcients that start to being signiﬁcative in this 2nd
MSBP. Such perfect prediction has the structure 1.(5).10.(7).01.(10).10...0. We
can realize now that the ﬁrst two runs has a length equal to the number of
coeﬃcients signiﬁcative in the previous BP, so, we only need to encode the
ﬁrst run of 1&#x2019;s, generating the symbols &#x003C;5&#x003E;&#x003C;0&#x003E;&#x003C;10&#x003E;&#x003C;0&#x003E;. Let&#x2019;s suppose
an unperfect prediction like 1101100|0111100110101100001010...., and
that the number of signiﬁcant coeﬃcients is 7. In this case, the output is
&#x003C;2&#x003E;&#x003C;1&#x003E;&#x003C;2&#x003E;&#x003C;0&#x003E;&#x003C;0&#x003E;&#x003C;4&#x003E;&#x003C;2&#x003E;&#x003C;2&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;&#x003C;2&#x003E;&#x003C;4&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;&#x003C;0&#x003E;.
</p><!--l. 1158--><p class="indent" >   In the extreme case where the prediction is completely wrong, we are going to generate a
secuence of <!--l. 1159--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math>
bits 0101010101... which can be encoded as &#x003C;0&#x003E;&#x003C;1&#x003E;&#x003C;1&#x003E;...&#x003C;1&#x003E;
(<!--l. 1160--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>N</mi></math>
symbols), which can be re-encoded as &#x003C;0&#x003E;&#x003C;1,N-1&#x003E;.
</p><!--l. 1167--><p class="indent" >   The coeﬃcients of <!--l. 1167--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi></math>
sorted by their magnitude in descending order can be used to
send ﬁrst those bits that belong to the largest coeﬃcients of
<!--l. 1169--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>.
</p><!--l. 1171--><p class="indent" >   Obviously, the prediction </p><table class="equation"><tr><td> <a 
 id="x1-36004r11"></a>
<!--l. 1172--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                        <mstyle 
class="text"><mtext  >sort</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">=</mo><mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >sort</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Ĥ</mi></mrow><mo 
class="MathClass-close">)</mo></mrow>
</math></td><td class="eq-no">(11)</td></tr></table>
<!--l. 1175--><p class="indent" >   will not always be perfect. This can have two diﬀerent consequences: (1)
that
</p><!--l. 1177--><p class="indent" >   Introduced such ideas, to compress the
<!--l. 1177--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands of a 1-level 2D-DWT, the following algorithm can be used:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-36006x1">Compute <!--l. 1182--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>,
     zooming-in the <!--l. 1182--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math>
     subband. <table class="equation"><tr><td> <a 
 id="x1-36007r12"></a>
                                                                  

                                                                  
     <!--l. 1183--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                        <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mn>0</mn></mrow><mo 
class="MathClass-close">)</mo></mrow>
</math></td><td class="eq-no">(12)</td></tr></table>
     </li>
     <li 
  class="enumerate" id="x1-36009x2">Add to <!--l. 1187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math> some visual
     information <!--l. 1187--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>V</mi> </math> that could
     be present in original <!--l. 1188--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
></math>.
     Any edge enhancement algorithm should work. <table class="equation"><tr><td> <a 
 id="x1-36010r13"></a>
     <!--l. 1189--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                           <mrow ><mo 
class="MathClass-open">[</mo><mrow><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>L</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-bin">+</mo> <mi 
>V</mi>
</math></td><td class="eq-no">(13)</td></tr></table>
     </li>
     <li 
  class="enumerate" id="x1-36012x3">Compute the 2D-DWT of <!--l. 1193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">[</mo><mrow><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
     to obtain a prediction <!--l. 1193--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi></math>.
     <table class="equation"><tr><td> <a 
 id="x1-36013r14"></a>
     <!--l. 1194--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                       <mstyle 
class="text"><mtext  >_</mtext></mstyle><mo 
class="MathClass-punc">,</mo><mi 
>Ĥ</mi> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >DWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mrow ><mo 
class="MathClass-open">[</mo><mrow><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>′</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow>
</math></td><td class="eq-no">(14)</td></tr></table>
     <!--l. 1197--><p class="noindent" >Notice that <!--l. 1197--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >_</mtext></mstyle> <mo 
class="MathClass-rel">≈</mo> <mi 
>L</mi></math>.
                                                                  

                                                                  
     </p></li>
     <li 
  class="enumerate" id="x1-36015x4">Substract the prediction to the <!--l. 1199--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
     subbands. <table class="equation"><tr><td> <a 
 id="x1-36016r15"></a>
     <!--l. 1200--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                                          <mover 
accent="true"><mrow 
><mi 
>H</mi></mrow><mo 
class="MathClass-op">̃</mo></mover> <mo 
class="MathClass-rel">=</mo> <mi 
>H</mi> <mo 
class="MathClass-bin">−</mo><mi 
>Ĥ</mi>
</math></td><td class="eq-no">(15)</td></tr></table>
     </li>
     <li 
  class="enumerate" id="x1-36018x5">Sort <!--l. 1204--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi></math>
     by magnitude in descending order. For most images,
     <!--l. 1205--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi> <mo 
class="MathClass-rel">≈</mo> <mi 
>H</mi></math>
     and therefore, the most signiﬁcant coeﬃcients in both structures should be
     placed in the same coordinates. <table class="equation"><tr><td> <a 
 id="x1-36019r16"></a>
     <!--l. 1208--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <mi 
>Ĥ</mi> <mi 
>↓</mi><mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >unravel_index</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle 
class="text"><mtext  >argsort</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle 
class="text"><mtext  >abs</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>Ĥ</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow>
</math></td><td class="eq-no">(16)</td></tr></table>
     </li>
     <li 
  class="enumerate" id="x1-36021x6">Go over <!--l. 1212--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>Ĥ</mi> <mi 
>↓</mi></math>,
     sending by bit-planes the sign-magnitude representation of the coeﬃcients of
     <!--l. 1213--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>.
         <ol  class="enumerate2" >
         <li 
  class="enumerate" id="x1-36023x1">Estimate the nearest power of two, smaller or equal than the coeﬃcient of
         <!--l. 1218--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
         with the maximum amplitude. <table class="equation"><tr><td> <a 
 id="x1-36024r17"></a>
                                                                  

                                                                  
         <!--l. 1219--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
                          <msub><mrow 
><mi 
>λ</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
> <mo 
class="MathClass-rel">=</mo> <mi 
>λ</mi> <mo 
class="MathClass-rel">=</mo> <mn>1</mn> <mo 
class="MathClass-rel">&#x003C;</mo><mo 
class="MathClass-rel">&#x003C;</mo> <mstyle 
class="text"><mtext  >int</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mstyle 
class="text"><mtext  >abs</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>Ĥ</mi><mi 
>↓</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mn>0</mn></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-punc">.</mo>
</math></td><td class="eq-no">(17)</td></tr></table>
         <!--l. 1222--><p class="noindent" ><!--l. 1222--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi></math>
         should be the index of the MSBP in
         <!--l. 1222--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>.
         </p></li>
         <li 
  class="enumerate" id="x1-36026x2">Send the BP of index <!--l. 1224--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>λ</mi></math>.
         <table class="equation"><tr><td> <a 
 id="x1-36027r18"></a>
         <!--l. 1225--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="block" class="equation">
 <mtable  align="axis" style=""  
equalrows="false" columnlines="" equalcolumns="false" class="array"><mtr><mtd 
class="array"  columnalign="left">  <mstyle 
class="text"><mtext  >for </mtext></mstyle><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
><mstyle 
class="text"><mtext  > in</mtext></mstyle><mi 
>H</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>Ĥ</mi> <mi 
>↓</mi></mrow><mo 
class="MathClass-close">]</mo></mrow> <mo 
class="MathClass-punc">:</mo>                    </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mspace width="1em" class="nbsp" /><mi 
>i</mi><mi 
>f</mi><mi 
>λ</mi> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>i</mi><mi 
>n</mi><mi 
>t</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mo class="qopname">log</mo><!--nolimits--></mrow><mrow 
><mn>2</mn></mrow></msub 
><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>a</mi><mi 
>b</mi><mi 
>s</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow> <mo 
class="MathClass-rel">&#x003E;</mo> <mi 
>λ</mi><mo 
class="MathClass-bin">∕</mo><mn>2</mn> <mo 
class="MathClass-punc">:</mo> </mtd>
</mtr><mtr><mtd 
class="array"  columnalign="left">  <mspace width="1em" class="nbsp" /><mspace width="1em" class="nbsp" /><mi 
>s</mi><mi 
>e</mi><mi 
>n</mi><mi 
>d</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mi 
>i</mi><mi 
>g</mi><mi 
>n</mi><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>s</mi><mo 
class="MathClass-punc">,</mo><mi 
>x</mi><mo 
class="MathClass-punc">,</mo><mi 
>y</mi></mrow></msub 
></mrow><mo 
class="MathClass-close">)</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow>                         </mtd></mtr><mtr><mtd 
class="array"  columnalign="left">  <mspace width="1em" class="nbsp" /></mtd></mtr><!--l--></mtable>
</math></td><td class="eq-no">(18)</td></tr></table>
         </li></ol>
     </li></ol>
<a 
 id="Q1-1-53"></a>
    
</body> 
</html>
                                                                  


