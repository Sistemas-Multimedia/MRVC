<!DOCTYPE html> 
<html> 
<head> <title>Motion Compensated Discrete Wavelet Transform (MCDWT)</title> 
<meta charset="UTF-8" /> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)" /> 
<link rel="stylesheet" type="text/css" href="index.css" /> 
<script type="text/javascript" 
src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" 
></script> 
<style type="text/css"> 
.MathJax_MathML {text-indent: 0;} 
</style> 
</head><body 
>
   <div class="maketitle">
                                                                  

                                                                  
                                                                  

                                                                  

<h2 class="titleHead">Motion Compensated Discrete Wavelet
Transform (MCDWT)</h2>
 <div class="author" ><span 
class="ecrm-1200">Vicente Gonz</span><span 
class="ecrm-1200">á</span><span 
class="ecrm-1200">lez Ruiz</span></div><br />
<div class="date" ><span 
class="ecrm-1200">January 29, 2019</span></div>
   </div>
   <h3 class="likesectionHead"><a 
 id="x1-1000"></a>Contents</h3>
   <div class="tableofcontents">
   <span class="sectionToc" >1 <a 
href="#x1-20001" id="QQ2-1-2">Intro</a></span>
<br />   <span class="sectionToc" >2 <a 
href="#x1-30002" id="QQ2-1-3">Distrete Wavelet Transform (DWT)</a></span>
<br />    <span class="subsectionToc" >2.1 <a 
href="#x1-40002.1" id="QQ2-1-5">Scalability provided by DWT</a></span>
<br />    <span class="subsectionToc" >2.2 <a 
href="#x1-50002.2" id="QQ2-1-6">Example</a></span>
<br />   <span class="sectionToc" >3 <a 
href="#x1-60003" id="QQ2-1-7">Motion DWT (MDWT)</a></span>
<br />    <span class="subsectionToc" >3.1 <a 
href="#x1-70003.1" id="QQ2-1-10">Scalability provided by MDWT</a></span>
<br />    <span class="subsectionToc" >3.2 <a 
href="#x1-80003.2" id="QQ2-1-11">Example</a></span>
<br />   <span class="sectionToc" >4 <a 
href="#x1-90004" id="QQ2-1-12">Video transform alternatives</a></span>
<br />   <span class="sectionToc" >5 <a 
href="#x1-100005" id="QQ2-1-13">Motion Compensated Discrete Wavelet Transform (MCDWT)</a></span>
<br />    <span class="subsectionToc" >5.1 <a 
href="#x1-110005.1" id="QQ2-1-14">MCDWT butterﬂy</a></span>
<br />    <span class="subsectionToc" >5.2 <a 
href="#x1-120005.2" id="QQ2-1-17">MCDWT forward transform</a></span>
<br />    <span class="subsectionToc" >5.3 <a 
href="#x1-130005.3" id="QQ2-1-20">(Spatial) Multiresolution</a></span>
<br />    <span class="subsectionToc" >5.4 <a 
href="#x1-140005.4" id="QQ2-1-22">Scalability provided by MCDWT</a></span>
<br />    <span class="subsectionToc" >5.5 <a 
href="#x1-150005.5" id="QQ2-1-23">Example</a></span>
   </div>
<!--l. 13--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">1   </span> <a 
 id="x1-20001"></a>Intro</h3>
                                                                  

                                                                  
<!--l. 15--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Video" >Video</a> data contain high amounts of redundancy, spatial and temporal. For this
reason, most of video encoders compress the input sequece of <a 
href="https://en.wikipedia.org/wiki/Digital_image" >images</a> (which are
matrices of <a 
href="https://en.wikipedia.org/wiki/Pixel" >pixels</a>) basically in two stages: (1) a transform stage in the <a 
href="https://en.wikipedia.org/wiki/Time_domain" >time</a> and in
the <a 
href="https://www.quora.com/What-is-spatial-domain-in-image-processing" >spatial</a> domains that produces a collection of spatially <a 
href="https://en.wikipedia.org/wiki/Decorrelation" >uncorrelated</a> <a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >coeﬃcients</a>,
and (2) an <a 
href="https://en.wikipedia.org/wiki/Entropy_encoding" >entropy encoding</a> phase which removes the statistical redundancy that can
still remains after the decorrelation (transform). These coeﬃcients have two
interesting features:
     </p><ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-2002x1">Usually,  a   <a 
href="https://vicente-gonzalez-ruiz.github.io/symbol_compression/" ><span 
class="ecbx-1000">smaller  entropy</span></a> than  the  original  pixels.  This  helps  to
     increase the <a 
href="https://en.wikipedia.org/wiki/Data_compression_ratio" >compression ratio</a>.
     </li>
     <li 
  class="enumerate" id="x1-2004x2">The  transform  domain  provides  a  <a 
href="https://en.wikipedia.org/wiki/Image_resolution" ><span 
class="ecbx-1000">multiresolution</span></a>  <span 
class="ecbx-1000">representation</span>
     <span 
class="ecbx-1000">(spatial and temporal) </span>of the visual information (spatial <a 
href="http://inst.eecs.berkeley.edu/~ee290t/sp04/lectures/videowavelet_UCB1-3.pdf" >scalability</a>).</li></ol>
<!--l. 43--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">2   </span> <a 
 id="x1-30002"></a>Distrete Wavelet Transform (DWT)</h3>
<!--l. 44--><p class="noindent" ><a 
href="https://en.wikipedia.org/wiki/Discrete_wavelet_transform" >(2D-)DWT</a> is a digital transform that, applied to an image, performs spatial
decorrelation (2D) and obtains a <a 
href="https://vicente-gonzalez-ruiz.github.io/image_transformations_for_coding/index.html#x1-3500024" >multiresolution dyadic representation</a> of such image,
conforming a collection of DWT subbands. The forward transform converts the image
into a set of frequency subbands with coeﬃcients representing diﬀerent spatial areas
and frequency orientations. There is an equivalence between (DWT) subbands (a
<span 
class="ecti-1000">(subband) decomposition</span>) and <a 
href="http://fourier.eng.hmc.edu/e161/lectures/canny/node3.html" >Laplacian pyramids</a>, and it is quite simple to
<a 
href="https://vicente-gonzalez-ruiz.github.io/pyramids-and-wavelets/" >pass from a decomposition representation to a pyramid representation and
viceversa</a>.
</p><!--l. 59--><p class="indent" >   <a 
href="https://github.com/vicente-gonzalez-ruiz/MCDWT/blob/master/src/DWT.py" >DWT.py</a> implements the forward and backward (2D-)DWT for color images.
<!--l. 60--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi></math> and
<!--l. 61--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
stands for <span 
class="ecti-1000">low-pass ﬁltered </span>and <span 
class="ecti-1000">high-pass ﬁltered</span>, respectively. More information
about the implementation can be found at <a 
href="https://pywavelets.readthedocs.io/en/latest/index.html" >PyWavelets</a>.
</p>
   <!--l. 65--><div class="lstinputlisting">
<a 
 id="x1-3001r1"></a>
<a 
 id="x1-3002"></a>
<br /> <div class="caption" 
><span class="id">Listing 1: </span><span  
class="content">DWT.py</span></div><!--tex4ht:label?: x1-3001r2 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3003r1"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">numpy</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">as</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3004r2"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3005r3"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3006r4"></a></span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">sys</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3007r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3008r6"></a></span><span 
class="ectt-1000">sys</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">path</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">insert</span><span 
class="ectt-1000">(0,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">..</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3009r7"></a></span><span 
class="ectt-1000">from</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">src</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">IO</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3010r8"></a></span><span 
class="ectt-1000">from</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">src</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">IO</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">import</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3011r9"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3012r10"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3013r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3014r12"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3015r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3016r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3017r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3018r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3019r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3020r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">]</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3021r19"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3022r20"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3023r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3024r22"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3025r23"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3026r24"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">V</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3027r25"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">or</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3028r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">r</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3029r27"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">r</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3030r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">R</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3031r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000">G</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3032r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ecit-1000">B</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3033r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+---------------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3034r32"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3035r33"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3036r34"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3037r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3038r36"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3039r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">L</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">L</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">low</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subband</span><span 
class="ecit-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3040r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">H</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">high</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">frequencies</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3041r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">subbands</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">is</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">tuple</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000">),</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">where</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">are</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3042r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">with</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3043r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3044r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3045r43"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3046r44"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Y</span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3047r45"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">y</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HL</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3048r46"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000">U</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3049r47"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3050r48"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3051r49"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">LH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">HH</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|-+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3052r50"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">R</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3053r51"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000">G</span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3054r52"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ecit-1000">B</span><span 
class="ecit-1000">|</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3055r53"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">+-------+-------+</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3056r54"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3057r55"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3058r56"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3059r57"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">y</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3060r58"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">math</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ceil</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]/2)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3061r59"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3062r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3063r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3064r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">y</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3065r63"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3066r64"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3067r65"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(3):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3068r66"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt2</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">db5</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3069r67"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">if</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__debug__</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3070r68"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3071r69"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3072r70"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3073r71"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">print</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">::</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">max</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">␣</span><span 
class="ectt-1000">min</span><span 
class="ectt-1000">={}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amax</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">amin</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3074r72"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3075r73"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3076r74"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3077r75"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3078r76"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3079r77"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">color</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3080r78"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3081r79"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3082r80"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3083r81"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3084r82"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3085r83"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3086r84"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3087r85"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3088r86"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3089r87"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">an</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inversely</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">see</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transform</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3090r88"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3091r89"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3092r90"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3093r91"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][0]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3094r92"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3095r93"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">[1][2]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3096r94"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">ndarray</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[0]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">[1]*2,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">3),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3097r95"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">c</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(3):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3098r96"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">]</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pywt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">idwt2</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">LL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">LH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HL</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">],</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">HH</span><span 
class="ectt-1000">[:,:,</span><span 
class="ectt-1000">c</span><span 
class="ectt-1000">])),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">db5</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">mode</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">per</span><span 
class="ectt-1000">&#x2019;</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-3099r97"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span>
   
   </div>
<!--l. 67--><p class="indent" >   The multilevel DWT is a recursive use of the (1-level) DWT applied to the
<!--l. 68--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math> subband. For example, if
the DWT is applied <!--l. 68--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi></math>-times
to the <!--l. 69--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><mi 
>L</mi></math> subband, recursively,
                                                                  

                                                                  
a decomposition of <!--l. 69--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>k</mi> <mo 
class="MathClass-bin">+</mo> <mn>1</mn></math>-levels
is generated. For the sake of simplicity, we will denote the subbands
<!--l. 70--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>L</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
><mo 
class="MathClass-punc">,</mo><mi 
>H</mi><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></mrow><mo 
class="MathClass-close">}</mo></mrow></math> as only
<!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>, and
<!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>L</mi><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math> as
only <!--l. 71--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mi 
>k</mi></mrow></msup 
></math>.
</p><!--l. 73--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.1   </span> <a 
 id="x1-40002.1"></a>Scalability provided by DWT</h4>
<!--l. 74--><p class="noindent" >Depending on the number of subbands levels (pyramid levels in the
pyramid representation) that we use, we can reconstruct a image
at diﬀerent spatial scales (resolutions). For example, if an image
<!--l. 76--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
></math> has
been transformed using the DWT of 2 levels, we get: </p>
     <ul class="itemize1">
     <li class="itemize">Subband <!--l. 78--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></math>
     with the scale 2.
     </li>
     <li class="itemize">Subband <!--l. 79--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>1</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>S</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>H</mi></mrow><mrow 
><mn>2</mn></mrow></msup 
></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     (“iDWT” = “inverse DWT” = “backward DWT”) with the scale 1.
     </li>
     <li class="itemize"><!--l. 81--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><msup><mrow 
><mi 
>L</mi></mrow><mrow 
><mn>0</mn></mrow></msup 
> <mo 
class="MathClass-rel">=</mo> <mstyle 
class="text"><mtext  >iDWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>1</mn></mrow></msub 
><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">)</mo></mrow></math>
     (the original image) with the scale 0.</li></ul>
<!--l. 84--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">2.2   </span> <a 
 id="x1-50002.2"></a>Example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-1">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br /># 2D 1-levels forward DWT of the first image of the &#x2019;stockholm&#x2019; sequence:
 <br />./DWT.py -i ../sequences/stockholm/000 -d /tmp/000
 <br />
 <br /># Visualize the subbands:
 <br />display -normalize /tmp/000_LL # &#x003C;- LL1
 <br />display -normalize /tmp/000_LH # &#x003C;- LH1
 <br />display -normalize /tmp/000_HL # &#x003C;- HL1
 <br />display -normalize /tmp/000_HH # &#x003C;- HH1
 <br />
 <br /># 2D 1-levels forward DWT of the LL subband:
 <br />./DWT.py -i /tmp/000_LL
 <br />-d /tmp/000_LL
 <br />
 <br /># Visualize the subbands:
 <br />display -normalize /tmp/000_LL_LL # &#x003C;- LL2
 <br />display -normalize /tmp/000_LL_LH # &#x003C;- LH2
 <br />display -normalize /tmp/000_LL_HL # &#x003C;- HL2
 <br />display -normalize /tmp/000_LL_HH # &#x003C;- HH2
 <br />
 <br /># The result of the 2D 2-levels forward DWT are the subbands: LL2,
 <br /># LH2, HL2, HH2, LH1, HL1, HH1
 <br />
 <br /># The scale 2 of the image is represented by LL2.
 <br />
 <br /># The scale 1 can be reconstructed using the 2D 1-levels backward DWT
 <br /># on the 000_LL_{LL, LH, HL, HH} subbands:
 <br />./DWT.py -b -d /tmp/000_LL -i /tmp/scale1 &#x0026;&#x0026; display -normalize /tmp/scale1
 <br />
 <br /># The reconstruction &#x2019;/tmp/scale1&#x2019; and the original scale 1
 <br /># &#x2019;/tmp/000_LL&#x2019; have the same resolution:
 <br />file /tmp/scale1 /tmp/000_LL
 <br />
 <br /># Floating-point arithmetic of DWT introduces minimal distortions:
 <br />cmp /tmp/scale1 /tmp/000_LL
 <br />
 <br /># Basically, distortion is white noise:
 <br />../tools/show_differences.sh -1 /tmp/scale1 -2 /tmp/000_LL -o /tmp/diffs.png
 <br />display -normalize /tmp/diffs.png
 <br />
 <br /># The scale 0 is recovered using again the inverse transform:
                                                                  

                                                                  
 <br />cp /tmp/scale1 /tmp/000_LL
 <br />./DWT.py -b -d /tmp/000 -i /tmp/scale0 &#x0026;&#x0026; display -normalize /tmp/scale0
</div>
<!--l. 130--><p class="nopar" >
</p><!--l. 132--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">3   </span> <a 
 id="x1-60003"></a>Motion DWT (MDWT)</h3>
<!--l. 133--><p class="noindent" >DWT can be applied to a sequence of images by simply transforming each image of
the sequence independently. This is done, for example, in the <a 
href="https://en.wikipedia.org/wiki/JPEG_2000" >motion JPEG2000
video compression standard</a>. Notice that only the spatial redundancy is exploited. All
the temporal redundancy still remains in the video.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-60011"></a><a 
 id="x1-6002r2"></a>
                                                                  

                                                                  
<!--l. 141--><p class="noindent" > <div style="text-align:center;"> <img width=800 src="graphics/forward_MDWT.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 1: </span><span  
class="content">Forward MDWT step.</span></div><!--tex4ht:label?: x1-60011 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 145--><div class="lstinputlisting">
<a 
 id="x1-6003"></a>
<br /> <div class="caption" 
><span class="id">Listing 2: </span><span  
class="content">MDWT.py</span></div><!--tex4ht:label?: x1-6002r3 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6004r1"></a></span><span 
class="ectt-1000">class</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">MDWT</span><span 
class="ectt-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6005r2"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6006r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6007r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6008r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6009r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6010r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6011r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6012r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6013r10"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6014r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6015r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6016r13"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6017r14"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6018r15"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6019r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6020r17"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6021r18"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6022r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">).</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6023r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6024r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6025r22"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6026r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6027r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6029r26"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6030r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6031r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">iteration</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6032r29"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6033r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">inverse</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">each</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6034r31"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6035r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6036r33"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6037r34"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6038r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">transformed</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6039r36"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6040r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6041r38"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6042r39"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6043r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6044r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6045r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6046r43"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6047r44"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6048r45"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6049r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">img</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">pyr</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-6050r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">image</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">img</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">))</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">3.1   </span> <a 
 id="x1-70003.1"></a>Scalability provided by MDWT</h4>
<!--l. 148--><p class="noindent" >MDWT sequences (of (subband) decompositions) are scalable in space and in time.
Spatial scalability is a direct consequence of DWT. On the other hand, it is trivial to
observe that MDWT provides <span 
class="ecti-1000">fully </span>temporal scalability (we can access to the
images randomly) because each image of the input sequence is transformed
independently.
</p><!--l. 154--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">3.2   </span> <a 
 id="x1-80003.2"></a>Example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-2">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br /># Motion 2D 1-levels forward DWT of the &#x2019;stockholm&#x2019; sequence:
 <br />python -O ./MDWT.py -i ../sequences/stockholm/ -d /tmp/stockholm_
 <br />
 <br /># Visualize the subbands:
 <br />rm /tmp/*.png
 <br />for i in /tmp/stockholm_00?_LL; do convert -normalize $i $i.png; done
 <br />animate /tmp/*.png
 <br />rm /tmp/*.png
 <br />for i in /tmp/stockholm_00?_LH; do convert -normalize $i $i.png; done
 <br />animate /tmp/*.png
 <br />rm /tmp/*.png
 <br />for i in /tmp/stockholm_00?_HL; do convert -normalize $i $i.png; done
 <br />animate /tmp/*.png
 <br />rm /tmp/*.png
 <br />for i in /tmp/stockholm_00?_HH; do convert -normalize $i $i.png; done
 <br />animate /tmp/*.png
 <br />
 <br /># Motion 2D 1-levels backward DWT:
 <br />python -O MDWT.py -b -i /tmp/recons_ -d /tmp/stockholm_
 <br />
 <br /># Visualization of the reconstruction:
 <br />rm -f /tmp/*.png; for i in /tmp/recons_*; do convert -normalize $i $i.png; done; animate /tmp/*.png
</div>
<!--l. 180--><p class="nopar" >
</p><!--l. 182--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">4   </span> <a 
 id="x1-90004"></a>Video transform alternatives</h3>
<!--l. 183--><p class="noindent" >To remove both, spatial and temporal redundancies, two diﬀerent alternatives
are available: (1) t+2D transforms and (2) 2D+t transforms. In a t+2D
transform, the video is ﬁrst <a 
href="https://en.wikipedia.org/wiki/Digital_filter#Analysis_techniques" >analyzed</a> (transformed) over the time domain and
next, over the space domain. A 2D+t transform does just the opposite. Each
choice has a number of <span 
class="ecti-1000">pros </span>and <span 
class="ecti-1000">cons</span>. For example, in a t+2D transform we
can apply directly any image predictor based on <a 
href="https://en.wikipedia.org/wiki/Motion_estimation" >motion estimation</a> because
the input is a normal video. However, if we implement a 2D+t transform,
the input to the motion estimator is a sequence decompositions. <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >The
overwhelming majority of DWT&#x2019;s</a> are not <a 
href="http://www.polyvalens.com/blog/wavelets/theory" >shift invariant</a>, which basically means
<!--l. 198--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mstyle 
class="text"><mtext  >DWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow><mo 
class="MathClass-rel">≠</mo><mstyle 
class="text"><mtext  >DWT</mtext></mstyle><mrow ><mo 
class="MathClass-open">(</mo><mrow><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi> <mo 
class="MathClass-bin">+</mo> <mi 
>x</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></mrow><mo 
class="MathClass-close">)</mo></mrow></math>, where
<!--l. 199--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>x</mi></math> is a
                                                                  

                                                                  
displacement of <!--l. 199--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>s</mi><mrow ><mo 
class="MathClass-open">[</mo><mrow><mi 
>t</mi></mrow><mo 
class="MathClass-close">]</mo></mrow></math>
along one of the signal domains. Therefore, motion estimators which compare pixel
values will not work on the (subband) decomposition domain. On the other hand, if
we want to provide true spatial scalability (processing only those <a 
href="https://www.tutorialspoint.com/dip/spatial_resolution.htm" >spatial resolutions</a>
(scales) necessary to get a spatially scaled of our video), a t+2D transformed video
presents some drawbacks:
</p>
     <ul class="itemize1">
     <li class="itemize">In order to implement a lossless system, the t stage must be carried out
     at full (scale 0) resolution.
     </li>
     <li class="itemize">We can restrict the perfect reconstruction only to the scale 0 case, but
     in this case, a spatial resolution representation of the motion information
     should be available at the decoder. This can be done, but in general,
     scalabilitity decreases the compression ratio (on the motion data in this
     case).
     </li>
     <li class="itemize">We can use the full (scale 0) resolution version of the motion information
     for reconstructing all the scales of the texture (interpolating it for all
     those scales greater that 0), but in this case the memory and computing
     requirements at the decoders will increase. Therefore, depending on the
     resolution of the scale 0 and the computational resources, this could be
     aﬀordable or not.
     </li>
     <li class="itemize">As an alternative to this last problem, we can decrease the accuracy of the
     motion information in order to make it suitable for the spatial resolution.
     However, this will increase the distortion of the reconstruction compared
     to the previous solution.</li></ul>
<!--l. 228--><p class="indent" >   Finally, it is important to realize that the presence of the motion data in the
code-stream introduces also complexity into the decoding process because, in a
quality scalable scenario, it is not trivial (specially when non-linear systems such as
those based on ME are involved) to decide how to interleave the motion and
the texture information in a code-stream that can be decoded following
diﬀerent orders, depending on the type of used scalability and the avaliable
bandwidth.
</p><!--l. 237--><p class="noindent" >
</p>
   <h3 class="sectionHead"><span class="titlemark">5   </span> <a 
 id="x1-100005"></a>Motion Compensated Discrete Wavelet Transform (MCDWT)</h3>
                                                                  

                                                                  
<!--l. 238--><p class="noindent" >MCDWT is a 2D+t transform. The 2D stage is MDWT. The t stage is a
1D-DWT, which removes the temporal redundancy between adjacent
<!--l. 239--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands by means of <a 
href="https://en.wikipedia.org/wiki/Motion_compensation" >Motion Compensation (MC)</a>. A special characteristic of
MCDWT is that the motion information is not transmitted from the <a 
href="https://en.wikipedia.org/wiki/Encoder" >encoder</a> to the
<a 
href="https://en.wikipedia.org/wiki/Decoder" >decoder</a>. This is possible because to estimate de motion at the encoder, only the
information that it is accesible by the decoder is used.
</p><!--l. 249--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.1   </span> <a 
 id="x1-110005.1"></a>MCDWT butterﬂy</h4>
<!--l. 251--><p class="noindent" >MCDWT butterly inputs three decompositions
<!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>,
<!--l. 251--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> and
<!--l. 252--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>, and outputs a
residue subband <!--l. 253--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>,
which replaces to <!--l. 253--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></math>
in the original <!--l. 253--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math>
decomposition. So, after the use of the buﬀerﬂy, we get
<!--l. 254--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>a</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> (an <a 
href="https://en.wikipedia.org/wiki/Video_compression_picture_types" >intra-coded “I”
image</a>), <!--l. 257--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mover 
accent="true"><mrow 
><mi 
>b</mi></mrow><mo 
class="MathClass-op">̃</mo></mover><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math> (a <a 
href="https://en.wikipedia.org/wiki/Video_compression_picture_types" >bidirectionally
predicted “B” image</a>) and <!--l. 259--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi> <mo 
class="MathClass-rel">=</mo> <mrow ><mo 
class="MathClass-open">{</mo><mrow><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi><mo 
class="MathClass-punc">,</mo><mi 
>c</mi><mo 
class="MathClass-punc">.</mo><mi 
>H</mi></mrow><mo 
class="MathClass-close">}</mo></mrow></math>
(another intra-coded “I” image). This replacement is fully reversible because the
forward transform will use only the information that the backward transform
has access to. Notice that the <a 
href="http://www.vtvt.ece.vt.edu/research/references/video/DCT_Video_Compression/Zhang92a.pdf" >pyramid domain</a> (which is invariant to the
pixels displacements) has been used to estimate and compensate the
<!--l. 265--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>
subbands.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-110012"></a><a 
 id="x1-11002r3"></a>
                                                                  

                                                                  
<!--l. 269--><p class="noindent" > <div style="text-align:center;"> <img width=1200 src="graphics/forward_butterfly.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 2: </span><span  
class="content">Forward MCDWT butterﬂy.</span></div><!--tex4ht:label?: x1-110012 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 272--><div class="lstinputlisting">
<a 
 id="x1-11003"></a>
<br /> <div class="caption" 
><span class="id">Listing 3: </span><span  
class="content">MCDWT.py (extract)</span></div><!--tex4ht:label?: x1-11002r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11004r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__init__</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11005r2"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zeros</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">shape</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">np</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">float64</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11006r3"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11007r4"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">DWT</span><span 
class="ectt-1000">()</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11008r5"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11009r6"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11010r7"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">forward</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">butterfly</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11011r8"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11012r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Input</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11013r10"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11014r11"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11015r12"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">aH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">bH</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cL</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">cH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11016r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">c</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11017r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11018r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Output</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11019r16"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11020r17"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11021r18"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue_bH</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">array</span><span 
class="ecit-1000">[</span><span 
class="ecit-1000">y</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">x</span><span 
class="ecit-1000">,</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">component</span><span 
class="ecit-1000">],</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">base</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decomposition</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11022r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">residue</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">fot</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">image</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">b</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11023r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11024r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11025r22"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11026r23"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11027r24"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11028r25"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11029r26"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11030r27"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11031r28"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11032r29"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11033r30"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11034r31"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">/</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11035r32"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">-</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11036r33"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11037r34"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">[1]</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11038r35"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11039r36"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11040r37"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11041r38"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11042r39"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_H</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11043r40"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11044r41"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_bH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11045r42"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">zero_L</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11046r43"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">AL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">AH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11047r44"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">generate_prediction</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">CL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">CH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11048r45"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BHA</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BHC</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">/</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11049r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">residue_BH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">prediction_BH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11050r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">dwt</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">BH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-11051r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">return</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">[1]</span>
   
   </div>
<!--l. 274--><p class="indent" >   Notice that, even if <!--l. 274--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 274--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
(at full resolution) are available at the decoder, only
<!--l. 275--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> is.
So, it does not make sense to search the low resolution structures of
<!--l. 276--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math> in the high
resolution images <!--l. 276--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>
and <!--l. 277--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>,
because even if a perfect match is achieved (think about the three decompositions
<!--l. 278--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>a</mi></math>,
<!--l. 278--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi></math> and
<!--l. 278--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>c</mi></math>
are identical), the prediction error would be diﬀerent than
<!--l. 279--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mn>0</mn></math>
as a consequence of that the high resolution information is missing in
<!--l. 280--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>b</mi><mo 
class="MathClass-punc">.</mo><mi 
>L</mi></math>.
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.2   </span> <a 
 id="x1-120005.2"></a>MCDWT forward transform</h4>
<!--l. 284--><p class="noindent" >The MCDWT forward transform is the result of appliying the MCDWT butterﬂy to
the full input sequence of decompositions with diﬀerent distances between them.
As a result, except for the ﬁrst and the last image of the sequence, all the
<!--l. 287--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><mi 
>H</mi></math>-subbands
are temporally decorrelated.
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-120013"></a><a 
 id="x1-12002r4"></a>
                                                                  

                                                                  
<!--l. 292--><p class="noindent" > <div style="text-align:center;"> <img width=1200 src="graphics/temporal_decorrelation.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 3: </span><span  
class="content">MCDWT forward transform.</span></div><!--tex4ht:label?: x1-120013 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <!--l. 295--><div class="lstinputlisting">
<a 
 id="x1-12003"></a>
<br /> <div class="caption" 
><span class="id">Listing 4: </span><span  
class="content">MCDWT.py (extract)</span></div><!--tex4ht:label?: x1-12002r5 --><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12004r1"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">forward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">mc_stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">=2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12005r2"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ecit-1000">A</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Motion</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compensated</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Discrete</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Wavelet</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Transform</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12006r3"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12007r4"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Compute</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000">D</span><span 
class="ecit-1000">-</span><span 
class="ecit-1000">DWT</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">The</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">video</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">sequence</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12008r5"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">must</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">stored</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">disk</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">and</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">as</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">a</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12009r6"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1-</span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MC</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">)</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">will</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">be</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">stored</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">in</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12010r7"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12011r8"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Imput</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12012r9"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-----</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12013r10"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12014r11"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">s</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12015r12"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12016r13"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Localization</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">input</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Example</span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;/</span><span 
class="ecit-1000">tmp</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">stockholm_</span><span 
class="ecit-1000">&#x0022;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12017r14"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12018r15"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">N</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12019r16"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12020r17"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">images</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">to</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">process</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12021r18"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12022r19"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">T</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">int</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12023r20"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12024r21"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Number</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">levels</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">MCDWT</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">(</span><span 
class="ecit-1000">temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scales</span><span 
class="ecit-1000">).</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Controls</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12025r22"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">GOP</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">size</span><span 
class="ecit-1000">.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12026r23"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12027r24"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">T</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">GOP_size</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12028r25"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">----+-----------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12029r26"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">0</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12030r27"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">1</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12031r28"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">2</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">4</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12032r29"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">3</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">8</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12033r30"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">4</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">16</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12034r31"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">5</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">32</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12035r32"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">|</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12036r33"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12037r34"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Returns</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12038r35"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">-------</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12039r36"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12040r37"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">prefix</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">:</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">S</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12041r38"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12042r39"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Localization</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">of</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">the</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">output</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">decompositions</span><span 
class="ecit-1000">.</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">For</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">example</span><span 
class="ecit-1000">:</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12043r40"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x0022;/</span><span 
class="ecit-1000">tmp</span><span 
class="ecit-1000">/</span><span 
class="ecit-1000">mc_stockholm_</span><span 
class="ecit-1000">&#x0022;.</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12044r41"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12045r42"></a></span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">&#x2019;&#x2019;&#x2019;</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12046r43"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12047r44"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">t</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12048r45"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12049r46"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12050r47"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12051r48"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">while</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12052r49"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12053r50"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12054r51"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">__forward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12055r52"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12056r53"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12057r54"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12058r55"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">+=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">1</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12059r56"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">*=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12060r57"></a></span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12061r58"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">def</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">backward</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">mc_stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">=</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">tmp</span><span 
class="ectt-1000">/</span><span 
class="ectt-1000">stockholm_</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">=5,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">=2):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12062r59"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">2**</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12063r60"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">for</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">t</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">in</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">range</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">T</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><span 
class="ecit-1000">#</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">Temporal</span><span 
class="ecit-1000"> </span><span 
class="ecit-1000">scale</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12064r61"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12065r62"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12066r63"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">0))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12067r64"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">while</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">i</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x003C;</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">N</span><span 
class="ectt-1000">//</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">):</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12068r65"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12069r66"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">read</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">S</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12070r67"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">self</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">__backward_butterfly</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">)</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12071r68"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">bL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">bH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">//2))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12072r69"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">decomposition</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">write</span><span 
class="ectt-1000">((</span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span><span 
class="ectt-1000">),</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">{}{:03</span><span 
class="ectt-1000">d</span><span 
class="ectt-1000">}</span><span 
class="ectt-1000">&#x0022;</span><span 
class="ectt-1000">.</span><span 
class="ectt-1000">format</span><span 
class="ectt-1000">(</span><span 
class="ectt-1000">s</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">*</span><span 
class="ectt-1000">i</span><span 
class="ectt-1000">+</span><span 
class="ectt-1000">x</span><span 
class="ectt-1000">))</span><span 
class="ectt-1000"> </span><br /><span class="label"><a 
 id="x1-12073r70"></a></span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">aH</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">=</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cL</span><span 
class="ectt-1000">,</span><span 
class="ectt-1000"> </span><span 
class="ectt-1000">cH</span>
   
   </div>
   <h4 class="subsectionHead"><span class="titlemark">5.3   </span> <a 
 id="x1-130005.3"></a>(Spatial) Multiresolution</h4>
<!--l. 299--><p class="noindent" >Spatial dyadic multiresolution can be obtained by appliying a sequence of
MDWT+MCDWT steps (see Fig. <a 
href="#x1-130014">4<!--tex4ht:ref: fig:multiresolution --></a>).
</p>
   <hr class="figure" /><div class="figure" 
>
                                                                  

                                                                  
<a 
 id="x1-130014"></a>
                                                                  

                                                                  
<!--l. 303--><p class="noindent" > <div style="text-align:center;"> <img width=1200 src="graphics/multiresolution.svg" /> </div> 
<br /> </p><div class="caption" 
><span class="id">Figure 4:  </span><span  
class="content">MDWT+MCDWT  multiresolution  procedure.  The  input  to  the
second iteration of the MDWT+MCDWT transform is the output of a previous
(ﬁrst)  iteration  MDWT+MCDWT  transform.  The  second  iteration  is  only
applied to the scale 1.</span></div><!--tex4ht:label?: x1-130014 -->
                                                                  

                                                                  
   </div><hr class="endfigure" />
   <h4 class="subsectionHead"><span class="titlemark">5.4   </span> <a 
 id="x1-140005.4"></a>Scalability provided by MCDWT</h4>
<!--l. 312--><p class="noindent" >The decomposition generated by the MCDWT is identical to MDWT. Therefore,
MCDWT provides the same spatial scalability than MDWT. In order to obtain
several spatial resolutions, MCDWT should be applied to the low-frequency
subbands, recursively. As an example, in the Figure <a 
href="#x1-130014">4<!--tex4ht:ref: fig:multiresolution --></a>, MCDWT has been applied to
the output of the example of the Figure <a 
href="#x1-120013">3<!--tex4ht:ref: fig:forward_MCDWT --></a>. Notice that between two consecutive
iterations of MCDWT, MDWT must be applied to the low-frequency subband in
order to reduce the resolution of the analysis.
</p><!--l. 322--><p class="indent" >   On the other hand, MCDWT decreases the temporal scalability oﬀered
by MDWT to allowing only dyadic access (depending on required image
and the number of MCDWT levels, more than one decomposition needs to
be inversely transformed). For example, if only one step of the backward
transform is applied to the example of the Figure <a 
href="#x1-120013">3<!--tex4ht:ref: fig:forward_MCDWT --></a>, only the decompositions of
<!--l. 327--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>0</mn></mrow></msub 
></math>,
<!--l. 328--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>2</mn></mrow></msub 
></math> and
<!--l. 328--><math 
 xmlns="http://www.w3.org/1998/Math/MathML"  
display="inline" ><msub><mrow 
><mi 
>s</mi></mrow><mrow 
><mn>4</mn></mrow></msub 
></math> will
be reconstructed (the second <a 
href="https://en.wikipedia.org/wiki/Temporal_resolution" >temporal resolution</a>). If a second iteration of the
backward transform is used, all the decompositions are rendered.
</p><!--l. 333--><p class="noindent" >
</p>
   <h4 class="subsectionHead"><span class="titlemark">5.5   </span> <a 
 id="x1-150005.5"></a>Example</h4>
                                                                  

                                                                  
   <div class="verbatim" id="verbatim-3">
# You must be in the &#x2019;src&#x2019; directory.
 <br />
 <br /># Motion 2D 1-levels forward DWT of the &#x2019;stockholm&#x2019; sequence:
 <br />python -O ./MDWT.py -i ../sequences/stockholm/ -d /tmp/stockholm_
 <br />
 <br /># Motion Compensated 1D 1-levels forward DWT:
 <br />python -O MCDWT.py -d /tmp/stockholm_ -m /tmp/mc_stockholm_
 <br />
 <br /># First and last decompositions are not transformed by MCDWT:
 <br />ls -l /tmp/stockholm_000_HH /tmp/mc_stockholm_000_HH
 <br />ls -l /tmp/stockholm_004_HL /tmp/mc_stockholm_004_HL
 <br />
 <br /># The rest, are transformed:
 <br />ls -l /tmp/stockholm_001_LH /tmp/mc_stockholm_001_LH
 <br />ls -l /tmp/stockholm_002_HL /tmp/mc_stockholm_002_HL
 <br />ls -l /tmp/stockholm_003_HH /tmp/mc_stockholm_003_HH
 <br />
 <br /># Showing statistics:
 <br />python ../tools/show_statistics.py -i /tmp/stockholm_001_LH
 <br />python ../tools/show_statistics.py -i /tmp/mc_stockholm_001_LH
 <br />python ../tools/show_statistics.py -i /tmp/stockholm_001_HL
 <br />python ../tools/show_statistics.py -i /tmp/mc_stockholm_001_HL
 <br />python ../tools/show_statistics.py -i /tmp/stockholm_001_HH
 <br />python ../tools/show_statistics.py -i /tmp/mc_stockholm_001_HH
 <br />
 <br /># Visualization of the H-subbands
 <br />rm -f /tmp/*.png; for i in /tmp/mc_stockholm_00?_LH; do convert -normalize $i $i.png; done; animate /tmp/*.png
 <br />rm -f /tmp/*.png; for i in /tmp/mc_stockholm_00?_HL; do convert -normalize $i $i.png; done; animate /tmp/*.png
 <br />rm -f /tmp/*.png; for i in /tmp/mc_stockholm_00?_HH; do convert -normalize $i $i.png; done; animate /tmp/*.png
 <br />
 <br /># Motion Compensated 1D 1-levels backward DWT:
 <br />python -O ./MCDWT.py -b -m /tmp/mc_stockholm_ -d /tmp/recons_MCDWT_
 <br />
 <br /># Motion 2D 1-levels backward DWT:
 <br />python -O ./MDWT.py -b -d /tmp/recons_MCDWT_ -i /tmp/recons_MDWT_
 <br />
 <br /># Visualization of the reconstruction:
 <br />rm -f /tmp/*.png; for i in /tmp/recons_MDWT_*; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/recons_MDWT_*.png
 <br />
 <br /># Visualize the original sequence:
 <br />rm -f /tmp/stockholm/*.png; cp -r ../sequences/stockholm /tmp; for i in /tmp/stockholm/*; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/stockholm/*.png
 <br />
                                                                  

                                                                  
 <br /># Let&#x2019;s clear the motion compensated subbands and reconstruct the sequence ...
 <br />
 <br /># Create a zero subband:
 <br />bash ../tools/create_black_image.sh; python ../tools/add_offset.py -i /tmp/zero.png -o /tmp/zero16.png -f 32768
 <br />python ../tools/show_statistics.py -i /tmp/zero16.png
 <br />
 <br /># &#x0022;Delete&#x0022; the motion compensated subbands:
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_001_LH
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_001_HL
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_001_HH
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_002_LH
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_002_HL
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_002_HH
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_003_LH
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_003_HL
 <br />cp /tmp/zero16.png /tmp/mc_stockholm_003_HH
 <br />
 <br /># Motion Compensated 1D 1-levels backward DWT:
 <br />python -O ./MCDWT.py -b -m /tmp/mc_stockholm_ -d /tmp/recons2_MCDWT_
 <br />
 <br /># Motion 2D 1-levels backward DWT:
 <br />python -O ./MDWT.py -b -d /tmp/recons2_MCDWT_ -i /tmp/recons2_MDWT_
 <br />
 <br /># Visualization of the reconstruction:
 <br />rm -f tmp/recons2_MDWT_*.png; for i in /tmp/recons2_MDWT_*; do python ../tools/substract_offset.py -i $i -o $i.png; done; animate /tmp/recons2_MDWT_*.png
 <br />
 <br /># Visualization of the differences:
 <br />rm -f /tmp/diff*.png; for i in {0..4}; do ii=$(printf &#x0022;%03d&#x0022; $i); bash ../tools/show_differences.sh -1 /tmp/recons_MDWT_$ii -2 /tmp/recons2_MDWT_$ii -o /tmp/diff_$i.png; done; animate /tmp/diff*.png
</div>
<!--l. 405--><p class="nopar" >
</p>
    
</body> 
</html>
                                                                  


